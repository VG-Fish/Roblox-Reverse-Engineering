!(function () {
  var t = {
      3003: function (e, a, t) {
        var i = {
          "./apiParamsInitialization.js": 5831,
          "./channelsNotificationType.js": 8282,
          "./diagActionList.js": 7276,
          "./eventNames.js": 9053,
          "./featureInterventionAnalytics.js": 1720,
          "./gameParameters.js": 2771,
          "./httpResponse.js": 1246,
          "./messageHelper.js": 7586,
          "./notificationType.js": 1034,
          "./notificationsName.js": 4094,
          "./resources.js": 5832,
        };
        function r(e) {
          e = n(e);
          return t(e);
        }
        function n(e) {
          if (t.o(i, e)) return i[e];
          e = new Error("Cannot find module '" + e + "'");
          throw ((e.code = "MODULE_NOT_FOUND"), e);
        }
        (r.keys = function () {
          return Object.keys(i);
        }),
          (r.resolve = n),
          ((e.exports = r).id = 3003);
      },
      1351: function (e, a, t) {
        var i = {
          "./chatBarController.js": 2162,
          "./chatController.js": 3607,
          "./contactCardController.js": 3835,
          "./detailsController.js": 6443,
          "./dialogController.js": 3617,
          "./dialogHeaderController.js": 3848,
          "./dialogMessagesController.js": 3341,
          "./dialogsController.js": 2928,
          "./friendsController.js": 6340,
          "./linkCardController.js": 5300,
          "./linkCardMessagesController.js": 8775,
          "./playTogetherController.js": 6893,
          "./userConversationInfoController.js": 4549,
        };
        function r(e) {
          e = n(e);
          return t(e);
        }
        function n(e) {
          if (t.o(i, e)) return i[e];
          e = new Error("Cannot find module '" + e + "'");
          throw ((e.code = "MODULE_NOT_FOUND"), e);
        }
        (r.keys = function () {
          return Object.keys(i);
        }),
          (r.resolve = n),
          ((e.exports = r).id = 1351);
      },
      1304: function (e, a, t) {
        var i = {
          "./abuseReportDirective.js": 4697,
          "./addFriendsDirective.js": 4239,
          "./backBtnDirective.js": 5642,
          "./chatAvatarHeadshotDirective.js": 4824,
          "./chatBarDirective.js": 2324,
          "./chatBaseDirective.js": 8606,
          "./chatDialogScrollbarDirective.js": 6501,
          "./chatGameIconDirective.js": 6328,
          "./chatPlaceholderDirective.js": 2340,
          "./chatTimeoutTimerDirective.js": 5985,
          "./confirmNegativeActionDirective.js": 8598,
          "./confirmRemoveMemberDirective.js": 2551,
          "./contactCardDirective.js": 2195,
          "./conversationTitleDirective.js": 4924,
          "./conversationTitleEditorDirective.js": 3415,
          "./detailsDirective.js": 1031,
          "./dialogDirective.js": 9763,
          "./dialogHeaderDirective.js": 8648,
          "./dialogLazyLoadDirective.js": 5457,
          "./dialogMinimizeDirective.js": 3315,
          "./friendsLazyLoadDirective.js": 7656,
          "./groupSelectDirective.js": 3844,
          "./lazyLoadDirective.js": 3325,
          "./linkCardDirective.js": 5737,
          "./minimizeItemDirective.js": 8994,
          "./osaContextCardDirective.js": 5041,
          "./pendingStateDirective.js": 1547,
          "./removeFocusDirective.js": 5897,
          "./repeatDoneDirective.js": 3378,
          "./selectFriendsDirective.js": 7546,
          "./selectFriendsResizeDirective.js": 9634,
          "./systemMessageDirective.js": 2657,
          "./togglePopoverDirective.js": 3502,
          "./userConversationInfoDirective.js": 5823,
        };
        function r(e) {
          e = n(e);
          return t(e);
        }
        function n(e) {
          if (t.o(i, e)) return i[e];
          e = new Error("Cannot find module '" + e + "'");
          throw ((e.code = "MODULE_NOT_FOUND"), e);
        }
        (r.keys = function () {
          return Object.keys(i);
        }),
          (r.resolve = n),
          ((e.exports = r).id = 1304);
      },
      2374: function (e, a, t) {
        var i = {
          "./analyticsService.js": 365,
          "./chatClientStorageUtilityService.js": 5577,
          "./chatService.js": 717,
          "./chatUtilityService.js": 6611,
          "./conversationUtilityService.js": 6278,
          "./cookieService.js": 2104,
          "./countdownTimerService.js": 5219,
          "./dialogAttributesService.js": 380,
          "./friendsService.js": 3214,
          "./gameLayoutService.js": 3943,
          "./gameService.js": 737,
          "./gameUtility.js": 2106,
          "./guacService.js": 5152,
          "./libraryInitializationService.js": 6128,
          "./messageService.js": 184,
          "./messageUtility.js": 8063,
          "./pinGameLayoutService.js": 5204,
          "./pinGameService.js": 7642,
          "./playTogetherLayoutService.js": 9149,
          "./playTogetherService.js": 787,
          "./presenceLayoutService.js": 2286,
          "./profileInsightsService.js": 9061,
          "./storageService.js": 4194,
          "./systemFeedbackService.js": 3493,
          "./systemMessagesService.js": 6692,
          "./usersService.js": 2565,
        };
        function r(e) {
          e = n(e);
          return t(e);
        }
        function n(e) {
          if (t.o(i, e)) return i[e];
          e = new Error("Cannot find module '" + e + "'");
          throw ((e.code = "MODULE_NOT_FOUND"), e);
        }
        (r.keys = function () {
          return Object.keys(i);
        }),
          (r.resolve = n),
          ((e.exports = r).id = 2374);
      },
      5251: function (e, a, t) {
        var i = {
          "./directives/templates/addFriends.html": 3108,
          "./directives/templates/chatAbuseReport.html": 9080,
          "./directives/templates/chatAvatarHeadshot.html": 3905,
          "./directives/templates/chatBar.html": 7193,
          "./directives/templates/chatBase.html": 6823,
          "./directives/templates/chatDialog.html": 4466,
          "./directives/templates/chatGameIcon.html": 7993,
          "./directives/templates/chatGroupDialog.html": 9651,
          "./directives/templates/chatPlaceholder.html": 7197,
          "./directives/templates/confirmNegativeAction.html": 115,
          "./directives/templates/contactCard.html": 7196,
          "./directives/templates/conversationTitle.html": 4389,
          "./directives/templates/conversationTitleEditor.html": 3040,
          "./directives/templates/createChatGroup.html": 155,
          "./directives/templates/details.html": 8636,
          "./directives/templates/dialogHeader.html": 9009,
          "./directives/templates/dialogMinimize.html": 5992,
          "./directives/templates/gamesList.html": 8249,
          "./directives/templates/linkCard.html": 5558,
          "./directives/templates/osaContextCard.html": 1186,
          "./directives/templates/pendingState.html": 856,
          "./directives/templates/selectFriends.html": 2755,
          "./directives/templates/systemMessage.html": 2038,
          "./directives/templates/userConversationInfo.html": 9392,
        };
        function r(e) {
          e = n(e);
          return t(e);
        }
        function n(e) {
          if (t.o(i, e)) return i[e];
          e = new Error("Cannot find module '" + e + "'");
          throw ((e.code = "MODULE_NOT_FOUND"), e);
        }
        (r.keys = function () {
          return Object.keys(i);
        }),
          (r.resolve = n),
          ((e.exports = r).id = 5251);
      },
      7525: function (e) {
        function n(e) {
          return e.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
        }
        function o(e) {
          return e.split("/").pop().replace(".html", "");
        }
        var a = {
          importFilesUnderPath: function (e) {
            e.keys().forEach(e);
          },
          templateCacheGenerator: function (e, a, i, r) {
            return e.module(a, []).run([
              "$templateCache",
              function (t) {
                i &&
                  i.keys().forEach(function (e) {
                    var a = n(o(e));
                    t.put(a, i(e));
                  }),
                  r &&
                    r.keys().forEach(function (e) {
                      var a = n(o(e));
                      t.put(a, r(e).replace(/<\/?script[^>]*>/gi, ""));
                    });
              },
            ]);
          },
        };
        e.exports = a;
      },
      1089: function (e, a, t) {
        "use strict";
        var i = t(7577),
          r = t(127),
          n = t.n(r),
          o = [
            "robloxApp",
            "monospaced.elastic",
            "modal",
            "ui.bootstrap.popover",
            "toast",
            "thumbnails",
            "userProfiles",
            "ngSanitize",
          ],
          s = "contacts";
        try {
          n().module(s), o.push(s);
        } catch (e) {}
        r = n()
          .module("chat", o)
          .config([
            "msdElasticConfig",
            "languageResourceProvider",
            function (e, a) {
              e.append = "\n";
              var t = new i.TranslationResourceProvider(),
                e = t.getTranslationResource("Feature.Chat"),
                t = t.getTranslationResource(
                  "Feature.InExperienceIntervention",
                );
              a.setTranslationResources([e, t]);
            },
          ]);
        a.A = r;
      },
      5831: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          t = t(1089),
          i = {
            chatApiParams: {
              pageNumberOfUnreadConversations: 1,
              pageSizeOfUnreadConversations: 30,
              minimumNumConversations: 10,
              maximumGetUserConversationsDepth: 10,
              getUserConversationsNextCursor: null,
              pageSizeOfConversations: 20,
              pageSizeOfUnreadMessages: 30,
              pageSizeOfGetMessages: 20,
              startIndexOfFriendList: 0,
              pageSizeOfFriendList: 50,
              loadMoreUnreadConversations: !1,
              loadMoreConversations: !1,
            },
            dialogParams: {
              loadMoreMessages: !0,
              sendingMessage: !1,
              sendMessageHasError: !1,
              startIndexOfFriendList: 0,
              pageSizeOfFriendList: 50,
              pageSizeOfGetMessages: 20,
              smallestPageSizeOfGetMessages: 3,
              getMessagesNextCursor: null,
              maxKeystrokeDataLength: 200,
              keystrokeSampleRate: 1,
            },
            gameUrls: {
              multiGetPlaceDetails: "/v1/games/multiget-place-details",
              getGamesByUniverseIds: i.EnvironmentUrls
                ? "".concat(i.EnvironmentUrls.gamesApi, "/v1/games")
                : "/v1/games",
              multiGetPlayabilityStatus: i.EnvironmentUrls
                ? "".concat(
                    i.EnvironmentUrls.gamesApi,
                    "/v1/games/multiget-playability-status",
                  )
                : "/v1/games/multiget-playability-status",
            },
            chatUrls: {
              setConversationUniverse: "/v2/set-conversation-universe",
              resetConversationUniverse: "/v2/reset-conversation-universe",
            },
            apiSets: {
              multiGetAvatarHeadshots: {
                url: i.EnvironmentUrls
                  ? "".concat(
                      i.EnvironmentUrls.thumbnailsApi,
                      "/v1/users/avatar-headshot?size=48x48&format=png",
                    )
                  : "/v1/users/avatar-headshot?size=48x48&format=png",
                retryable: !0,
                withCredentials: !0,
              },
              multiGetContacts: {
                url: i.EnvironmentUrls
                  ? "".concat(
                      i.EnvironmentUrls.contactsApi,
                      "/v1/user/get-tags",
                    )
                  : "/v1/user/get-tags",
                retryable: !0,
                withCredentials: !0,
              },
              multiGetPresence: {
                url: i.EnvironmentUrls
                  ? "".concat(
                      i.EnvironmentUrls.presenceApi,
                      "/v1/presence/users",
                    )
                  : "/v1/presence/users",
                retryable: !0,
                withCredentials: !0,
              },
              getMetaData: {
                url: i.EnvironmentUrls
                  ? "".concat(
                      Roblox.EnvironmentUrls.apiGatewayUrl,
                      "/platform-chat-api/v1/metadata",
                    )
                  : "/v1/metadata",
                retryable: !1,
                withCredentials: !0,
              },
              getContactsMetadata: {
                url: i.EnvironmentUrls
                  ? "".concat(
                      i.EnvironmentUrls.contactsApi,
                      "/v1/contacts/metadata",
                    )
                  : "/v1/contacts/metadata",
                retryable: !0,
                withCredentials: !0,
              },
            },
          };
        t.A.constant("apiParamsInitialization", i), (a.default = i);
      },
      8282: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          addedToChannel: "AddedToChannel",
          channelArchived: "ChannelArchived",
          channelCreated: "ChannelCreated",
          channelDeleted: "ChannelDeleted",
          channelMarkedRead: "ChannelMarkedRead",
          channelUnarchived: "ChannelUnarchived",
          channelUpdated: "ChannelUpdated",
          messageCreated: "MessageCreated",
          participantTyping: "ParticipantTyping",
          participantsAdded: "ParticipantsAdded",
          participantsRemoved: "ParticipantsRemoved",
          removedFromChannel: "RemovedFromChannel",
          systemMessageCreated: "SystemMessageCreated",
        };
        t(1089).A.constant("channelsNotificationType", i), (a.default = i);
      },
      7276: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          ChatLandingConversationClickedWeb:
            "ChatLandingConversationClickedWeb",
          ConversationMessageSentWeb: "ConversationMessageSentWeb",
          WebChatConversationsLoadedWeb: "WebChatConversationsLoadedWeb",
          WebChatConversationRenderedWeb: "WebChatConversationRenderedWeb",
          WebChatRenderedWeb: "WebChatRenderedWeb",
        };
        t(1089).A.constant("diagActionList", i), (a.default = i);
      },
      9053: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          chatLandingConversationClicked: "chatLandingConversationClicked",
          conversationMessageSent: "conversationMessageSent",
          webChatConversationsLoaded: "webChatConversationsLoaded",
          webChatConversationRendered: "webChatConversationRendered",
          webChatRendered: "webChatRendered",
        };
        t(1089).A.constant("eventNames", i), (a.default = i);
      },
      1720: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          interventionTypes: {
            partyChatNudge: "INTERVENTION_PARTY_CHAT_NUDGE",
            partyChatTimeout: "INTERVENTION_PARTY_CHAT_TIMEOUT",
          },
          eventTypes: {
            appealClicked: "EVENT_APPEAL_CLICKED",
            ctaClicked: "EVENT_CTA_CLICKED",
            learnClicked: "EVENT_LEARN_CLICKED",
            modalAppeared: "EVENT_MODAL_APPEARED",
          },
          eventContext: "InExperienceInterventionEvent",
          eventName: "InExperienceInterventionEvent",
        };
        t(1089).A.constant("featureInterventionAnalytics", i), (a.default = i);
      },
      2771: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          reasonProhibitedMessage: {
            None: "None",
            Playable: "Playable",
            AnonymousAccessProhibited: "AnonymousAccessProhibited",
            AssetUnapproved: "AssetUnapproved",
            IncorrectAssetType: "IncorrectAssetType",
            IncorrectAssetConfiguration: "IncorrectAssetConfiguration",
            PlaceHasNoUniverse: "PlaceHasNoUniverse",
            UniverseDoesNotHaveARootPlace: "This game has no root place.",
            UniverseRootPlaceIsNotAPlace: "UniverseRootPlaceIsNotAPlace",
            UniverseRootPlaceIsNotActive: "UniverseRootPlaceIsNotActive",
            InsufficientPermissionCopylocked:
              "InsufficientPermissionCopylocked",
            InsufficientPermissionFriendsOnly: "This game is friends only.",
            InsufficientPermissionGroupOnly: "Group members only.",
            InsufficientPermissionOwnerOnly: "InsufficientPermissionOwnerOnly",
            InsufficientPermissionMembershipLevel:
              "InsufficientPermissionMembershipLevel",
            InsufficientPermissionRoleSet: "InsufficientPermissionRoleSet",
            PermissionDenied: "PermissionDenied",
            RequiredValueNotSet: "RequiredValueNotSet",
            AssetUnavailable: "AssetUnavailable",
            DeviceRestricted: "DeviceRestricted",
            UnderReview: "This game is under moderation review.",
            PurchaseRequired: "PurchaseRequired",
            AccountRestricted: "AccountRestricted",
            PlaceHasNoPublishedVersion: "This place has no published version.",
          },
          sortNames: { myRecent: "MyRecent" },
          maxRowsOfMyRecentGames: 1,
          gameIconMultiGetLimit: 30,
          gameUrl: "/games/{placeId}/robloxgame",
        };
        t(1089).A.constant("gameParameters", i), (a.default = i);
      },
      1246: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = { sendMessageErrorCode: { textTooLong: "TextTooLong" } };
        t(1089).A.constant("httpResponse", i), (a.default = i);
      },
      7586: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(1089),
          t = {
            linkCardTypes: {
              gameCard: "gameCard",
              catalogItemCard: "catalogItemCard",
              libraryItemCard: "libraryItemCard",
            },
            messageRegexs: { gameCard: new RegExp(/\/games\/(\d+)/) },
            gameCardRegexs: {
              privateServerLinkCode: new RegExp(/privateServerLinkCode=(\S+)/),
            },
            urlRegex: new RegExp(
              /(https?:\/\/(?:www\.|(?!www)|(?:web\.))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|web\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www)|(?:web\.))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/,
            ),
            onlyNewLineRegex: new RegExp(/^[\r|\n|\s]+$/),
            removeNewLineRegex: new RegExp(/^\n+|\n+$/g),
            emojiRegex: new RegExp(
              /\u200D|\uFE0F|(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g,
            ),
            zwjRegex: new RegExp(/\u200D/),
            emojiRepRegex: new RegExp(/\uFE0F/),
            messageTypes: { user: "user", system: "system" },
          };
        i.A.constant("messageHelper", t), (a.default = t);
      },
      1034: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          newMessage: "NewMessage",
          newMessageBySelf: "NewMessageBySelf",
          newConversation: "NewConversation",
          addedToConversation: "AddedToConversation",
          removedFromConversation: "RemovedFromConversation",
          participantAdded: "ParticipantAdded",
          participantLeft: "ParticipantLeft",
          friendshipDestroyed: "FriendshipDestroyed",
          friendshipCreated: "FriendshipCreated",
          presenceOffline: "UserOffline",
          presenceOnline: "UserOnline",
          conversationTitleModerated: "ConversationTitleModerated",
          conversationTitleChanged: "ConversationTitleChanged",
          participantTyping: "ParticipantTyping",
          conversationUniverseChanged: "ConversationUniverseChanged",
          userTagUpdate: "UserTagUpdate",
          conversationBackfilled: "ConversationBackfilled",
          conversationReset: "ConversationReset",
          featureInterventionTypeNudge: "nudge",
          featureInterventionTypeTimeout: "timeout",
        };
        t(1089).A.constant("notificationType", i), (a.default = i);
      },
      4094: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = {
          CommunicationChannelsNotifications: "CommunicationChannels",
          ChatMigrationNotifications: "ChatMigration",
          ChatModerationTypeEligibilityNotifications:
            "ChatModerationTypeEligibility",
          ChatNotifications: "ChatNotifications",
          ExperienceIntervention: "ExperienceIntervention",
          FeatureIntervention: "FeatureIntervention",
          FriendshipNotifications: "FriendshipNotifications",
          PresenceNotifications: "PresenceNotifications",
          UserSettingsChangedNotifications: "UserSettingsChanged",
          UserTagNotifications: "UserTagChangeNotification",
          VoiceNotifications: "VoiceNotifications",
        };
        t(1089).A.constant("notificationsName", i), (a.default = i);
      },
      5832: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          t = t(1089),
          i = {
            templates: {
              chatBaseTemplate: "chat-base",
              chatBarTemplate: "chat-bar",
              abuseReportTemplate: "chat-abuse-report",
              dialogTemplate: "chat-dialog",
              groupDialogTemplate: "chat-group-dialog",
              dialogMinimizeTemplate: "dialog-minimize",
              chatPlaceholderTemplate: "chat-placeholder",
              confirmNegativeActionTemplate: "confirm-negative-action",
              userConversationInfoTemplate: "user-conversation-info",
              selectFriendsTemplate: "select-friends",
              createChatGroupTemplate: "create-chat-group",
              conversationTitleTemplate: "conversation-title",
              conversationTitleEditorTemplate: "conversation-title-editor",
              detailsTemplate: "details",
              addFriendsTemplate: "add-friends",
              aliasTemplate: "alias",
              toastTemplate: "toast",
              linkCard: "link-card",
              gamesList: "games-list",
              dialogHeader: "dialog-header",
              systemMessage: "system-message",
              chatAvatarHeadshot: "chat-avatar-headshot",
              chatGameIcon: "chat-game-icon",
              pendingStateTemplate: "pending-state",
              contactCardTemplate: "contact-card",
              osaContextCardTemplate: "osa-context-card",
            },
            eventStreamParams: {
              actions: { click: "click", hover: "hover", render: "render" },
              properties: {},
              clickPlayFromLinkCardInChat: "clickBtnFromLinkCardInChat",
              clickLinkCardInChat: "clickLinkCardInChat",
              clickPlayButtonInPlayTogether: "clickPlayButtonInPlayTogether",
              clickJoinButtonInPlayTogether: "clickJoinButtonInPlayTogether",
              clickBuyButtonInPlayTogether: "clickBuyButtonInPlayTogether",
              clickViewDetailsButtonInPlayTogether:
                "clickViewDetailsButtonInPlayTogether",
              openGameListInPlayTogether: "openGameListInPlayTogether",
              pinGameInPlayTogether: "pinGameInPlayTogether",
              unpinGameInPlayTogether: "unpinGameInPlayTogether",
              pinGameInLinkCard: "pinGameInLinkCard",
              unpinGameInLinkCard: "unpinGameInLinkCard",
              loadGameLinkCardInChat: "loadGameLinkCardInChat",
              gameImpressions: "gameImpressions",
              context: {
                gamePlayFromLinkCard: "PlayGameFromLinkCard",
                gamePlayFromPlayTogether: "PlayGameFromPlayTogether",
              },
              pageContext: { linkCardInChat: "linkCardInChat" },
            },
            urlParamNames: {
              startConversationWithUserId: "startConversationWithUserId",
              conversationId: "conversationId",
            },
            events: { openGameList: "openGameList" },
            hoverPopoverParams: {
              isOpen: !1,
              triggerSelector: "",
              hoverPopoverSelector: "",
            },
            performanceMeasurements: {
              messageSend: "MessageSend",
              messageReceive: "MessageReceive",
            },
            chatDataLSNamePrefix: i.CurrentUser
              ? "Roblox.Chat.".concat(i.CurrentUser.userId)
              : "Roblox.Chat",
          };
        t.A.constant("resources", i), (a.default = i);
      },
      2162: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(o, e, a, t) {
          (o.cancelSearch = function () {
            (o.chatViewModel.searchTerm = ""),
              (o.chatLibrary.chatLayout.searchFocus = !1);
          }),
            (o.saveChatBarLayoutInCookie = function () {
              var e = { collapsed: o.chatLibrary.chatLayout.collapsed };
              a.updateStorage(
                a.storageDictionary.chatBarLayout,
                e,
                o.chatLibrary.cookieOption,
              );
            }),
            (o.toggleChatContainer = function () {
              (o.chatLibrary.chatLayout.collapsed =
                !o.chatLibrary.chatLayout.collapsed),
                o.updateUnreadConversationCount(),
                (o.chatLibrary.chatLayout.chatBarInitialized = !0),
                o.saveChatBarLayoutInCookie();
            }),
            (o.isChatDisconnected = function () {
              var e = o.chatLibrary.chatLayout,
                a = e.errorMaskEnable,
                e = e.pageDataLoading;
              return o.getIsChatEnabled() && (a || e);
            }),
            (o.isChatEmpty = function () {
              return (
                o.chatLibrary.chatLayout.chatLandingEnabled ||
                !o.getIsChatEnabled()
              );
            }),
            (o.getIsChatEnabled = function () {
              return t.getIsChatEnabled(o.chatLibrary);
            }),
            (o.search = function (e) {
              var a = o.chatViewModel.searchTerm;
              if (!a) return !0;
              var t = e.name,
                i = e.contact,
                r = e.participants,
                e = e.title,
                n = a.toLowerCase(),
                a = !1;
              return (
                r &&
                  r.length &&
                  (a = r.some(function (e) {
                    var a = e.display_name,
                      e = e.name;
                    return (
                      (a && -1 < a.toLowerCase().indexOf(n)) ||
                      -1 < e.toLowerCase().indexOf(n)
                    );
                  })),
                a ||
                  -1 !== t.toLowerCase().indexOf(n) ||
                  -1 !== e.toLowerCase().indexOf(n) ||
                  (i && -1 !== i.toLowerCase().indexOf(n))
              );
            });
        }
        (i.$inject = [
          "$scope",
          "$log",
          "chatClientStorageUtilityService",
          "chatUtility",
        ]),
          t.A.controller("chatBarController", i),
          (a.default = i);
      },
      3607: function (e, a, t) {
        "use strict";
        t.r(a);
        var ae = t(7577),
          te = t(7472),
          i = t(127),
          ie = t.n(i),
          t = t(1089);
        function re(e, a) {
          var t;
          if ("undefined" == typeof Symbol || null == e[Symbol.iterator]) {
            if (
              Array.isArray(e) ||
              (t = s(e)) ||
              (a && e && "number" == typeof e.length)
            ) {
              t && (e = t);
              var i = 0,
                a = function () {};
              return {
                s: a,
                n: function () {
                  return i >= e.length
                    ? { done: !0 }
                    : { done: !1, value: e[i++] };
                },
                e: function (e) {
                  throw e;
                },
                f: a,
              };
            }
            throw new TypeError(
              "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
            );
          }
          var r,
            n = !0,
            o = !1;
          return {
            s: function () {
              t = e[Symbol.iterator]();
            },
            n: function () {
              var e = t.next();
              return (n = e.done), e;
            },
            e: function (e) {
              (o = !0), (r = e);
            },
            f: function () {
              try {
                n || null == t.return || t.return();
              } finally {
                if (o) throw r;
              }
            },
          };
        }
        function c(e, a, t, i, r, n, o) {
          try {
            var s = e[n](o),
              c = s.value;
          } catch (e) {
            return void t(e);
          }
          s.done ? a(c) : Promise.resolve(c).then(i, r);
        }
        function ne(s) {
          return function () {
            var e = this,
              o = arguments;
            return new Promise(function (a, t) {
              var i = s.apply(e, o);
              function r(e) {
                c(i, a, t, r, n, "next", e);
              }
              function n(e) {
                c(i, a, t, r, n, "throw", e);
              }
              r(void 0);
            });
          };
        }
        function oe(e, a) {
          return (
            (function (e) {
              if (Array.isArray(e)) return e;
            })(e) ||
            (function (e, a) {
              if (
                "undefined" == typeof Symbol ||
                !(Symbol.iterator in Object(e))
              )
                return;
              var t = [],
                i = !0,
                r = !1,
                n = void 0;
              try {
                for (
                  var o, s = e[Symbol.iterator]();
                  !(i = (o = s.next()).done) &&
                  (t.push(o.value), !a || t.length !== a);
                  i = !0
                );
              } catch (e) {
                (r = !0), (n = e);
              } finally {
                try {
                  i || null == s.return || s.return();
                } finally {
                  if (r) throw n;
                }
              }
              return t;
            })(e, a) ||
            s(e, a) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
              );
            })()
          );
        }
        function s(e, a) {
          if (e) {
            if ("string" == typeof e) return r(e, a);
            var t = Object.prototype.toString.call(e).slice(8, -1);
            return (
              "Object" === t && e.constructor && (t = e.constructor.name),
              "Map" === t || "Set" === t
                ? Array.from(e)
                : "Arguments" === t ||
                    /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)
                  ? r(e, a)
                  : void 0
            );
          }
        }
        function r(e, a) {
          (null == a || a > e.length) && (a = e.length);
          for (var t = 0, i = new Array(a); t < a; t++) i[t] = e[t];
          return i;
        }
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function se(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function o(
          d,
          s,
          i,
          r,
          o,
          u,
          c,
          l,
          g,
          n,
          e,
          p,
          h,
          y,
          a,
          t,
          m,
          v,
          f,
          b,
          L,
          C,
          I,
          D,
          T,
          S,
          P,
          M,
          E,
          U,
          A,
          O,
          w,
          k,
          x,
          F,
          N,
        ) {
          function G() {
            var e =
                i.innerWidth() -
                g.chatLayout.widthOfChat -
                g.chatLayout.widthOfDialogMinimize,
              a = g.chatLayout.widthOfDialog + g.chatLayout.spaceOfDialog;
            (d.chatLibrary.chatLayout.availableNumberOfDialogs = Math.floor(
              e / a,
            )),
              (d.chatLibrary.chatLayout.numberOfDialogs =
                d.chatLibrary.dialogIdList.length),
              (d.chatLibrary.chatLayout.numberOfMinimizedDialogs =
                d.chatLibrary.minimizedDialogIdList.length),
              u.debug(
                " -------------numberOfDialogs = -------------- ".concat(
                  d.chatLibrary.chatLayout.numberOfDialogs,
                ),
              ),
              u.debug(
                " -------------availableNumberOfDialogs = -------------- ".concat(
                  d.chatLibrary.chatLayout.availableNumberOfDialogs,
                ),
              );
          }
          function R() {
            return d.preSetChatLibrary.dialogIdList
              .filter(function (e) {
                return e !== g.newGroup.layoutId && d.chatUserDict[e];
              })
              .map(function (e) {
                return d.chatUserDict[e];
              });
          }
          function j(e) {
            var a;
            d.chatLibrary.dialogDict[e.layoutId] &&
              ((a = e.layoutId),
              d.chatLibrary.dialogDict[a] &&
                ((d.chatLibrary.dialogDict[a].isUpdated = !0),
                (d.chatLibrary.dialogDict[a].updateStatus =
                  g.dialogStatus.REFRESH))),
              !d.chatLibrary.dialogDict[e.layoutId] &&
                e.previewMessage &&
                e.previewMessage.previewContent &&
                d.launchDialog(e.layoutId, !0);
          }
          (d.dialogsOverflowWindow = function () {
            var e = i.innerWidth();
            return (
              d.chatLibrary.chatLayout.numberOfDialogs >=
                d.chatLibrary.chatLayout.availableNumberOfDialogs &&
              e > g.chatLayout.thresholdMobile
            );
          }),
            (d.processLatestMessageForConversations = function (e) {
              ie().forEach(e, function (e) {
                var a,
                  t = e.messages;
                d.chatLibrary.conversationsDict[e.conversationId] &&
                  ((a =
                    d.chatLibrary.conversationsDict[e.conversationId].layoutId),
                  ((e = d.chatUserDict[a]).hasUnreadMessages =
                    e.hasUnreadMessages || h.hasUnreadMessages(e, t)),
                  l.updatePreviewMessage(e, t),
                  l.resetConversationUnreadStatus(d.chatUserDict[a], t),
                  l.formatTimestampInConversation(d.chatUserDict[a]));
              });
            }),
            (d.updateUnreadConversationCount = function () {
              d.getIsChatEnabled() &&
                c.getUnreadConversationCount().then(
                  function (e) {
                    e &&
                      (0 < e.count
                        ? ((d.chatViewModel.unreadConversationCount = " ✦ "),
                          (s.document.title = "( ✦ ) ".concat(
                            d.chatLibrary.currentTabTitle,
                          )))
                        : ((d.chatViewModel.unreadConversationCount = 0),
                          (s.document.title = d.chatLibrary.currentTabTitle)));
                  },
                  function () {
                    u.debug(
                      "----- getUnreadConversationCount request is failed ! ------",
                    ),
                      (s.document.title = d.chatLibrary.currentTabTitle);
                  },
                );
            }),
            (d.replaceConversation = function (e, a) {
              var t = a.dialogType,
                i = d.getLayoutId(a.id, t),
                r = d.chatUserDict[e];
              r &&
                ((n = r.id), (d.chatLibrary.conversationsDict[n].remove = !0));
              var n = d.chatLibrary.dialogDict[e];
              d.closeDialog(e),
                n && d.updateDialogList(i, !0),
                (t !== g.dialogType.CHAT && t !== g.dialogType.FRIEND) ||
                  a.participants.forEach(function (e) {
                    e = e.id;
                    e !== d.chatLibrary.userId &&
                      (d.chatLibrary.userConversationsDict[e] = a.layoutId);
                  });
            });
          function B(e, t) {
            return c.getConversations(e).then(function (e) {
              if (e) {
                var a = d.buildChatUserListByUnreadConversations(e, t);
                return d.getPlaceDetailsForNewPlaceIds(e), a;
              }
            });
          }
          function _(e) {
            var a = [];
            return a.push(e), B(a, !0);
          }
          function $(e, a, t) {
            l.appendMessages(d.chatLibrary, a, e),
              v.fetchDataForLinkCard(e, d.chatLibrary),
              h.hasUnreadMessages(a, e),
              (e = { status: !1, userId: e[0].sender_user_id }),
              d.updateConverationTypingStatus(a.id, e),
              d.updateChatViewModel(a, !0),
              a.hasUnreadMessages && j(a),
              t ||
                ((e = a.layoutId),
                (t = g.activeType.NEWMESSAGE),
                d.chatLibrary.dialogDict[e] &&
                  ((d.chatLibrary.dialogDict[e].markAsActive = !0),
                  (d.chatLibrary.dialogDict[e].activeType = t))),
              (a = d.chatLibrary.dialogsLayout[a.layoutId]) &&
                (a.scrollToBottom = !0);
          }
          function z(e, a) {
            var t,
              i,
              r,
              n = d.getLayoutId(e, g.dialogType.CHAT);
            ie().isUndefined(d.chatUserDict[n])
              ? _(e)
              : ((e = n),
                (n = null),
                (t = a),
                (i = []),
                (r = d.chatUserDict[e]),
                (e = null),
                t || (e = new Date().getTime()),
                c.getMessagesByPageSize(
                  r,
                  n,
                  g.dialogParams.smallestPageSizeOfGetMessages,
                  i,
                  function (e) {
                    $(i, r, t),
                      e &&
                        ((e = new Date().getTime() - e),
                        c.sendPerformanceData(
                          C.performanceMeasurements.messageReceive,
                          e,
                        ));
                  },
                  e,
                ));
          }
          (d.resetDialogLayout = function (t) {
            var e, a;
            t &&
              ((e = se({}, g.dialogLayout)),
              (a = se({}, g.dialogLayoutResetConstant)),
              ie().forEach(e, function (e, a) {
                ie().isUndefined(t[a]) && (t[a] = se({}, e));
              }),
              ie().forEach(a, function (e, a) {
                t[a] = se({}, e);
              }));
          }),
            (d.retrieveDialogStatus = function () {
              if (
                ie().isDefined(d.preSetChatLibrary) &&
                ie().isDefined(d.preSetChatLibrary.dialogIdList)
              ) {
                var e = se({}, d.preSetChatLibrary.dialogIdList);
                if (0 === e.length)
                  return (
                    (d.preSetChatLibrary.dialogDict = {}),
                    (d.preSetChatLibrary.dialogsLayout = {}),
                    n.removeFromStorage(
                      n.storageDictionary.dialogDict,
                      d.chatLibrary.cookieOption,
                    ),
                    n.removeFromStorage(
                      n.storageDictionary.dialogsLayout,
                      d.chatLibrary.cookieOption,
                    ),
                    !1
                  );
                var t = d.preSetChatLibrary.dialogDict,
                  i = d.preSetChatLibrary.dialogsLayout;
                ie().forEach(e, function (e, a) {
                  e === g.newGroup.layoutId ||
                    d.chatUserDict[e] ||
                    (d.preSetChatLibrary.dialogIdList.splice(a, 1),
                    delete t[e],
                    delete i[e]),
                    d.resetDialogLayout(i[e]);
                }),
                  (d.chatLibrary.dialogIdList =
                    d.preSetChatLibrary.dialogIdList),
                  ie().forEach(t, function (e, a) {
                    e.isUpdated || (e.isUpdated = !0),
                      a === g.newGroup.layoutId &&
                        (d.chatUserDict[g.newGroup.layoutId] = d.newGroup),
                      (d.chatLibrary.dialogDict[a] = e),
                      i[a] && (d.chatLibrary.dialogsLayout[a] = i[a]);
                  }),
                  d.maybeCloseNewGroupDialog(),
                  Q(R());
              }
            });
          function H() {
            return (
              s.innerWidth >= g.chatLayout.thresholdChatBarOpen &&
              !d.chatLibrary.isTakeOverOn &&
              !ie().element("#GamesPageLeftColumn").length
            );
          }
          var W;
          (d.setup = function () {
            (d.chatUserDict = {}),
              (d.dialogType = se({}, g.dialogType)),
              (d.userPresenceTypes = se({}, g.userPresenceTypes)),
              (d.newGroup = se({}, t.newGroup)),
              (d.selectedFriendIds = []),
              (d.chatTimeouts = {}),
              (d.chatLibrary = se({}, m.chatLibrary)),
              ie().isDefined(ae.RealTime) &&
                (W = ae.RealTime.Factory.GetClient());
          }),
            (d.initializePresetData = function () {
              (d.preSetChatLibrary = {}),
                n.isStorageDefined(n.storageDictionary.dialogIdList) &&
                n.isStorageDefined(n.storageDictionary.dialogDict)
                  ? (d.preSetChatLibrary = {
                      dialogIdList: n.getFromStorage(
                        n.storageDictionary.dialogIdList,
                      ),
                      dialogDict: n.getFromStorage(
                        n.storageDictionary.dialogDict,
                      ),
                      dialogsLayout: n.isStorageDefined(
                        n.storageDictionary.dialogsLayout,
                      )
                        ? n.getFromStorage(n.storageDictionary.dialogsLayout)
                        : {},
                    })
                  : (d.preSetChatLibrary = {
                      dialogIdList: [],
                      dialogDict: {},
                      dialogsLayout: {},
                    }),
                n.isStorageDefined(n.storageDictionary.chatBarLayout) &&
                  (d.preSetChatLibrary.chatBarLayout = n.getFromStorage(
                    n.storageDictionary.chatBarLayout,
                  )),
                (d.chatApiParams = se({}, g.chatApiParams));
            }),
            (d.initializeChatBar = function () {
              d.chatLibrary.chatLayout.chatBarInitialized ||
                (H() && !d.preSetChatLibrary.chatBarLayout
                  ? (d.chatLibrary.chatLayout.collapsed = !1)
                  : d.preSetChatLibrary.chatBarLayout
                    ? (d.chatLibrary.chatLayout.collapsed =
                        d.preSetChatLibrary.chatBarLayout.collapsed)
                    : H() || (d.chatLibrary.chatLayout.collapsed = !0),
                (d.chatLibrary.chatLayout.chatBarInitialized = !0)),
                p.logSinglePerformanceMark(
                  g.performanceMarkLabels.chatPageDataLoaded,
                );
            });
          function V(e, a) {
            var t = d.chatLibrary.layoutIdList.indexOf(e);
            a && -1 < t
              ? d.chatLibrary.layoutIdList.splice(t, 1)
              : !a && t < 0 && d.chatLibrary.layoutIdList.push(e);
          }
          function q(e) {
            return d.chatLibrary.userConversationsDict[e] || null;
          }
          d.removeFriend = function (e) {
            var a = (a = q(e)) || d.getLayoutId(e, g.dialogType.FRIEND);
            d.chatUserDict[a] &&
              ((e = d.chatUserDict[a].id),
              (d.chatLibrary.conversationsDict[e].remove = !0)),
              -1 < d.chatLibrary.chatLayoutIds.indexOf(a) && d.closeDialog(a),
              0 === d.chatLibrary.chatLayoutIds.length &&
                (d.chatLibrary.chatLayout.chatLandingEnabled = !0);
          };
          function J() {
            var e;
            window &&
              window.location &&
              (u.debug("--- -initialzeUrlParser- ---"),
              (e = window.location.search) &&
                -1 < e.indexOf("?") &&
                (e = e.substr(1)).split("&").forEach(function (e) {
                  var a = e.split("="),
                    e = a[0],
                    t = decodeURIComponent(a[1]);
                  switch (e) {
                    case g.urlParamNames.startConversationWithUserId:
                      d.startSpecificConversationFromUserId(t);
                      break;
                    case g.urlParamNames.conversationId:
                      (d.chatLibrary.chatLayout.urlParseInitialized = !0),
                        d.startSpecificConversationFromConvId(t);
                  }
                }));
          }
          (d.getAllFriends = function () {
            M.getFriendsPresence().then(
              function (e) {
                d.getFriendsInfo(e);
              },
              function (e) {
                console.debug(e);
              },
            );
          }),
            (d.updateFriendsDictBySearch = function (e) {
              var t, i;
              null != e &&
                e.length &&
                ((t = []),
                (i = []),
                ie().forEach(e, function (e) {
                  var a = e,
                    e = a.id;
                  (a.id = parseInt(e, 10)),
                    d.chatLibrary.friendsDict[e] ||
                      ((d.chatLibrary.friendsDict[e] = {
                        id: a.id,
                        presence: {
                          userPresenceType: a.userPresence
                            ? L.conversion[a.userPresence.UserPresenceType]
                            : 0,
                        },
                      }),
                      t.push(e)),
                    i.push(e);
                }),
                (e = [te.UserProfileField.Names.CombinedName]),
                E.watchUserProfiles(i, e).subscribe(function (e) {
                  e.loading, e.error;
                  var a = e.data;
                  Object.keys(a).forEach(function (e) {
                    d.chatLibrary.friendsDict[e] &&
                      (d.chatLibrary.friendsDict[e].nameForDisplay =
                        a[e].names.combinedName);
                  });
                }),
                t &&
                  0 < t.length &&
                  D.getAvatarHeadshots(t, d.chatLibrary.friendsDict));
            }),
            (d.updateDialogList = function (e, a) {
              for (
                G();
                d.chatLibrary.chatLayout.numberOfDialogs +
                  d.chatLibrary.chatLayout.numberOfMinimizedDialogs >=
                d.chatLibrary.chatLayout.maxOpenDialogs;

              ) {
                var t = d.chatLibrary.dialogIdList[0];
                d.closeDialog(t), G();
              }
              if (d.dialogsOverflowWindow())
                for (
                  ;
                  d.chatLibrary.dialogIdList.length >=
                  d.chatLibrary.chatLayout.availableNumberOfDialogs;

                ) {
                  var i = d.chatLibrary.dialogIdList.pop();
                  if (ie().isUndefined(i)) break;
                  (d.chatLibrary.dialogDict[i].isUpdated = !0),
                    (d.chatLibrary.dialogDict[i].updateStatus =
                      g.dialogStatus.MINIMIZE);
                  i = d.chatLibrary.minimizedDialogIdList.indexOf(e);
                  -1 < i &&
                    (d.chatLibrary.dialogsLayout[e].collapsed &&
                      (d.chatLibrary.dialogsLayout[e].collapsed = !1),
                    d.chatLibrary.minimizedDialogIdList.splice(i, 1),
                    delete d.chatLibrary.minimizedDialogData[e]);
                }
              d.chatLibrary.dialogIdList.indexOf(e) < 0 &&
                d.chatLibrary.dialogIdList.push(e);
              var r = se({}, g.dialogInitValue);
              ie().isDefined(a) && a && (r.autoOpen = !0),
                (d.chatLibrary.dialogDict[e] = r);
            }),
            (d.getUserConversations = function () {
              var r,
                n =
                  0 < arguments.length && void 0 !== arguments[0]
                    ? arguments[0]
                    : 0;
              n >= d.chatApiParams.maximumGetUserConversationsDepth ||
                ((r = d.chatApiParams.getUserConversationsNextCursor),
                c
                  .getUserConversations(
                    r,
                    d.chatApiParams.pageSizeOfConversations,
                    d.chatLibrary.friendsDict,
                  )
                  .then(
                    function (e) {
                      var a = e.conversations;
                      r || d.sendWebChatConversationsLoadedEvent(a),
                        p.logSinglePerformanceMark(
                          g.performanceMarkLabels.chatConversationsLoaded,
                        );
                      var t = [],
                        i = d.chatLibrary.friendsDict;
                      a &&
                        0 < a.length &&
                        ((t = T.getUserIdsNotInFriendsDict(a, i)),
                        d.buildChatUserListByConversations(a, !1),
                        d.retrieveDialogStatus()),
                        !e.next_cursor
                          ? ((d.chatApiParams.loadMoreConversations = !1),
                            (d.chatApiParams.getUserConversationsNextCursor =
                              null),
                            ie().equals(d.chatUserDict, {}) &&
                              (d.chatLibrary.chatLayout.chatLandingEnabled =
                                !0))
                          : ((d.chatApiParams.getUserConversationsNextCursor =
                              e.next_cursor),
                            (d.chatApiParams.loadMoreConversations = !0)),
                        d.chatLibrary.chatLayout.pageDataLoading &&
                          (d.chatLibrary.chatLayout.pageDataLoading = !1),
                        d.chatLibrary.chatLayout.urlParseInitialized || J(),
                        S.getUserContacts(t, i),
                        D.getUserInfo(t, i),
                        d.chatApiParams.loadMoreConversations &&
                          (null === (i = d.chatLibrary.chatLayoutIds) ||
                          void 0 === i
                            ? void 0
                            : i.length) <
                            d.chatApiParams.minimumNumConversations &&
                          d.getUserConversations(n + 1);
                    },
                    function (e) {
                      console.debug(e);
                    },
                  ));
            }),
            (d.getUserConversationsFromCursor = function (e, i) {
              c.getUserConversations(
                e,
                d.chatApiParams.pageSizeOfConversations,
                d.chatLibrary.friendsDict,
              ).then(
                function (e) {
                  var a = e.conversations;
                  p.logSinglePerformanceMark(
                    g.performanceMarkLabels.chatConversationsLoaded,
                  );
                  var t = [],
                    e = d.chatLibrary.friendsDict;
                  return (
                    a &&
                      0 < a.length &&
                      ((t = T.getUserIdsNotInFriendsDict(a, e)),
                      d.buildChatUserListByConversations(a, i),
                      d.retrieveDialogStatus()),
                    d.chatLibrary.chatLayout.pageDataLoading &&
                      (d.chatLibrary.chatLayout.pageDataLoading = !1),
                    d.chatLibrary.chatLayout.urlParseInitialized || J(),
                    S.getUserContacts(t, e),
                    D.getUserInfo(t, e)
                  );
                },
                function (e) {
                  console.debug(e);
                },
              );
            }),
            (d.updateConversationTitle = function (t) {
              var e = [t];
              c.getConversations(e).then(
                function (e) {
                  e &&
                    (d.buildChatUserListByUnreadConversations(e, !0),
                    ie().forEach(e, function (e) {
                      var a;
                      e.id == t &&
                        ((a = d.chatLibrary.conversationsDict[t]
                          ? d.chatLibrary.conversationsDict[t].layoutId
                          : d.getLayoutId(t, g.dialogType.CHAT)),
                        (a = d.chatUserDict[a]),
                        g.updateConversationTitle(a, e.title));
                    }));
                },
                function () {
                  u.debug(" -------- getConversations request failed ------ ");
                },
              );
            }),
            (d.resetTypingStatusAsReceiver = function (e, a) {
              u.debug(
                "--------- resetTypingStatusAsReceiver has been called-----------",
              );
              var t = e.typing,
                i = e.typing.userTypingDict[a],
                r = e.typing.userIds.indexOf(a);
              e.typing.userIds.splice(r),
                (e.typing.isTypingFromSender = !1),
                (i.status = !1),
                (i.lastTimeReceiveTypingEvent = null),
                o.cancel(i.lastTimeReceiveTimer),
                delete e.typing.userTypingDict[a],
                o.cancel(t.lastTimeReceiveTimer);
            }),
            (d.typingStatusForReceiverExpirationInterval = function (e, a, t) {
              e.typing.userIds.indexOf(t) < 0 && e.typing.userIds.push(t);
              var i = a || new Date().getTime(),
                a = e.typing.userTypingDict[t];
              a.lastTimeReceiveTypingEvent ||
                (a.lastTimeReceiveTypingEvent = i),
                (i - a.lastTimeReceiveTypingEvent >
                  d.chatLibrary.typingInChatForReceiverExpirationMs ||
                  !a.status) &&
                  d.resetTypingStatusAsReceiver(e, t);
            }),
            (d.updateConverationTypingStatus = function (e, a) {
              var t = d.chatLibrary.conversationsDict[e]
                  ? d.chatLibrary.conversationsDict[e].layoutId
                  : d.getLayoutId(e),
                i = d.chatUserDict[t],
                e = a.status,
                r = a.userId,
                n = d.chatLibrary.dialogsLayout[t];
              n &&
                (n.typing.userTypingDict[r] ||
                  (n.typing.userTypingDict[r] = {}),
                (n.typing.isTypingFromSender = e),
                ((t = n.typing.userTypingDict[r]).status = e),
                l.refreshTypingStatus(i, r, e, n),
                e && !t.lastTimeReceiveTimer
                  ? (u.debug(
                      "--------- start a new timer-----------".concat(r),
                    ),
                    d.typingStatusForReceiverExpirationInterval(n, null, r),
                    (t.lastTimeReceiveTimer = o(function () {
                      return d.typingStatusForReceiverExpirationInterval(
                        n,
                        null,
                        r,
                      );
                    }, d.chatLibrary.typingInChatForReceiverExpirationMs)))
                  : !e &&
                    t.lastTimeReceiveTimer &&
                    (u.debug("--------- cancel timer-----------".concat(r)),
                    d.resetTypingStatusAsReceiver(n, r)));
            }),
            (d.fetchPlaceDetailsIntoPlacesLibrary = function (e, t) {
              e &&
                0 < e.length &&
                v.multiGetPlaceDetails(e).then(function (e) {
                  v.buildPlacesLibrary(d.chatLibrary, e);
                  var a = d.chatLibrary.placesLibrary;
                  ie().forEach(t, function (e) {
                    v.buildButtonLayoutPerConversation(e, a);
                  });
                });
            }),
            (d.handleChannelsNotifications = function (a) {
              u.debug(
                "--------- this is "
                  .concat(
                    g.notificationsName.CommunicationChannelsNotifications,
                    " subscription -----------",
                  )
                  .concat(a.Type),
              );
              try {
                var e = a.Type,
                  t = a.ChannelId;
                switch (e) {
                  case g.channelsNotificationType.messageCreated:
                  case g.channelsNotificationType.systemMessageCreated:
                    z(t);
                    break;
                  case g.channelsNotificationType.addedToChannel:
                  case g.channelsNotificationType.channelCreated:
                  case g.channelsNotificationType.channelUnarchived:
                  case g.channelsNotificationType.participantsAdded:
                  case g.channelsNotificationType.participantsRemoved:
                    _(t);
                    break;
                  case g.channelsNotificationType.channelArchived:
                  case g.channelsNotificationType.channelDeleted:
                  case g.channelsNotificationType.removedFromChannel:
                    d.chatLibrary.conversationsDict[t].remove ||
                      ((i = d.chatLibrary.conversationsDict[t].layoutId),
                      (d.chatLibrary.conversationsDict[t].remove = !0),
                      d.closeDialog(i),
                      _(t));
                    break;
                  case g.channelsNotificationType.channelUpdated:
                    d.updateConversationTitle(t);
                    break;
                  case g.channelsNotificationType.participantTyping:
                    var i = { status: !0, userId: parseInt(a.Actor.Id) };
                    d.updateConverationTypingStatus(t, i);
                }
              } catch (e) {
                var r = ""
                  .concat(
                    g.notificationsName.CommunicationChannelsNotifications,
                    ":",
                  )
                  .concat(a.Type, ": ");
                e && e.message && (r += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    r,
                  );
              }
            }),
            (d.handleChatMigrationNotifications = function (a) {
              var e, t, i;
              u.debug(
                "--------- this is "
                  .concat(
                    g.notificationsName.ChatMigrationNotifications,
                    " subscription -----------",
                  )
                  .concat(a.Type),
              );
              try {
                var r = a.Type;
                if (r === g.notificationType.conversationBackfilled)
                  (e = a.ConversationId), (t = a.ChannelId);
                else {
                  if (r !== g.notificationType.conversationReset) return;
                  (e = a.ChannelId), (t = a.ConversationId);
                }
                (i = e),
                  _(t).then(function (e) {
                    var a;
                    !e ||
                      ((a = e[0]) &&
                        ((e = a.dialogType),
                        (e = d.getLayoutId(i, e)),
                        d.chatUserDict[e] &&
                          (d.replaceConversation(e, a),
                          d.processLatestMessageForConversations([
                            { conversationId: a.id, messages: a.messages },
                          ]))));
                  });
              } catch (e) {
                var n = ""
                  .concat(g.notificationsName.ChatMigrationNotifications, ":")
                  .concat(a.Type, ": ");
                e && e.message && (n += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    n,
                  );
              }
            }),
            (d.handleChatModerationTypeEligibilityNotifications = function (e) {
              u.debug(
                "--------- this is ".concat(
                  g.notificationsName
                    .ChatModerationTypeEligibilityNotifications,
                  " subscription -----------",
                ),
              );
              try {
                var a = e.channels_inspected;
                if (!a || 0 === a.length) return;
                a = a.filter(function (e) {
                  return d.chatLibrary.conversationsDict[e];
                });
                if (0 === a.length) return;
                !(function (e) {
                  for (
                    var a = 0;
                    a < e.length;
                    a += g.chatApiParams.pageSizeOfConversations
                  ) {
                    var t = e.slice(
                      a,
                      a + g.chatApiParams.pageSizeOfConversations,
                    );
                    B(t, !1);
                  }
                })(a);
              } catch (e) {
                var t = "".concat(
                  g.notificationsName
                    .ChatModerationTypeEligibilityNotifications,
                  " ",
                );
                e && e.message && (t += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    t,
                  );
              }
            }),
            (d.handleChatNotifications = function (a) {
              u.debug(
                "--------- this is ChatNotifications subscription -----------".concat(
                  a.Type,
                ),
              );
              try {
                var e,
                  t,
                  i,
                  r,
                  n = a.Type,
                  o = a.ConversationId;
                switch (n) {
                  case g.notificationType.newMessage:
                    z(o);
                    break;
                  case g.notificationType.newMessageBySelf:
                    z(o, !0);
                    break;
                  case g.notificationType.newConversation:
                  case g.notificationType.addedToConversation:
                  case g.notificationType.participantAdded:
                  case g.notificationType.participantLeft:
                    _(o);
                    break;
                  case g.notificationType.removedFromConversation:
                    d.chatLibrary.conversationsDict[o].remove ||
                      ((i = d.chatLibrary.conversationsDict[o].layoutId),
                      (d.chatLibrary.conversationsDict[o].remove = !0),
                      d.closeDialog(i));
                    break;
                  case g.notificationType.conversationTitleChanged:
                    var s = a.ActorTargetId;
                    d.updateConversationTitle(o);
                    break;
                  case g.notificationType.participantTyping:
                    var c = { status: a.IsTyping, userId: a.UserId };
                    d.updateConverationTypingStatus(o, c);
                    break;
                  case g.notificationType.conversationUniverseChanged:
                    d.chatLibrary.conversationsDict[o] &&
                      ((r = a.RootPlaceId),
                      (e = a.UniverseId),
                      (s = a.ActorTargetId),
                      (i = d.chatLibrary.conversationsDict[o].layoutId),
                      (t = d.chatUserDict[i]),
                      (c =
                        d.chatLibrary.placesLibrary &&
                        d.chatLibrary.placesLibrary[r]
                          ? d.chatLibrary.placesLibrary[r].placeName
                          : ""),
                      (i =
                        d.chatLibrary.placesLibrary &&
                        d.chatLibrary.placesLibrary[r]
                          ? d.chatLibrary.placesLibrary[r].encodedPlaceName
                          : ""),
                      (c = {
                        rootPlaceId: r,
                        universeId: e,
                        actorUsername: d.chatLibrary.friendsDict[s].name,
                        userId: a.ActorTargetId,
                        placeName: c,
                        encodedPlaceName: i,
                      }),
                      (i = [r]),
                      (r = [t]),
                      d.fetchPlaceDetailsIntoPlacesLibrary(i, r),
                      b.setPinGameData(t, c));
                }
              } catch (e) {
                var l = "ChatNotifications:".concat(a.Type, ": ");
                e && e.message && (l += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    l,
                  );
              }
            }),
            (d.handleFeatureInterventions = function (a) {
              u.debug(
                "--------- this is "
                  .concat(
                    g.notificationsName.FeatureIntervention,
                    " subscription ----------- ",
                  )
                  .concat(a.type),
              );
              try {
                if ("party_chat" !== a.abuseVector) return;
                switch (a.type) {
                  case g.notificationType.featureInterventionTypeNudge:
                    K(a.decisionEventId);
                    break;
                  case g.notificationType.featureInterventionTypeTimeout:
                    var e = new Date(a.timeoutStartTime).getTime(),
                      t = new Date(e + 1e3 * a.timeoutDurationSeconds),
                      e = e - Date.now();
                    r(
                      function () {
                        Z({
                          conversationId: a.vectorTargetId,
                          timeout: {
                            endTime: t,
                            durationSeconds: a.timeoutDurationSeconds,
                            eventId: a.decisionEventId,
                          },
                        }),
                          d.showTimeoutModal(a.vectorTargetId);
                      },
                      Math.max(0, e),
                    );
                }
              } catch (e) {
                var i = ""
                  .concat(g.notificationsName.FeatureIntervention, ":")
                  .concat(a.type, ": ");
                e && e.message && (i += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    i,
                  );
              }
            });
          var K = function (a) {
            function e(e) {
              U.sendInterventionEvent({
                eventType: e,
                interventionType: F.interventionTypes.partyChatNudge,
                renderedTimestamp: t,
                eventId: a,
              });
            }
            var t = Date.now();
            Roblox.Dialog.open({
              titleText: k.get("Heading.DontSharePersonalInformation"),
              bodyContent: k.get("Description.PartyChatMayBeSuspended"),
              xToCancel: !0,
              acceptText: k.get("Action.Understand"),
              acceptColor: Roblox.Dialog.green,
              onAccept: function () {
                e(F.eventTypes.ctaClicked);
              },
              declineText: k.get("Action.LearnMore"),
              onDecline: function () {
                e(F.eventTypes.learnClicked),
                  s.open(d.chatLibrary.chatTimeoutsLearnMoreUrl, "_blank");
              },
              allowHtmlContentInFooter: !0,
              footerText: '<a id="intervention-mistake-btn">'.concat(
                k.get("Description.Mistake"),
                "</a>",
              ),
              cssClass: "chat-intervention-modal",
            }),
              e(F.eventTypes.modalAppeared),
              ie()
                .element("#intervention-mistake-btn")
                .bind("click", function () {
                  N.showSystemFeedback(
                    ""
                      .concat(k.get("Heading.TakeALook"), " - ")
                      .concat(k.get("Description.FeedbackHelps")),
                  ),
                    e(F.eventTypes.appealClicked),
                    Roblox.Dialog.close();
                });
          };
          d.showTimeoutModal = function (e) {
            Roblox.Dialog.close();
            var t,
              i,
              a,
              r,
              n,
              o = Y(e);
            o &&
              ((i = function (e) {
                ie()
                  .element(".chat-timeout-modal .modal-title")
                  .text(
                    k.get("Heading.PartyChatSuspended", {
                      remainingTime: x.format(e),
                    }),
                  ),
                  e <= 0 && Roblox.Dialog.close();
              }),
              (a = d.$watch(
                function () {
                  return d.getTimeoutExpiresAt(e);
                },
                function (e, a) {
                  e !== a &&
                    (x.cancel(t),
                    e ? (t = x.start(e, i)) : Roblox.Dialog.close());
                },
              )),
              (r = Date.now()),
              (n = function (e) {
                U.sendInterventionEvent({
                  eventType: e,
                  interventionType: F.interventionTypes.partyChatTimeout,
                  renderedTimestamp: r,
                  eventId: o.eventId,
                  durationSeconds: o.durationSeconds,
                });
              }),
              Roblox.Dialog.open({
                titleText: k.get("Heading.PartyChatSuspended", {
                  remainingTime: "",
                }),
                bodyContent: k.get("Description.CantUsePartyChat"),
                xToCancel: !0,
                acceptText: k.get("Action.Understand"),
                acceptColor: Roblox.Dialog.green,
                onAccept: function () {
                  n(F.eventTypes.ctaClicked);
                },
                declineText: k.get("Action.LearnMore"),
                onDecline: function () {
                  n(F.eventTypes.learnClicked),
                    s.open(d.chatLibrary.chatTimeoutsLearnMoreUrl, "_blank");
                },
                allowHtmlContentInFooter: !0,
                footerText: '<a id="intervention-mistake-btn">'.concat(
                  k.get("Description.Mistake"),
                  "</a>",
                ),
                onCloseCallback: function () {
                  x.cancel(t), a();
                },
                cssClass: "chat-intervention-modal chat-timeout-modal",
              }),
              (t = x.start(o.endTime.getTime(), i)),
              n(F.eventTypes.modalAppeared),
              ie()
                .element("#intervention-mistake-btn")
                .bind("click", function () {
                  N.showSystemFeedback(
                    ""
                      .concat(k.get("Heading.TakeALook"), " - ")
                      .concat(k.get("Description.FeedbackHelps")),
                  ),
                    n(F.eventTypes.appealClicked),
                    Roblox.Dialog.close();
                }));
          };
          var Z = function (e) {
              var a = e.conversationId,
                e = e.timeout,
                a = null != a ? a : "user";
              d.chatTimeouts[a] = e;
            },
            Y = function (e) {
              var a =
                d.chatUserDict[
                  null === (a = d.chatLibrary.conversationsDict[e]) ||
                  void 0 === a
                    ? void 0
                    : a.layoutId
                ];
              if (
                (null == a ? void 0 : a.moderationType) !==
                g.moderationType.TRUSTED_COMMS
              ) {
                (a = d.chatTimeouts.user), (e = e ? d.chatTimeouts[e] : null);
                return a && e
                  ? a.endTime > e.endTime
                    ? a
                    : e
                  : a || e || void 0;
              }
            };
          (d.getTimeoutExpiresAt = function (e) {
            var a;
            return null === (e = Y(e)) ||
              void 0 === e ||
              null === (a = e.endTime) ||
              void 0 === a
              ? void 0
              : a.getTime();
          }),
            (d.handleFriendshipNotifications = function (a) {
              u.debug(
                "--------- this is FriendshipNotifications subscription -----------".concat(
                  a.Type,
                ),
              );
              try {
                switch (a.Type) {
                  case g.notificationType.friendshipDestroyed:
                    var e = a.EventArgs;
                    ie().forEach(e, function (e) {
                      e !== d.chatLibrary.userId &&
                        d.$digest(d.removeFriend(e));
                    }),
                      M.getFriendsPresence(!0).then(
                        function (e) {
                          d.getFriendsInfo(e);
                        },
                        function (e) {
                          console.debug(e);
                        },
                      ),
                      i.triggerHandler("Roblox.Friends.CountChanged");
                    break;
                  case g.notificationType.friendshipCreated:
                    M.getFriendsPresence(!0).then(
                      function (e) {
                        d.getFriendsInfo(e);
                      },
                      function (e) {
                        console.debug(e);
                      },
                    ),
                      d.getUserConversationsFromCursor("", !0),
                      i.triggerHandler("Roblox.Friends.CountChanged");
                }
              } catch (e) {
                var t = "FriendshipNotifications:".concat(a.Type, ": ");
                e && e.message && (t += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    t,
                  );
              }
            }),
            (d.handleUserTagNotifications = function (e) {
              e.Type === g.notificationType.userTagUpdate &&
                S.getUserContacts(
                  Object.keys(d.chatLibrary.friendsDict),
                  d.chatLibrary.friendsDict,
                  S.options.skipCache,
                );
            }),
            (d.buildPlayTogetherInConversationFromPresence = function (
              e,
              i,
              r,
            ) {
              ie().forEach(e, function (e) {
                var a = d.chatUserDict[e],
                  t = [i];
                f.sortPlayTogetherIds(a, r),
                  d.fetchPlaceDetailsIntoPlacesLibrary(t, [a]),
                  d.chatLibrary.dialogDict[e] &&
                    (a.pinGame &&
                      i === a.pinGame.rootPlaceId &&
                      r.userId !== d.chatLibrary.userId &&
                      ((a.recentUserIdFromPresence = r.userId),
                      (a.recentPlaceIdFromPresence = i),
                      l.buildSystemMessage(
                        g.notificationType.presenceOnline,
                        a,
                      )),
                    !(e = d.chatLibrary.dialogsLayout[e]).togglePopoverParams
                      .isOpen &&
                      !a.placeForShown &&
                      a.playTogetherIds &&
                      0 < a.playTogetherIds.length &&
                      (e.togglePopoverParams.isOpen = !0)),
                  f.setPlaceForShown(a);
              });
            }),
            (d.releasePlayerFromActivePlaceLists = function (e, r) {
              ie().forEach(e, function (e) {
                var t = d.chatUserDict[e],
                  i = [];
                ie().forEach(t.playTogetherDict, function (e, a) {
                  var t;
                  (a = parseInt(a)),
                    -1 < e.playerIds.indexOf(r) &&
                      ((t = e.playerIds.indexOf(r)),
                      e.playerIds.splice(t, 1),
                      0 === e.playerIds.length && i.push(a));
                }),
                  i &&
                    0 < i.length &&
                    ie().forEach(i, function (e) {
                      var a = t.playTogetherIds.indexOf(e);
                      t.playTogetherIds.splice(a, 1),
                        delete t.playTogetherDict[e];
                    }),
                  f.setPlaceForShown(t),
                  t.pinGame &&
                    t.pinGame.rootPlaceId &&
                    ((e = t.pinGame.rootPlaceId),
                    v.updateButtonLayoutPerConversation(t, e));
              });
            }),
            (d.vanishRootPlaceIdFromPlayTogether = function (r, n, e) {
              ie().forEach(e, function (e) {
                var t = d.chatUserDict[e],
                  i = [];
                ie().forEach(t.playTogetherDict, function (e, a) {
                  (a = parseInt(a)),
                    n === a &&
                      1 === e.playerIds.length &&
                      -1 < e.playerIds.indexOf(r) &&
                      i.push(a);
                }),
                  i &&
                    0 < i.length &&
                    ie().forEach(i, function (e) {
                      var a = t.playTogetherIds.indexOf(e);
                      t.playTogetherIds.splice(a, 1),
                        delete t.playTogetherDict[e];
                    });
              });
            }),
            (d.updatePresenceInFriendDict = function (e) {
              (d.chatLibrary.friendsDict[e.userId].userPresenceType =
                e.userPresenceType),
                (d.chatLibrary.friendsDict[e.userId].presenceData = e),
                (d.chatLibrary.friendsDict[e.userId].presence = e);
            }),
            (d.updatePresenceStatus = function (e) {
              for (var a = 0; a < e.length; a++) {
                var t = e[a],
                  i = t.userId;
                d.chatLibrary.friendsDict[i] ||
                  (d.chatLibrary.friendsDict[i] = {});
                var r,
                  n = t.userPresenceType,
                  o = d.chatLibrary.friendsDict[i].presence,
                  s = null;
                n === L.status.inGame
                  ? ((r = t.rootPlaceId),
                    (o && n === o.userPresenceType && r === o.rootPlaceId) ||
                      ((s = d.chatLibrary.layoutIdsDictPerUserId[i]),
                      o &&
                        o.rootPlaceId &&
                        d.vanishRootPlaceIdFromPlayTogether(
                          i,
                          o.rootPlaceId,
                          s,
                        ),
                      d.updatePresenceInFriendDict(t),
                      r &&
                        d.buildPlayTogetherInConversationFromPresence(s, r, t)))
                  : (o && n === o.userPresenceType) ||
                    (d.updatePresenceInFriendDict(t),
                    o &&
                      o.userPresenceType === L.status.inGame &&
                      ((s = d.chatLibrary.layoutIdsDictPerUserId[i]),
                      d.releasePlayerFromActivePlaceLists(s, i)));
              }
            }),
            (d.listenToPresenceServiceInWeb = function () {
              document.addEventListener("Roblox.Presence.Update", function (e) {
                null != e &&
                  e.detail &&
                  r(function () {
                    d.updatePresenceStatus(e.detail);
                  }, 0);
              });
            }),
            (d.unsubscribeRealTimeForChat = function () {
              W.Unsubscribe(
                g.notificationsName.CommunicationChannelsNotifications,
                d.handleChannelsNotifications,
              ),
                W.Unsubscribe(
                  g.notificationsName.ChatMigrationNotifications,
                  d.handleChatMigrationNotifications,
                ),
                W.Unsubscribe(
                  g.notificationsName
                    .ChatModerationTypeEligibilityNotifications,
                  d.handleChatModerationTypeEligibilityNotifications,
                ),
                W.Unsubscribe(
                  g.notificationsName.ChatNotifications,
                  d.handleChatNotifications,
                ),
                W.Unsubscribe(
                  g.notificationsName.ExperienceIntervention,
                  d.handleFeatureInterventions,
                ),
                W.Unsubscribe(
                  g.notificationsName.FeatureIntervention,
                  d.handleFeatureInterventions,
                ),
                W.Unsubscribe(
                  g.notificationsName.FriendshipNotifications,
                  d.handleFriendshipNotifications,
                ),
                W.Unsubscribe(
                  g.notificationsName.UserTagNotifications,
                  d.handleUserTagNotifications,
                );
            }),
            (d.handleUserSettingsChanged = function (a) {
              u.debug(
                "--------- this is UserSettingsChangedNotifications subscription -----------".concat(
                  a.Type,
                ),
              );
              try {
                if (
                  null === (e = d.chatLibrary) ||
                  void 0 === e ||
                  !e.isWebChatSettingsMigrationEnabled
                )
                  return;
                var e =
                  null !== (e = a.SettingsChanged) && void 0 !== e ? e : [];
                if (
                  !(
                    e.includes("WhoCanChatWithMeInApp") ||
                    e.includes("WhoCanGroupChatWithMeInApp") ||
                    e.includes("WhoCanOneOnOnePartyWithMe") ||
                    e.includes("WhoCanGroupPartyWithMe")
                  )
                )
                  return;
                var t = d.getIsChatEnabled();
                return d
                  .fetchAllWebChatSettings(!0)
                  .then(function (e) {
                    d.parseChatSettingsResponsesForChatEnabled(e);
                    e = d.getIsChatEnabled();
                    e
                      ? !t &&
                        e &&
                        (d.handleSignalRSuccess(!0),
                        d.initializeRealTimeSubscriptionsForChat(),
                        Q(R()))
                      : d.unsubscribeRealTimeForChat(),
                      d.maybeCloseNewGroupDialog(),
                      d.$apply();
                  })
                  .catch(function (e) {
                    u.debug("Error getting chat user settings", e);
                  });
              } catch (e) {
                var i = "UserSettingsChanged:".concat(a.Type, ": ");
                e && e.message && (i += e.message),
                  y.fireEvent(
                    d.chatLibrary.googleAnalyticsEvent.category,
                    d.chatLibrary.googleAnalyticsEvent.action,
                    i,
                  );
              }
            }),
            (d.initializeRealTimeSubscriptionsForUserSetttingsChanged =
              function () {
                ie().isDefined(W) &&
                  W.Subscribe(
                    g.notificationsName.UserSettingsChangedNotifications,
                    d.handleUserSettingsChanged,
                  );
              }),
            (d.initializeRealTimeSubscriptionsForChat = function () {
              ie().isDefined(W) &&
                (p.logSinglePerformanceMark(
                  g.performanceMarkLabels.chatSignalRInitializing,
                ),
                W.SubscribeToConnectionEvents(
                  d.handleSignalRSuccess,
                  d.handleSignalRSuccess,
                  d.handleSignalRError,
                  g.notificationsName.ChatNotifications,
                ),
                W.Subscribe(
                  g.notificationsName.CommunicationChannelsNotifications,
                  d.handleChannelsNotifications,
                ),
                W.Subscribe(
                  g.notificationsName.ChatMigrationNotifications,
                  d.handleChatMigrationNotifications,
                ),
                W.Subscribe(
                  g.notificationsName
                    .ChatModerationTypeEligibilityNotifications,
                  d.handleChatModerationTypeEligibilityNotifications,
                ),
                W.Subscribe(
                  g.notificationsName.ChatNotifications,
                  d.handleChatNotifications,
                ),
                d.chatLibrary.useChatTimeouts &&
                  (W.Subscribe(
                    g.notificationsName.ExperienceIntervention,
                    d.handleFeatureInterventions,
                  ),
                  W.Subscribe(
                    g.notificationsName.FeatureIntervention,
                    d.handleFeatureInterventions,
                  )),
                W.Subscribe(
                  g.notificationsName.FriendshipNotifications,
                  d.handleFriendshipNotifications,
                ),
                W.Subscribe(
                  g.notificationsName.UserTagNotifications,
                  d.handleUserTagNotifications,
                ),
                d.listenToPresenceServiceInWeb());
            }),
            (d.handleSignalRSuccess = function (e) {
              if (
                (u.debug(" -------- Signal R is connected ------ "),
                d.chatLibrary.chatLayout.errorMaskEnable &&
                  d.$apply(function () {
                    d.chatLibrary.chatLayout.errorMaskEnable = !1;
                  }),
                d.chatLibrary.timer && r.cancel(d.chatLibrary.timer),
                e ||
                  p.logSinglePerformanceMark(
                    g.performanceMarkLabels.chatSignalRSucceeded,
                  ),
                d.chatLibrary.chatLayout.pageInitializing)
              )
                d.chatLibrary.chatLayout.pageInitializing = !1;
              else
                try {
                  e && (d.initializePresetData(), d.initializeChat());
                } catch (e) {
                  var a = "handleSignalRSuccess: ";
                  e && e.message && (a += e.message),
                    y.fireEvent(
                      d.chatLibrary.googleAnalyticsEvent.category,
                      d.chatLibrary.googleAnalyticsEvent.action,
                      a,
                    );
                }
            }),
            (d.handleSignalRError = function () {
              u.debug(" -------- Signal R is disconnected ------ "),
                (d.chatLibrary.timer = r(function () {
                  d.chatLibrary.chatLayout.errorMaskEnable = !0;
                }, parseInt(d.chatLibrary.signalRDisconnectionResponseInMilliseconds)));
            }),
            (d.onResize = function () {
              if (
                d.chatLibrary.chatLayout.numberOfDialogs >
                d.chatLibrary.chatLayout.availableNumberOfDialogs
              )
                for (
                  ;
                  d.chatLibrary.dialogIdList.length >
                  d.chatLibrary.chatLayout.availableNumberOfDialogs;

                ) {
                  u.debug(
                    " -------------overflow ------ $scope.chatLibrary.dialogIdList.length ------------- ".concat(
                      d.chatLibrary.dialogIdList.length,
                    ),
                  );
                  var e = d.chatLibrary.dialogIdList.pop();
                  if (ie().isUndefined(e)) break;
                  e &&
                    d.chatLibrary.dialogDict[e] &&
                    ((d.chatLibrary.dialogDict[e].isUpdated = !0),
                    (d.chatLibrary.dialogDict[e].updateStatus =
                      g.dialogStatus.MINIMIZE));
                }
              else if (
                d.chatLibrary.chatLayout.numberOfDialogs <
                d.chatLibrary.chatLayout.availableNumberOfDialogs
              )
                for (
                  ;
                  d.chatLibrary.dialogIdList.length <
                  d.chatLibrary.chatLayout.availableNumberOfDialogs;

                ) {
                  u.debug(
                    " -------------fit ------ $scope.chatLibrary.dialogIdList.length ------------- ".concat(
                      d.chatLibrary.dialogIdList.length,
                    ),
                  );
                  var a,
                    e = d.chatLibrary.minimizedDialogIdList.pop();
                  if (ie().isUndefined(e)) break;
                  e &&
                    d.chatLibrary.minimizedDialogData[e] &&
                    (delete d.chatLibrary.minimizedDialogData[e],
                    d.chatLibrary.dialogIdList.push(e),
                    (a = se({}, g.dialogInitValue)),
                    (d.chatLibrary.dialogDict[e] = a));
                }
              d.chatLibrary.chatLayout.resizing = !1;
            }),
            (d.getLayoutId = function (e, a) {
              switch (a) {
                case g.dialogType.FRIEND:
                  return "friend_".concat(e);
                case g.dialogType.NEWGROUPCHAT:
                  return g.newGroup.dialogType;
                case g.dialogType.CHAT:
                case g.dialogType.GROUPCHAT:
                case g.dialogType.ADDFRIENDS:
                default:
                  return "conv_".concat(e);
              }
            }),
            (d.getUserInfoForConversation = function (n) {
              var o;
              n.participants &&
                ((n.userIds = []),
                (n.candidatePlayerIds = []),
                (o = []),
                n.participants.forEach(function (e) {
                  var a,
                    t,
                    i = e.id,
                    r = e.name;
                  switch (n.dialogType) {
                    case d.dialogType.GROUPCHAT:
                      n.userIds.push(i),
                        i !== d.chatLibrary.userId &&
                          ((n.playerIds && n.playerIds.indexOf(i) < 0) ||
                            !n.playerIds) &&
                          n.candidatePlayerIds.push(i);
                      break;
                    case d.dialogType.FRIEND:
                    case d.dialogType.CHAT:
                      i !== d.chatLibrary.userId &&
                        (n.userIds.push(i),
                        (n.displayUserId = i),
                        (n.username = r),
                        ((n.playerIds && n.playerIds.indexOf(i) < 0) ||
                          !n.playerIds) &&
                          n.candidatePlayerIds.push(i));
                      break;
                    default:
                      n.userIds.push(i);
                  }
                  i !== d.chatLibrary.userId &&
                    d.buildPlayTogetherListForEachConveration(e, n),
                    d.chatLibrary.friendsDict[i] ||
                      (o.push(i),
                      (a = e.name),
                      (t = e.display_name),
                      (e = e.combined_name),
                      (d.chatLibrary.friendsDict[i] = {
                        id: i,
                        name: a,
                        display_name: t,
                        nameForDisplay: e || t || a,
                      })),
                    d.chatLibrary.layoutIdsDictPerUserId[i] ||
                      (d.chatLibrary.layoutIdsDictPerUserId[i] = []),
                    d.chatLibrary.layoutIdsDictPerUserId[i].indexOf(
                      n.layoutId,
                    ) < 0 &&
                      d.chatLibrary.layoutIdsDictPerUserId[i].push(n.layoutId);
                }),
                0 < o.length &&
                  D.getUserInfo(o, d.chatLibrary.friendsDict).then(
                    function (e) {
                      e &&
                        (o.forEach(function (e) {
                          e = d.chatLibrary.friendsDict[e];
                          d.buildPlayTogetherListForEachConveration(e, n),
                            d.getPlaceDetailsForNewPlaceIds([n]);
                        }),
                        S.getUserContacts(
                          o,
                          d.chatLibrary.friendsDict,
                          S.options.noCache,
                        ));
                    },
                  ),
                f.setPlaceForShown(n));
            }),
            (d.buildPlayTogetherListForEachConveration = function (e, a) {
              if (!d.chatLibrary.friendsDict) return !1;
              e = d.chatLibrary.friendsDict[e.id];
              e &&
                e.presence &&
                e.presence.userPresenceType === L.status.inGame &&
                f.sortPlayTogetherIds(a, e.presence);
            }),
            (d.updateChatViewModel = function (i, e) {
              switch (
                (i.isGroupChat ||
                  i.dialogType !== g.dialogType.CHAT ||
                  i.participants.forEach(function (e) {
                    e = e.id;
                    e !== d.chatLibrary.userId &&
                      ((e = d.getLayoutId(e, g.dialogType.FRIEND)),
                      d.replaceConversation(e, i));
                  }),
                i.dialogType)
              ) {
                case d.dialogType.GROUPCHAT:
                case d.dialogType.CHAT:
                  (i.name = i.title),
                    (d.chatLibrary.allConversationLayoutIdsDict[i.id] =
                      i.layoutId);
                  break;
                default:
                  ie().isDefined(i.Username) && (i.name = i.Username);
              }
              var a = [te.UserProfileField.Names.CombinedName],
                t = i.userIds,
                r = i.isGroupChat;
              E.watchUserProfiles(t, a).subscribe(function (e) {
                e.loading, e.error;
                var a = e.data,
                  t = [];
                ie().forEach(Object.entries(a), function (e) {
                  var a = oe(e, 2),
                    e = a[0],
                    a = a[1];
                  d.chatLibrary.friendsDict[e] &&
                    ((d.chatLibrary.friendsDict[e].nameForDisplay =
                      a.names.combinedName),
                    t.push(a.names.combinedName));
                }),
                  t.sort();
                e = t.join(", ");
                r
                  ? ((a = i.conversationTitle.titleForViewer),
                    g.updateConversationTitle(i, i.hasDefaultName ? e : a))
                  : g.updateConversationTitle(i, e),
                  d.$applyAsync();
              }),
                (d.chatUserDict[i.layoutId] = i);
              a = d.chatLibrary.chatLayoutIds.indexOf(i.layoutId);
              -1 < a && d.chatLibrary.chatLayoutIds.splice(a, 1),
                e
                  ? ((e = d.chatLibrary.chatLayoutIds[0]),
                    d.chatUserDict[e],
                    d.chatLibrary.chatLayoutIds.unshift(i.layoutId))
                  : d.chatLibrary.chatLayoutIds.push(i.layoutId),
                V(i.layoutId),
                d.chatLibrary.conversationsDict[i.id] ||
                  ((d.chatLibrary.conversationsDict[i.id] = se(
                    {},
                    g.conversationInitStatus,
                  )),
                  (d.chatLibrary.conversationsDict[i.id].layoutId =
                    i.layoutId));
            }),
            (d.updateConversationInLocalStorage = function (e) {
              var a = {
                  pageNumber: 1,
                  pageSize: d.chatApiParams.pageSizeOfConversations,
                },
                t = I.getStorageName(I.chatDataName.getUserConversations, a),
                a = I.getChatDataFromLocalStorage(t);
              a &&
                ((a = a.data).unshift(e), I.saveChatDataToLocalStorage(t, a));
            }),
            (d.buildChatUserListByUnreadConversations = (function () {
              var t = ne(
                regeneratorRuntime.mark(function e(s, c) {
                  var a, t;
                  return regeneratorRuntime.wrap(function (e) {
                    for (;;)
                      switch ((e.prev = e.next)) {
                        case 0:
                          (a = regeneratorRuntime.mark(function e(a) {
                            var t, i, r, n, o;
                            return regeneratorRuntime.wrap(function (e) {
                              for (;;)
                                switch ((e.prev = e.next)) {
                                  case 0:
                                    return (
                                      ((t = s[a]).isGroupChat =
                                        g.conversationType
                                          .multiUserConversation === t.type),
                                      (t.dialogType = t.isGroupChat
                                        ? g.dialogType.GROUPCHAT
                                        : g.dialogType.CHAT),
                                      d.getUserInfoForConversation(t),
                                      (o = [
                                        te.UserProfileField.Names.CombinedName,
                                      ]),
                                      (i = t.userIds),
                                      (r = []),
                                      (e.next = 9),
                                      E.queryUserProfiles(i, o)
                                    );
                                  case 9:
                                    (o = e.sent),
                                      ie().forEach(o, function (e) {
                                        r.push(e.names.combinedName);
                                      }),
                                      r.sort(),
                                      (o = r.join(", ")),
                                      t.isGroupChat
                                        ? ((n =
                                            t.conversationTitle.titleForViewer),
                                          g.updateConversationTitle(
                                            t,
                                            t.hasDefaultName ? o : n,
                                          ))
                                        : g.updateConversationTitle(t, o),
                                      (t.isUserPending = d.getIsUserPending(t)),
                                      (t.isConversationUnavailableWithUser =
                                        d.getIsConversationDisabledWithUser(t)),
                                      l.formatTimestampInConversation(t),
                                      (n = d.getLayoutId(
                                        t.id,
                                        g.dialogType.CHAT,
                                      )),
                                      d.chatUserDict[n]
                                        ? ((o = d.chatUserDict[n]),
                                          t.hasUnreadMessages &&
                                            t.chatMessages &&
                                            0 < t.chatMessages.length &&
                                            ((o.hasUnreadMessages = !0),
                                            d.chatLibrary.dialogDict[n] &&
                                              -1 <
                                                d.chatLibrary.dialogIdList.indexOf(
                                                  n,
                                                ) &&
                                              (l.processMessages(
                                                d.chatLibrary,
                                                o,
                                                t.chatMessages,
                                                d.chatLibrary.friendsDict,
                                              ),
                                              v.fetchDataForLinkCard(
                                                t.chatMessages,
                                                d.chatLibrary,
                                              )),
                                            l.updatePreviewMessage(
                                              o,
                                              t.chatMessages,
                                            ),
                                            d.updateChatViewModel(o, !0)),
                                          t.title !== o.title &&
                                            g.updateConversationTitle(
                                              o,
                                              t.title,
                                            ),
                                          (o.participants = t.participants),
                                          (o.isUserPending = t.isUserPending),
                                          (o.isConversationUnavailableWithUser =
                                            t.isConversationUnavailableWithUser),
                                          (o.moderationType = t.moderationType),
                                          (o.participantPendingStatus =
                                            t.participantPendingStatus),
                                          (o.userPendingStatus =
                                            t.userPendingStatus),
                                          (o.osaAcknowledgementStatus =
                                            t.osaAcknowledgementStatus),
                                          d.getUserInfoForConversation(o),
                                          c && j(o))
                                        : (d.updateConversationInLocalStorage(
                                            t,
                                          ),
                                          (t.layoutId = n),
                                          d.updateChatViewModel(t, !0),
                                          c && j(t)),
                                      d.$apply();
                                  case 20:
                                  case "end":
                                    return e.stop();
                                }
                            }, e);
                          })),
                            (t = 0);
                        case 2:
                          if (t < s.length)
                            return e.delegateYield(a(t), "t0", 4);
                          e.next = 7;
                          break;
                        case 4:
                          t++, (e.next = 2);
                          break;
                        case 7:
                          return (
                            ie().equals(d.chatUserDict, {}) ||
                              (d.chatLibrary.chatLayout.chatLandingEnabled =
                                !1),
                            e.abrupt("return", s)
                          );
                        case 9:
                        case "end":
                          return e.stop();
                      }
                  }, e);
                }),
              );
              return function (e, a) {
                return t.apply(this, arguments);
              };
            })()),
            (d.getPlaceDetailsForNewPlaceIds = function (e) {
              var a,
                r = [],
                n = [];
              e.forEach(function (t) {
                var e,
                  i = d.chatLibrary.placesLibrary;
                t.pinGame &&
                  ((e = t.pinGame.rootPlaceId),
                  !g.isPlaceDetailQualifiedInLibrary(i, e) &&
                    r.indexOf(e) < 0 &&
                    r.push(e)),
                  t.playTogetherIds &&
                    0 < t.playTogetherIds.length &&
                    t.playTogetherIds.forEach(function (e) {
                      !g.isPlaceDetailQualifiedInLibrary(i, e) &&
                        r.indexOf(e) < 0 &&
                        r.push(e);
                      var a = t.id;
                      (t.placeButtonLayout && t.placeButtonLayout[e]) ||
                        !(n.indexOf(a) < 0) ||
                        n.push(a);
                    });
              }),
                0 < r.length
                  ? d.fetchPlaceDetailsIntoPlacesLibrary(r, e)
                  : 0 < n.length &&
                    ((a = d.chatLibrary.placesLibrary),
                    ie().forEach(e, function (e) {
                      -1 < n.indexOf(e.id) &&
                        v.buildButtonLayoutPerConversation(e, a);
                    }));
            }),
            (d.isConversationExistedInViewModel = function (e) {
              if (e && e.layoutId) {
                e = e.layoutId;
                return d.chatUserDict && d.chatUserDict[e];
              }
              return !1;
            }),
            (d.getIsUserPending = function (e) {
              return e.userPendingStatus === g.pendingStatus.PENDING;
            }),
            (d.getIsConversationDisabledWithUser = function (e) {
              return (
                !(
                  !d.chatLibrary.isWebChatRegionalityEnabled &&
                  !d.chatLibrary.isWebChatSettingsMigrationEnabled
                ) && e.participantPendingStatus === g.pendingStatus.PENDING
              );
            }),
            (d.buildChatUserListByConversations = function (e, i) {
              var r = [];
              e.forEach(function (e) {
                if (e.source === g.conversationSource.FRIENDS) {
                  if (!e || !e.participants) return;
                  var a = null;
                  if (
                    (e.participants.forEach(function (e) {
                      e = e.id;
                      e === d.chatLibrary.userId || a || (a = e);
                    }),
                    !a)
                  )
                    return;
                  (e.id = a), (e.dialogType = g.dialogType.FRIEND);
                }
                var t = d.getLayoutId(e.id, e.dialogType);
                r.push(e.id),
                  (e.layoutId = t),
                  d.getUserInfoForConversation(e),
                  (e.isUserPending = d.getIsUserPending(e)),
                  (e.isConversationUnavailableWithUser =
                    d.getIsConversationDisabledWithUser(e)),
                  d.isConversationExistedInViewModel(e) ||
                    d.updateChatViewModel(e, i);
              }),
                d.processLatestMessageForConversations(
                  e.map(function (e) {
                    return { conversationId: e.id, messages: e.messages };
                  }),
                ),
                d.getPlaceDetailsForNewPlaceIds(e),
                ie().equals(d.chatUserDict, {}) ||
                  (d.chatLibrary.chatLayout.chatLandingEnabled = !1);
            }),
            (d.openConversation = function () {
              var e = d.chatLibrary.dialogRequestedToOpenParams.layoutId,
                a = d.chatLibrary.dialogRequestedToOpenParams.autoPop;
              d.chatUserDict[e] && (d.updateDialogList(e, a), d.$evalAsync());
            }),
            (d.openConversationFromFriendId = function (e, i) {
              return (
                (i = void 0 === i || "boolean" != typeof i || i),
                c.startOneToOneConversation(e).then(
                  function (e) {
                    var a,
                      t = d.getLayoutId(e.id, g.dialogType.CHAT);
                    return (
                      (e.layoutId = t),
                      (e.dialogType = g.dialogType.CHAT),
                      (e.chatMessages = []),
                      (e.isGroupChat =
                        e.type === g.conversationType.multiUserConversation),
                      d.getUserInfoForConversation(e),
                      v.buildButtonLayoutPerConversation(
                        e,
                        d.chatLibrary.placesLibrary,
                      ),
                      d.updateChatViewModel(e, i),
                      e.pinGame &&
                        ((a = e.pinGame.rootPlaceId),
                        d.fetchPlaceDetailsIntoPlacesLibrary([a], [e])),
                      g.updateFocusedDialog(d.chatLibrary, t),
                      l.formatTimestampInConversation(e),
                      e
                    );
                  },
                  function () {
                    u.debug(" ---- startOneToOneConversation ---- failed!");
                  },
                )
              );
            }),
            (d.destroyDialogLayout = function (e) {
              e = "#".concat(e);
              ie().element(e).empty();
            }),
            (d.deleteLayoutIdFromDialogList = function (e) {
              for (
                var a = d.chatLibrary.dialogIdList, t = [], i = 0;
                i < a.length;
                i++
              )
                a[i] === e && t.push(i);
              if (0 < t.length) {
                for (var r = t.length - 1; 0 <= r; r--)
                  d.chatLibrary.dialogIdList.splice(t[r], 1);
                delete d.chatLibrary.dialogDict[e];
              }
            }),
            (d.expandGameListInConversation = function (e) {
              e = d.chatUserDict[e];
              d.chatLibrary.playTogetherLibrary &&
                d.chatLibrary.playTogetherLibrary[e.id] &&
                (d.chatLibrary.playTogetherLibrary[
                  e.id
                ].layout.activeGamesList.isCollapsed = !0);
            }),
            (d.launchFromConversationList = function (e) {
              d.sendChatLandingEvent(
                A.chatLandingConversationClicked,
                O.ChatLandingConversationClickedWeb,
                e,
              ),
                d.launchDialog(e, !1);
            }),
            (d.launchDialog = function (e, a) {
              (d.chatLibrary.dialogRequestedToOpenParams.layoutId = e),
                (d.chatLibrary.dialogRequestedToOpenParams.autoPop = a);
              var t,
                i = d.chatUserDict[e];
              d.chatLibrary.dialogIdList.indexOf(e) < 0 &&
              e === g.newGroup.layoutId
                ? (d.updateDialogList(e, a),
                  (d.chatUserDict[g.newGroup.layoutId] = d.newGroup))
                : d.chatLibrary.dialogIdList.indexOf(e) < 0 && i
                  ? (d.openConversation(),
                    d.expandGameListInConversation(e),
                    a || g.updateFocusedDialog(d.chatLibrary, e))
                  : -1 < d.chatLibrary.dialogIdList.indexOf(e) &&
                    d.chatLibrary.dialogsLayout[e] &&
                    (((t = d.chatLibrary.dialogsLayout[e]).focusMeEnabled = !0),
                    g.updateFocusedDialog(d.chatLibrary, e),
                    t.collapsed &&
                      ((t.collapsed = !1),
                      g.updateDialogsPosition(d.chatLibrary))),
                i &&
                  !a &&
                  l.markMessagesAsRead(
                    i,
                    d.chatLibrary
                      .shouldRespectConversationHasUnreadMessageToMarkAsRead,
                  ),
                Q(i ? [i] : []);
            });
          var Q = (function () {
              var e = ne(
                regeneratorRuntime.mark(function e(a) {
                  var t, i, r, n, o;
                  return regeneratorRuntime.wrap(function (e) {
                    for (;;)
                      switch ((e.prev = e.next)) {
                        case 0:
                          if (d.chatLibrary.useChatTimeouts && a) {
                            e.next = 2;
                            break;
                          }
                          return e.abrupt("return");
                        case 2:
                          if (
                            0 ===
                            (t = a.filter(function (e) {
                              return (
                                e.moderationType !==
                                g.moderationType.TRUSTED_COMMS
                              );
                            })).length
                          )
                            return e.abrupt("return");
                          e.next = 5;
                          break;
                        case 5:
                          return (
                            (i = t
                              .filter(function (e) {
                                return (
                                  e.source === g.conversationSource.CHANNELS
                                );
                              })
                              .map(function (e) {
                                return e.id;
                              })),
                            (e.next = 8),
                            c.getChatModerationStatuses(i)
                          );
                        case 8:
                          if (
                            ((r = e.sent),
                            (i = r.user_timeout_range),
                            (r = r.conversation_timeout_ranges),
                            i && Z({ timeout: X(i) }),
                            r)
                          ) {
                            n = re(r);
                            try {
                              for (n.s(); !(o = n.n()).done; )
                                (o = o.value),
                                  Z({
                                    conversationId: o.id,
                                    timeout: X(o.timeout_range),
                                  });
                            } catch (e) {
                              n.e(e);
                            } finally {
                              n.f();
                            }
                          }
                        case 13:
                        case "end":
                          return e.stop();
                      }
                  }, e);
                }),
              );
              return function () {
                return e.apply(this, arguments);
              };
            })(),
            X = function (e) {
              var a = new Date(e.start_time),
                t = new Date(e.end_time);
              return {
                endTime: t,
                durationSeconds: (t.getTime() - a.getTime()) / 1e3,
                eventId: e.decision_event_id,
              };
            };
          (d.closeDialog = function (e) {
            var a = d.chatUserDict[e];
            a && ((t = g.getScrollBarSelector(a)), (t = ie().element(t)));
            var t;
            ie().element("#chat-main");
            d.chatLibrary.chatLayout.focusedLayoutId === e &&
              g.updateFocusedDialog(d.chatLibrary, null),
              d.deleteLayoutIdFromDialogList(e),
              a &&
                a.dialogType === g.dialogType.NEWGROUPCHAT &&
                ((a.selectedUserIds = []),
                (a.selectedUsersDict = {}),
                (a.numberOfSelected = 0)),
              t && 0 < t.length && t.mCustomScrollbar("destroy"),
              d.$broadcast("Roblox.Chat.MarkDialogInactive", { layoutId: e }),
              a &&
                ((t = a.id),
                d.chatLibrary.conversationsDict[t] &&
                d.chatLibrary.conversationsDict[t].remove
                  ? (-1 < (t = d.chatLibrary.chatLayoutIds.indexOf(e)) &&
                      a &&
                      (d.chatLibrary.chatLayoutIds.splice(t, 1),
                      delete d.chatUserDict[e],
                      ie().equals(d.chatUserDict, {}) &&
                        (d.chatLibrary.chatLayout.chatLandingEnabled = !0)),
                    V(e, !0))
                  : l.processMessages(d.chatLibrary, a, null)),
              d.destroyDialogLayout(e),
              0 < d.chatLibrary.minimizedDialogIdList.length &&
                ((a = d.chatLibrary.minimizedDialogIdList.shift()),
                delete d.chatLibrary.minimizedDialogData[a],
                d.chatLibrary.dialogIdList.push(a),
                (d.chatLibrary.dialogDict[a].isUpdated = !0),
                (d.chatLibrary.dialogDict[a].updateStatus =
                  g.dialogStatus.REPLACE)),
              n.updateStorage(
                n.storageDictionary.dialogIdList,
                d.chatLibrary.dialogIdList,
                d.chatLibrary.cookieOption,
              ),
              n.updateStorage(
                n.storageDictionary.dialogDict,
                d.chatLibrary.dialogDict,
                d.chatLibrary.cookieOption,
              ),
              d.chatLibrary.dialogsLayout &&
                d.chatLibrary.dialogsLayout[e] &&
                (d.chatLibrary.dialogsLayout[e].collapsed = !1),
              delete d.chatLibrary.dialogsLayout[e],
              n.updateStorage(
                n.storageDictionary.dialogsLayout,
                d.chatLibrary.dialogsLayout,
                d.chatLibrary.cookieOption,
              );
          }),
            (d.validLayoutId = function (e, a) {
              return (
                !!d.chatUserDict[e] ||
                (d.chatApiParams.loadMoreConversations
                  ? d.getUserConversations()
                  : (d.chatLibrary.chatLayout.urlParseInitialized = !0),
                !1)
              );
            }),
            (d.startSpecificConversationFromUserId = function (e) {
              var a = q(e);
              a && d.validLayoutId(a, g.dialogType.CHAT)
                ? ((d.chatLibrary.chatLayout.urlParseInitialized = !0),
                  d.launchDialog(a, !0))
                : d.openConversationFromFriendId(e);
            }),
            (d.startSpecificConversationFromConvId = function (e) {
              var a = d.getLayoutId(e, g.dialogType.CHAT);
              u.debug(
                "--attempting to open specific conversation on load: ".concat(
                  e,
                  "--",
                ),
              ),
                d.validLayoutId(a, g.dialogType.CHAT) &&
                  ((d.chatLibrary.chatLayout.urlParseInitialized = !0),
                  d.launchDialog(a));
            }),
            (d.openSettingsPage = function () {
              window.location.href = a.getAbsoluteUrl(
                g.linksLibrary.settingLink,
              );
            }),
            (d.getAvatars = function (e) {
              e &&
                0 < e.length &&
                D.getAvatarHeadshots(e, d.chatLibrary.friendsDict);
            }),
            (d.getFriendsInfo = function (e) {
              var n;
              d.chatLibrary.chatLayout.pageDataLoading &&
                (d.chatLibrary.chatLayout.pageDataLoading = !1),
                null != e &&
                  e.length &&
                  ((n = []),
                  ie().forEach(e, function (e) {
                    var a = e,
                      t = a.id;
                    n.push(t),
                      (a.id = parseInt(t, 10)),
                      (a.userId = parseInt(t, 10));
                    var i = a.name,
                      r = a.display_name,
                      e = a.combined_name;
                    (a.nameForDisplay = e || r || i),
                      d.chatLibrary.friendsDict[t] ||
                        (d.chatLibrary.friendsDict[t] = a);
                  }),
                  d.getAvatars(n));
            }),
            (d.initializeChat = function () {
              (d.chatUserDict && d.chatLibrary) || d.setup(),
                p.logSinglePerformanceMark(
                  g.performanceMarkLabels.chatConversationsLoading,
                ),
                d.updateUnreadConversationCount(),
                d.getUserConversations();
            }),
            (d.sendChatLandingEvent = function (a, e, t) {
              try {
                if (!d.chatLibrary.shouldSendEvents) return;
                U.incrementCounter(e);
                var i =
                    null !==
                      (n =
                        null === (r = d.chatUserDict) || void 0 === r
                          ? void 0
                          : r[t]) && void 0 !== n
                      ? n
                      : {},
                  r = i.hasUnreadMessages,
                  n = (null !== (n = d.chatViewModel) && void 0 !== n ? n : {})
                    .searchTerm,
                  r = {
                    localTimestamp: Date.now(),
                    isChatEnabled: d.getIsChatEnabled(),
                    isFiltered: !!n,
                    selectedConversationId: U.getConversationIdForAnalytics(i),
                    hasUnreadMessages: !!r,
                  };
                U.sendEvent(a, r);
              } catch (e) {
                u.debug(
                  "sendChatLandingEvent for Event "
                    .concat(a, " failed: ")
                    .concat(e),
                );
              }
            }),
            (d.sendWebChatRenderedEvent = function () {
              try {
                var e;
                if (!d.chatLibrary.shouldSendEvents) return;
                U.incrementCounter(O.WebChatRenderedWeb);
                var a = {
                  localTimestamp: Date.now(),
                  isChatEnabled: d.getIsChatEnabled(),
                  isChatOpen: !(
                    null !== (e = d.chatLibrary) &&
                    void 0 !== e &&
                    null !== (a = e.chatLayout) &&
                    void 0 !== a &&
                    a.collapsed
                  ),
                };
                U.sendEvent(A.webChatRendered, a);
              } catch (e) {
                u.debug("sendWebChatRenderedEvent failed: ".concat(e));
              }
            }),
            (d.sendWebChatConversationsLoadedEvent = function (e) {
              try {
                var a, t;
                if (!d.chatLibrary.shouldSendEvents) return;
                U.incrementCounter(O.WebChatConversationsLoadedWeb);
                var n = [],
                  o = [];
                ie().forEach(e, function (e) {
                  var a = e.id,
                    t = e.source,
                    e = e.participant_user_ids;
                  if (t === g.conversationSource.FRIENDS) {
                    if (e) {
                      var i = re(e);
                      try {
                        for (i.s(); !(r = i.n()).done; ) {
                          var r = r.value;
                          if (r !== d.chatLibrary.userId) {
                            o.push(r);
                            break;
                          }
                        }
                      } catch (e) {
                        i.e(e);
                      } finally {
                        i.f();
                      }
                    }
                  } else a && n.push(a);
                });
                var i = JSON.stringify(n).replace(/"/g, ""),
                  i = {
                    localTimestamp: Date.now(),
                    isChatOpen: !(
                      null !== (a = d.chatLibrary) &&
                      void 0 !== a &&
                      null !== (t = a.chatLayout) &&
                      void 0 !== t &&
                      t.collapsed
                    ),
                    conversationIds: i,
                    friendsConversationIds: JSON.stringify(o),
                  };
                U.sendEvent(A.webChatConversationsLoaded, i);
              } catch (e) {
                u.debug("sendWebChatConversationsLoaded failed: ".concat(e));
              }
            }),
            (d.initializeEvents = function () {
              ie()
                .element(s)
                .bind("resize", function () {
                  var e;
                  !d.chatLibrary.chatLayout.resizing &&
                    (0 < d.chatLibrary.dialogIdList.length ||
                      0 < d.chatLibrary.minimizedDialogIdList.length) &&
                    ((d.chatLibrary.chatLayout.resizing = !0),
                    G(),
                    d.dialogsOverflowWindow() ||
                    ((e = i.innerWidth()),
                    d.chatLibrary.chatLayout.numberOfDialogs <
                      d.chatLibrary.chatLayout.availableNumberOfDialogs &&
                      e > g.chatLayout.thresholdMobile)
                      ? (u.debug(" ------- need to resize -------------- "),
                        d.onResize())
                      : (d.chatLibrary.chatLayout.resizing = !1));
                }),
                d.$on("Roblox.Chat.destroyChatCookie", function () {
                  n.removeFromStorage(
                    n.storageDictionary.dialogIdList,
                    d.chatLibrary.cookieOption,
                  ),
                    n.removeFromStorage(
                      n.storageDictionary.dialogDict,
                      d.chatLibrary.cookieOption,
                    ),
                    n.removeFromStorage(
                      n.storageDictionary.dialogsLayout,
                      d.chatLibrary.cookieOption,
                    ),
                    n.removeFromStorage(
                      n.storageDictionary.chatBarLayout,
                      d.chatLibrary.cookieOption,
                    ),
                    n.removeFromStorage(
                      n.storageDictionary.chatFriendsListReloadTime,
                    ),
                    e.removeLocalStorage(d.chatLibrary.dialogLocalStorageName),
                    I.clearLocalStorage();
                }),
                d.$on("Roblox.Chat.LoadUnreadConversationCount", function () {
                  d.updateUnreadConversationCount();
                }),
                i.bind("Roblox.Chat.StartChat", function (e, a) {
                  d.startSpecificConversationFromUserId(a.userId);
                });
            }),
            (d.initializeServices = function (e) {
              c.setParams(),
                l.setParams(e),
                v.setParams(ae.EnvironmentUrls.gamesApi),
                I.setStorageParams(e);
            }),
            (d.initializeLayoutLibrary = function () {
              var e = P.thumbnailTypes,
                a = P.avatarHeadshotSize;
              d.chatLibrary.layoutLibrary = {
                thumbnailTypes: e,
                avatarHeadshotSize: a,
              };
            }),
            (d.parseChatSettingsResponsesForChatEnabled = function (e) {
              e = e.metadataResponse;
              (d.chatLibrary.isWebChatSettingsMigrationEnabled =
                e.isWebChatSettingsMigrationEnabled),
                (d.chatLibrary.isWebChatRegionalityEnabled =
                  e.isWebChatRegionalityEnabled),
                d.chatLibrary.isWebChatSettingsMigrationEnabled &&
                  (d.chatLibrary.chatLayout.isGroupChatEnabled =
                    "enabled" === e.isGroupChatEnabledByPrivacySetting),
                (d.chatLibrary.chatLayout.isChatEnabledByPrivacySetting =
                  "enabled" === e.isChatEnabledByPrivacySetting),
                d.chatLibrary.isWebChatRegionalityEnabled &&
                  (d.chatLibrary.chatLayout.isChatEnabledByRegion =
                    "enabled" === e.isChatEnabledByGlobalRules),
                !1 !== e.isChatVisible &&
                  ie().element("#chat-container").show(),
                (d.chatLibrary.chatLayout.isChatEnabled = e.isChatEnabled),
                (d.chatLibrary.chatLayout.languageForPrivacySettingUnavailable =
                  e.languageForPrivacySettingUnavailable);
            }),
            (d.initializeChatLibrary = function (e) {
              var a = e.metadataResponse,
                t = e.chatUiPoliciesResponse,
                i = ae.EnvironmentUrls.domain;
              d.parseChatSettingsResponsesForChatEnabled(e),
                (d.chatLibrary.chatLayout.languageForPrivacySettingUnavailable =
                  a.languageForPrivacySettingUnavailable),
                (d.chatLibrary.chatLayout.playTogetherGameCardsEnabled =
                  a.isPlayTogetherForGameCardsEnabled),
                (d.chatLibrary.cookieOption = {
                  domain: i,
                  path: "/",
                  expires: null,
                }),
                (d.chatLibrary.currentTabTitle = s.document.title),
                (d.chatLibrary.dialogLocalStorageName =
                  m.dialogLocalStorageNamePrefix + i),
                (d.chatLibrary.domain = i),
                (d.chatLibrary.isUserUnder13 = ae.CurrentUser.isUnder13),
                (d.chatLibrary.maxConversationTitleLengthInput =
                  a.maxConversationTitleLength),
                (d.chatLibrary.partyChromeDisplayTimeStampInterval =
                  a.partyChromeDisplayTimeStampInterval),
                (d.chatLibrary.quotaOfGroupChatMembers =
                  a.numberOfMembersForPartyChrome - 1),
                (d.chatLibrary.screenHeight = window.screen
                  ? window.screen.height
                  : 0),
                (d.chatLibrary.signalRDisconnectionResponseInMilliseconds =
                  a.signalRDisconnectionResponseInMilliseconds),
                (d.chatLibrary.typingInChatAsSenderThrottleMs =
                  a.typingInChatFromSenderThrottleMs),
                (d.chatLibrary.typingInChatForReceiverExpirationMs =
                  a.typingInChatForReceiverExpirationMs),
                (d.chatLibrary.userId = parseInt(ae.CurrentUser.userId)),
                (d.chatLibrary.usePaginatedFriends =
                  d.chatLibrary.userId % 100 <= t.usePaginatedFriends),
                (d.chatLibrary.useChatTimeouts =
                  d.chatLibrary.userId % 100 <=
                  (null !== (i = t.useChatTimeouts) && void 0 !== i ? i : 0)),
                (d.chatLibrary.chatTimeoutsLearnMoreUrl =
                  null !== (i = t.chatTimeoutsLearnMoreUrl) && void 0 !== i
                    ? i
                    : "#"),
                (d.chatLibrary.isWebChatTcEnabled = t.isWebChatTcEnabled),
                (d.chatLibrary.useOneToOneOsaContextCards =
                  d.chatLibrary.userId % 100 <=
                  (null !== (t = t.useOneToOneOsaContextCards) && void 0 !== t
                    ? t
                    : 0)),
                (d.chatLibrary.username = ae.CurrentUser.name);
              var t = y.eventActions.Chat;
              (t += ": ".concat(y.getUserAgent())),
                (d.chatLibrary.googleAnalyticsEvent = {
                  category: y.eventCategories.JSErrors,
                  action: t,
                }),
                (d.chatLibrary.eventStreamParams = se({}, g.eventStreamParams));
              t =
                null !== (t = a.webChatEventSampleRate) && void 0 !== t ? t : 0;
              (d.chatLibrary.shouldSendEvents = 100 * Math.random() <= t),
                (d.chatLibrary.relativeValueToRecordUiPerformance =
                  a.relativeValueToRecordUiPerformance),
                (d.chatLibrary.isUsingCacheToLoadFriendsInfoEnabled =
                  a.isUsingCacheToLoadFriendsInfoEnabled),
                (d.chatLibrary.cachedDataFromLocalStorageExpirationMS =
                  a.cachedDataFromLocalStorageExpirationMS),
                (d.chatLibrary.shouldRespectConversationHasUnreadMessageToMarkAsRead =
                  a.shouldRespectConversationHasUnreadMessageToMarkAsRead),
                d.initializeLayoutLibrary();
            }),
            (d.getIsChatEnabled = function () {
              return g.getIsChatEnabled(d.chatLibrary);
            }),
            (d.getIsGroupChatEnabled = function () {
              return g.getIsGroupChatEnabled(d.chatLibrary);
            }),
            (d.getChatDisabledReason = function () {
              var e;
              return null ===
                (e = g.getChatDisabledReasonsByPriority(d.chatLibrary)) ||
                void 0 === e
                ? void 0
                : e[0];
            }),
            (d.maybeCloseNewGroupDialog = function () {
              var e =
                  null === (a = d.newGroup) || void 0 === a
                    ? void 0
                    : a.layoutId,
                a =
                  null === (a = d.chatLibrary) || void 0 === a
                    ? void 0
                    : a.dialogDict;
              !d.getIsGroupChatEnabled() &&
                e &&
                null != a &&
                a[e] &&
                d.closeDialog(e);
            }),
            (d.initializeChatViewModel = function () {
              d.chatViewModel = se({}, m.chatViewModel);
            }),
            (d.bootstrapAllInitialization = function (e) {
              var a = e.metadataResponse;
              d.initializeChatViewModel(),
                d.initializeChatLibrary(e),
                d.initializeServices(a),
                d.initializeRealTimeSubscriptionsForUserSetttingsChanged(),
                d.initializePresetData(),
                d.initializeChatBar(),
                d.getIsChatEnabled() &&
                  ((d.chatLibrary.chatLayout.pageDataLoading = !0),
                  d.initializeChat(),
                  d.initializeRealTimeSubscriptionsForChat()),
                d.chatLibrary.chatLayout.pageInitializing &&
                  (d.chatLibrary.chatLayout.pageInitializing = !1),
                d.sendWebChatRenderedEvent();
            });
          function ee(e) {
            var a;
            return "fulfilled" === e.status &&
              null !== (a = e.value) &&
              void 0 !== a
              ? a
              : {};
          }
          (d.fetchAllWebChatSettings = function (e) {
            e = [c.getMetaData(e), w.getChatUiPolicies()];
            return Promise.allSettled(e).then(function (e) {
              var a = oe(e, 2),
                e = a[0],
                a = a[1];
              return { metadataResponse: ee(e), chatUiPoliciesResponse: ee(a) };
            });
          }),
            (d.initialize = function () {
              d.setup(),
                d.initializeEvents(),
                (d.chatLibrary.chatLayout.pageInitializing = !0);
              var e = [
                d
                  .fetchAllWebChatSettings()
                  .then(function (e) {
                    d.bootstrapAllInitialization(e);
                  })
                  .catch(function (e) {
                    u.debug(e);
                  }),
                S.getContactsMetaData()
                  .then(function () {})
                  .catch(function (e) {
                    u.debug(e);
                  }),
              ];
              return Promise.all(e);
            }),
            d.initialize();
        }
        (o.$inject = [
          "$scope",
          "$window",
          "$document",
          "$timeout",
          "$interval",
          "$log",
          "chatService",
          "messageService",
          "chatUtility",
          "chatClientStorageUtilityService",
          "localStorageService",
          "performanceService",
          "messageUtility",
          "googleAnalyticsEventsService",
          "urlService",
          "dialogAttributes",
          "libraryInitialization",
          "gameService",
          "playTogetherService",
          "pinGameService",
          "presenceLayout",
          "resources",
          "storageService",
          "usersService",
          "conversationsUtility",
          "contactsService",
          "thumbnailConstants",
          "usersPresenceService",
          "userProfilesService",
          "analyticsService",
          "eventNames",
          "diagActionList",
          "guacService",
          "languageResource",
          "countdownTimerService",
          "featureInterventionAnalytics",
          "systemFeedbackService",
        ]),
          t.A.controller("chatController", o),
          (a.default = o);
      },
      3835: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          o = t.n(i),
          t = t(1089);
        function r(i, e, a, t, r) {
          var n;
          i.chatLibrary.isWebChatTcEnabled &&
            ((i.shouldShowInsightOfType = function (e) {
              var a, t;
              return o().isDefined(
                null ===
                  (a = i.chatLibrary.friendsDict[i.getOneToOneFriendId()]) ||
                  void 0 === a ||
                  null === (t = a.profileInsights) ||
                  void 0 === t
                  ? void 0
                  : t[e],
              );
            }),
            (i.getInsightTextOfType = function (e) {
              var a;
              return "numMutualFriends" !== e
                ? ""
                : "".concat(
                    null ===
                      (e =
                        i.chatLibrary.friendsDict[i.getOneToOneFriendId()]) ||
                      void 0 === e ||
                      null === (a = e.profileInsights) ||
                      void 0 === a
                      ? void 0
                      : a.numMutualFriends,
                    " mutual connections",
                  );
            }),
            (n = function (e) {
              r.getProfileInsights(e).then(function (e) {
                e = (function (e) {
                  if (e && Array.isArray(e)) {
                    var a = {};
                    return (
                      e.forEach(function (e) {
                        e.mutualFriendInsight &&
                          (a.numMutualFriends = Object.keys(
                            null !==
                              (e = e.mutualFriendInsight.mutualFriends) &&
                              void 0 !== e
                              ? e
                              : {},
                          ).length);
                      }),
                      a
                    );
                  }
                })(e);
                i.chatLibrary.friendsDict[
                  i.getOneToOneFriendId()
                ].profileInsights = e;
              });
            }),
            i.$watchGroup(
              ["dialogLayout.currentDialogScreen", "getOneToOneFriendId()"],
              function () {
                var e, a;
                (a = i.getOneToOneFriendId()),
                  "contactCard" ===
                    (null === (e = i.dialogLayout) || void 0 === e
                      ? void 0
                      : e.currentDialogScreen) &&
                    a &&
                    n(a);
              },
            ));
        }
        (r.$inject = [
          "$scope",
          "$log",
          "chatService",
          "chatUtility",
          "profileInsightsService",
        ]),
          t.A.controller("contactCardController", r),
          (a.default = r);
      },
      6443: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(r, t, n, o) {
          var e = r.dialogData.initiator,
            a = r.chatLibrary.userId;
          (r.canConversationRemoveMember = function () {
            return (
              r.dialogData.dialogType !== r.dialogType.CHAT &&
              e &&
              e.id === a &&
              !r.dialogData.isUserPending
            );
          }),
            (r.shouldShowAddUser = function () {
              return (
                !r.dialogData.isUserPending &&
                o.getIsGroupChatEnabled(r.chatLibrary)
              );
            }),
            (r.shouldShowPendingLabel = function (e) {
              var a, t;
              return null === (a = r.dialogData.participantsMetadata) ||
                void 0 === a ||
                null === (t = a[e]) ||
                void 0 === t
                ? void 0
                : t.is_pending;
            }),
            (r.maybeFetchParticipantMetadata = function () {
              var e,
                a,
                i = r.dialogData.id;
              i &&
                r.dialogData.source === o.conversationSource.CHANNELS &&
                null !== (e = r.dialogLayout) &&
                void 0 !== e &&
                null !== (a = e.details) &&
                void 0 !== a &&
                a.isEnabled &&
                n
                  .getConversationsParticipantsMetadata([i])
                  .then(function (e) {
                    var a, t;
                    r.dialogData.participantsMetadata =
                      null == e ||
                      null === (a = e.conversation_participants_metadata) ||
                      void 0 === a ||
                      null === (t = a[i]) ||
                      void 0 === t
                        ? void 0
                        : t.participants_metadata;
                  })
                  .catch(function (e) {
                    t.error(e);
                  });
            }),
            (r.init = function () {
              r.maybeFetchParticipantMetadata();
            }),
            r.init(),
            r.$watch(
              function () {
                var e, a;
                return null === (e = r.dialogLayout) ||
                  void 0 === e ||
                  null === (a = e.details) ||
                  void 0 === a
                  ? void 0
                  : a.isEnabled;
              },
              function () {
                r.maybeFetchParticipantMetadata();
              },
            );
        }
        (i.$inject = ["$scope", "$log", "chatService", "chatUtility"]),
          t.A.controller("detailsController", i),
          (a.default = i);
      },
      3617: function (e, a, t) {
        "use strict";
        t.r(a);
        var L = t(7577),
          i = t(127),
          C = t.n(i),
          t = t(1089);
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function I(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function r(c, l, i, d, t, r, n, u, a, o, g, p, s, h, y, e) {
          (c.removeFromConversation = function (a, t) {
            i.removeFromConversation(c.chatLibrary.userId, a).then(
              function (e) {
                e &&
                  e.status === d.resultType.SUCCESS &&
                  c.chatLibrary.chatLayoutIds &&
                  -1 < c.chatLibrary.chatLayoutIds.indexOf(t) &&
                  ((c.chatLibrary.conversationsDict[a].remove = !0),
                  c.closeDialog({ layoutId: t }));
              },
            );
          }),
            (c.keystrokeCollectionEnabled = !1),
            (c.isKeystrokeCollectionEnabled = function () {
              e.getAppPolicies().then(function (e) {
                !0 === (null == e ? void 0 : e.EnableKeystrokeCollection) &&
                  (c.keystrokeCollectionEnabled = !0);
              });
            }),
            (c.abuseReportRevampEnabled = !1),
            (c.isAbuseReportRevampEnabled = function () {
              e.getAbuseReportRevampPolicies().then(function (e) {
                !0 === (null == e ? void 0 : e.EnableChat) &&
                  (c.abuseReportRevampEnabled = !0);
              });
            }),
            (c.sendPerformanceData = function (e) {
              Math.random() <
                c.chatLibrary.relativeValueToRecordUiPerformance &&
                ((e = e.startSendingTime),
                (e = new Date().getTime() - e),
                i.sendPerformanceData(
                  a.performanceMeasurements.messageSend,
                  e,
                ));
            });
          function m(o, s) {
            i.sendMessage(c.dialogData.id, o.rawContent).then(
              function (e) {
                var a;
                c.sendConversationMessageSentEvent(e, s),
                  !e ||
                    ((a = e.data) &&
                      ((o.sendingMessage = !1),
                      (o.canResend = !1),
                      c.sendPerformanceData(o),
                      a.status !== d.resultType.SUCCESS
                        ? ((o.sendMessageHasError = !0),
                          (o.error = d.errorMessages.default),
                          a.status === d.resultType.MODERATED
                            ? ((o.error =
                                d.errorMessages.messageContentModerated),
                              (o.content = d.hashOutContent(o.content)),
                              d.sanitizeMessage(o),
                              o.hasLinkCard &&
                                o.linkCardMessages.forEach(function (e) {
                                  e.isCard ||
                                    (e.content = d.hashOutContent(e.content));
                                }))
                            : (o.canResend = !0))
                        : ((e = a.content),
                          (o.sendMessageHasError = !1),
                          C().isUndefined(c.dialogData.messagesDict) &&
                            (c.dialogData.messagesDict = {}),
                          (o.id = a.id),
                          (o.created_at = a.created_at),
                          t.buildTimeStamp(o, c.dialogData),
                          (o.resetClusterMessage = !0),
                          d.sanitizeMessage(a),
                          (o.content = a.content),
                          (o.pieces = a.pieces),
                          (o.type = g.messageTypes.user),
                          (o.moderation_type = a.moderation_type),
                          t.setClusterMaster(c.dialogData, o),
                          o.hasLinkCard &&
                            o.rawContent !== e &&
                            (a.hasLinkCard
                              ? (u.fetchDataForLinkCard([a], c.chatLibrary),
                                (o.linkCardMessages = a.linkCardMessages))
                              : (o.hasLinkCard = !1)),
                          (c.dialogData.messagesDict[a.id] = o)),
                      (c.dialogLayout.scrollToBottom = !0)));
              },
              function (e) {
                l.debug(" ------ sendMessage error -------"),
                  (o.sendingMessage = !1),
                  (o.sendMessageHasError = !0),
                  (o.canResend = !0);
                var a,
                  t,
                  i,
                  r,
                  n = e.errors;
                n &&
                  ((a = d.sendMessageErrorCode.textTooLong),
                  (t = (r = d.errorMessages).textTooLong),
                  (i = r.sendingMessagesTooQuickly),
                  (e = r.sendMessageConflict),
                  n.length &&
                    ((n = (r = n[0] || {}).code),
                    r.message === a
                      ? (o.error = t)
                      : n === p.tooManyAttempts
                        ? (o.error = i)
                        : n === p.conflict &&
                          ((o.canResend = !1),
                          (o.error = e),
                          c.sendConversationMessageSentEvent(
                            { data: { status: "Conflict" } },
                            s,
                          )))),
                  (c.dialogLayout.scrollToBottom = !0);
              },
            );
          }
          function v(e) {
            var a = [],
              t = [],
              i = [];
            return (
              e.forEach(function (e) {
                a.push(e.key), t.push(e.eventType), i.push(e.timestamp);
              }),
              { keyPressedData: a, eventTypeData: t, timestampData: i }
            );
          }
          (c.toggleDetails = function () {
            (c.dialogLayout.details.isEnabled =
              !c.dialogLayout.details.isEnabled),
              c.saveIntoDialogsLayout(),
              c.dialogLayout.details.isEnabled ||
                (c.dialogLayout.scrollToBottom = !0);
          }),
            (c.dismissContactCard = function () {
              c.dialogLayout.shouldShowContactCard = !1;
            }),
            (c.toggleConversationEditor = function () {
              (c.dialogLayout.details.isConversationTitleEditorEnabled =
                !c.dialogLayout.details.isConversationTitleEditorEnabled),
                (c.dialogLayout.focusMeEnabled =
                  c.dialogLayout.details.isConversationTitleEditorEnabled),
                c.saveIntoDialogsLayout();
            }),
            (c.toggleAddFriends = function () {
              (c.dialogLayout.details.isAddFriendsEnabled =
                !c.dialogLayout.details.isAddFriendsEnabled),
                c.dialogLayout.details.isAddFriendsEnabled
                  ? c.addFriends()
                  : (c.dialogData.addMoreFriends = !1),
                c.getLimitLinkNameForMemberList(),
                c.saveIntoDialogsLayout();
            }),
            (c.getLimitLinkNameForMemberList = function (e) {
              var a = c.dialogData.userIds.length;
              c.dialogData.selectedUserIds &&
                (a += c.dialogData.selectedUserIds.length),
                e && (a -= e),
                (c.dialogLayout.memberDisplay.linkName = c.dialogLayout
                  .memberDisplay.isAll
                  ? c.dialogLayout.memberDisplay.seeLessLink
                  : ""
                      .concat(c.dialogLayout.memberDisplay.seeMoreLink, " (")
                      .concat(
                        a - c.dialogLayout.memberDisplay.defaultLimit,
                        ")",
                      ));
            }),
            (c.toggleMemberList = function () {
              (c.dialogLayout.memberDisplay.isAll =
                !c.dialogLayout.memberDisplay.isAll),
                (c.dialogLayout.memberDisplay.limitNumber = c.dialogLayout
                  .memberDisplay.isAll
                  ? c.dialogData.userIds.length
                  : c.dialogLayout.memberDisplay.defaultLimit),
                c.getLimitLinkNameForMemberList();
            }),
            (c.toggleFriendsMenu = function (e, a) {
              a && c.dialogLayout.details.friendIdForMenuOn === e
                ? ((c.dialogLayout.details.friendMenuAction = {}),
                  (c.dialogLayout.details.friendIdForMenuOn = null))
                : e &&
                  !a &&
                  ((c.dialogLayout.details.friendMenuAction[e] =
                    !c.dialogLayout.details.friendMenuAction[e]),
                  (c.dialogLayout.details.friendIdForMenuOn = e));
            }),
            (c.updatePopoverParams = function () {
              var e = c.dialogData,
                a = e.id,
                t = e.playTogetherIds,
                i = c.dialogLayout.togglePopoverParams,
                r = i.dialogSelectorPrefix,
                n = i.popoverTriggerSelectorPrefix,
                e = i.dialogTriggerClassPrefix,
                i = c.dialogLayout.togglePopoverParams,
                t = {
                  dialogSelect: r + a,
                  triggerSelector: n + a,
                  dialogTriggerClassSelector: e + a,
                  isOpen: !!t && 0 < t.length,
                  isFirstTimeOpen: !0,
                };
              Object.assign(i, t);
            }),
            (c.dialogParams = I({}, d.dialogParams)),
            (c.userPresenceTypes = d.userPresenceTypes),
            (c.dialogData.messageForSend = ""),
            (c.dialogLayout.scrollbarElm = d.getScrollBarSelector(
              c.dialogData,
              d.scrollBarType.MESSAGE,
            )),
            (c.dialogLayout.listenToScrollInitialized = !1),
            (c.friendsScrollbarElm = d.getScrollBarSelector(
              c.dialogData,
              d.scrollBarType.FRIENDSELECTION,
            )),
            c.updatePopoverParams(),
            (c.updateDialog = function () {
              return (
                l.debug("---- updateDialog callback ---- Scrollbars updated"),
                c.dialogLayout.IsdialogContainerVisible ||
                  (C()
                    .element(c.dialogLayout.scrollbarElm)
                    .find(".mCustomScrollBox")
                    .addClass("dialog-visible"),
                  (c.dialogLayout.IsdialogContainerVisible = !0)),
                !1
              );
            }),
            (c.keystrokeData = []),
            (c.buildNewMessage = function (e) {
              return {
                read: !0,
                content: e,
                rawContent: e,
                created_at: new Date().toISOString(),
                is_previewable: !0,
                sender_user_id: c.chatLibrary.userId,
                sendingMessage: !0,
                sendMessageHasError: !1,
                startSendingTime: new Date().getTime(),
                type: "user",
              };
            }),
            (c.sendMessage = function () {
              var e, a;
              0 < c.dialogData.messageForSend.length &&
                ((e = c.buildNewMessage(c.dialogData.messageForSend)),
                d.sanitizeMessage(e),
                u.fetchDataForLinkCard([e], c.chatLibrary),
                (c.dialogData.messageForSend = ""),
                C().isUndefined(c.dialogData.chatMessages) &&
                  (c.dialogData.chatMessages = []),
                t.setClusterMaster(c.dialogData, e),
                t.updatePreviewMessage(c.dialogData, [e]),
                (c.dialogLayout.scrollToBottom = !0),
                c.dialogData.dialogType === d.dialogType.FRIEND
                  ? ((a = e),
                    c
                      .openConversationFromFriendId()
                      .then(function (e) {
                        e = e && e.id;
                        if (!e)
                          return (
                            (a.canResend = !1),
                            (a.sendMessageHasError = !0),
                            void (a.error = d.errorMessages.default)
                          );
                        i.sendMessage(e, a.rawContent).then(function (e) {
                          c.sendConversationMessageSentEvent(e, !1);
                        });
                      })
                      .catch(function () {
                        (a.canResend = !1),
                          (a.sendMessageHasError = !0),
                          (a.error = d.errorMessages.default);
                      }))
                  : m(e));
            }),
            (c.resendMessage = function (e) {
              m(e, !0);
            }),
            (c.keyPressEnter = function () {
              c.sendMessage(),
                c.dialogLayout.typing.isTypingAsSender &&
                  ((c.dialogLayout.typing.lastTimeTypingAsSender = null),
                  (c.dialogLayout.typing.isTypingAsSender = !1));
            }),
            (c.typing = function (e, a, t) {
              c.dialogData.dialogType !== d.dialogType.FRIEND &&
                a &&
                (e.which !== n.enter &&
                  ((e = t || new Date().getTime()),
                  (!(t = c.dialogLayout.typing).lastTimeTypingAsSender ||
                    e - t.lastTimeTypingAsSender >
                      c.chatLibrary.typingInChatAsSenderThrottleMs) &&
                    ((t.lastTimeTypingAsSender = e),
                    (t.isTypingAsSender = !0),
                    i.updateUserTypingStatus(c.dialogData.id, !0))),
                c.toggleDialogFocusStatus(!0));
            }),
            (c.abuseReport = function (e, a) {
              if (
                ((c.dialogLayout.isAbuseReportConfirmationOn = !0),
                e && (c.dialogLayout.userIdForAbuseReport = e),
                a && c.dialogLayout.userIdForAbuseReport)
              ) {
                if (c.abuseReportRevampEnabled) {
                  var t = new URLSearchParams({
                      targetId: c.dialogData.id,
                      submitterId: L.CurrentUser.userId,
                      abuseVector: "chat",
                    }),
                    t = "/report-abuse/?".concat(t.toString());
                  return void (window.location.href = t);
                }
                (t = o("formatString")(d.chatLayout.abuseReportUrl, {
                  userId: c.dialogLayout.userIdForAbuseReport,
                  location: escape(window.location),
                  conversationId: c.dialogData.id,
                })),
                  (t = L.Endpoints ? L.Endpoints.getAbsoluteUrl(t) : t);
                L.AbuseReportDispatcher
                  ? L.AbuseReportDispatcher.triggerUrlAction(t)
                  : (window.location.href = t),
                  (c.dialogLayout.userIdForAbuseReport = null),
                  (c.dialogLayout.isAbuseReportConfirmationOn = !1);
              }
              c.saveIntoDialogsLayout();
            }),
            (c.keyStroke = function (e, a) {
              var t, i, r, n;
              c.keystrokeCollectionEnabled &&
                0 != d.dialogParams.keystrokeSampleRate &&
                ((t = Math.round(1 / d.dialogParams.keystrokeSampleRate)),
                parseInt(a) % t == 0 &&
                  ((a = new Date().getTime()),
                  ("keyup" != e.type && "keydown" != e.type) ||
                    ((t = "keyup" == e.type ? 1 : 0),
                    (a = { key: (e = e.key), eventType: t, timestamp: a }),
                    c.keystrokeData.push(a),
                    "Enter" == e && 1 == t
                      ? ((n = (r = v(c.keystrokeData)).keyPressedData),
                        (i = r.eventTypeData),
                        (r = r.timestampData),
                        L.EventStream.SendEventWithTarget(
                          "appChatKeyStrokes",
                          "enterPressed",
                          {
                            keyPressedData: JSON.stringify(n),
                            eventTypeData: JSON.stringify(i),
                            timestampData: JSON.stringify(r),
                          },
                          L.EventStream.TargetTypes.WWW,
                        ),
                        (c.keystrokeData = []))
                      : c.keystrokeData.length >=
                          d.dialogParams.maxKeystrokeDataLength &&
                        ((i = (n = v(c.keystrokeData)).keyPressedData),
                        (r = n.eventTypeData),
                        (n = n.timestampData),
                        L.EventStream.SendEventWithTarget(
                          "appChatKeyStrokes",
                          "maxLengthReached",
                          {
                            keyPressedData: JSON.stringify(i),
                            eventTypeData: JSON.stringify(r),
                            timestampData: JSON.stringify(n),
                          },
                          L.EventStream.TargetTypes.WWW,
                        ),
                        (c.keystrokeData = [])))));
            }),
            (c.leaveGroupChat = function (e) {
              e
                ? ((c.chatLibrary.conversationsDict[c.dialogData.id].remove =
                    !0),
                  c.removeFromConversation(
                    c.dialogData.id,
                    c.dialogData.layoutId,
                  ),
                  c.resetConfirmDialog())
                : ((c.dialogLayout.confirmDialog.isOpen = !0),
                  (e = r.negativeAction.leaveChatGroup),
                  (c.dialogLayout.confirmDialog.title = e.title),
                  (c.dialogLayout.confirmDialog.headerTitle = e.headerTitle),
                  (c.dialogLayout.confirmDialog.btnName = e.btnName),
                  (c.dialogLayout.confirmDialog.cancelBtnName =
                    e.cancelBtnName),
                  (c.dialogLayout.confirmDialog.type = e.type));
            }),
            (c.openLearnMorePage = function () {
              window.open(d.linksLibrary.trustedCommsLearnMoreLink, "_blank");
            }),
            (c.addFriends = function () {
              (c.dialogData.addMoreFriends = !0),
                0 < c.chatLibrary.friendIds.length && c.updateFriends(),
                (c.dialogData.scrollBarType = d.scrollBarType.FRIENDSELECTION);
            }),
            (c.viewParticipants = function () {
              c.dialogLayout.lookUpMembers = !c.dialogLayout.lookUpMembers;
            }),
            (c.toggleGroupNameEditor = function () {
              (c.dialogLayout.renameEditor.isEnabled =
                !c.dialogLayout.renameEditor.isEnabled),
                (c.dialogLayout.renameEditor.hasFocus =
                  !c.dialogLayout.renameEditor.hasFocus),
                c.updateDialogStyle(),
                (c.dialogLayout.focusMeEnabled =
                  !c.dialogLayout.renameEditor.isEnabled);
            }),
            (c.renameTitle = function () {
              var a = c.dialogData.title;
              i.renameGroupConversation(
                c.dialogData.id,
                c.dialogData.name,
              ).then(function (e) {
                if (e) {
                  switch (e.status) {
                    case d.resultType.MODERATED:
                      t.buildSystemMessage(
                        d.notificationType.conversationTitleModerated,
                        c.dialogData,
                        !0,
                      ),
                        d.updateConversationTitle(c.dialogData, a);
                      break;
                    case d.resultType.SUCCESS:
                      d.updateConversationTitle(c.dialogData, e.name);
                  }
                  c.toggleConversationEditor();
                }
              });
            }),
            (c.removeMember = function (e, a) {
              a
                ? (c.resetConfirmDialog(),
                  c.getLimitLinkNameForMemberList(1),
                  i
                    .removeFromConversation(e, c.dialogData.id)
                    .then(function () {
                      data &&
                        data.status === d.resultType.SUCCESS &&
                        c.isOverLoaded();
                    }))
                : ((c.dialogLayout.confirmDialog.isOpen = !0),
                  (a = r.negativeAction.removeUser),
                  (c.dialogLayout.confirmDialog.title = a.title),
                  (c.dialogLayout.confirmDialog.headerTitle = a.headerTitle),
                  (c.dialogLayout.confirmDialog.btnName = a.btnName),
                  (c.dialogLayout.confirmDialog.cancelBtnName =
                    a.cancelBtnName),
                  (c.dialogLayout.confirmDialog.type = a.type),
                  (c.dialogLayout.confirmDialog.params = { userId: e }));
            }),
            (c.resetConfirmDialog = function () {
              Object.assign(c.dialogLayout.confirmDialog, {
                isOpen: !1,
                title: "",
                btnName: "",
                type: "",
                params: {},
              });
            }),
            (c.confirmCallBack = function () {
              var e = c.dialogLayout.confirmDialog;
              switch (e.type) {
                case r.negativeAction.removeUser.type:
                  c.removeMember(e.params.userId, !0);
                  break;
                case r.negativeAction.leaveChatGroup.type:
                  c.leaveGroupChat(!0);
              }
            }),
            (c.updateDialogHeader = function (e) {
              c.dialogLayout.collapsed && (c.dialogLayout.hoverOnCollapsed = e);
            }),
            (c.getOneToOneFriendId = function () {
              return c.dialogData.type !==
                d.conversationType.oneToOneConversation
                ? 0
                : c.dialogData.userIds[0];
            }),
            (c.sendConversationMessageSentEvent = function (e, a) {
              try {
                var t;
                if (!c.chatLibrary.shouldSendEvents) return;
                i = e
                  ? e.data
                    ? e.data.status || "NoMessageStatus"
                    : "NoResponseBody"
                  : "NoResponse";
                var i = {
                  messageId:
                    null == e || null === (t = e.data) || void 0 === t
                      ? void 0
                      : t.id,
                  messageSentResult: i,
                  recipientIds: JSON.stringify(
                    (null === (i = c.dialogData) || void 0 === i
                      ? void 0
                      : i.candidatePlayerIds) || [],
                  ),
                  isRetry: a || !1,
                };
                c.sendConversationEvent(
                  h.conversationMessageSent,
                  y.ConversationMessageSentWeb,
                  i,
                );
              } catch (e) {
                l.debug("sendConversationMessageSentEvent failed: ".concat(e));
              }
            }),
            (c.sendConversationEvent = function (a, e, t) {
              var i = s.getConversationIdForAnalytics(c.dialogData);
              try {
                if (!c.chatLibrary.shouldSendEvents) return;
                s.incrementCounter(e);
                var r = I({ localTimestamp: Date.now(), conversationId: i }, t);
                s.sendEvent(a, r);
              } catch (e) {
                l.debug(
                  "sendConversationEvent for Event "
                    .concat(a, " and Conversation ")
                    .concat(i, " failed: ")
                    .concat(e),
                );
              }
            }),
            (c.sendWebChatConversationRenderedEvent = function () {
              var a = s.getConversationIdForAnalytics(c.dialogData);
              try {
                if (!c.chatLibrary.shouldSendEvents) return;
                s.incrementCounter(y.WebChatConversationRenderedWeb);
                var e = {
                  localTimestamp: Date.now(),
                  conversationId: a,
                  isDialogOpen: !(
                    null !== (e = c.dialogLayout) &&
                    void 0 !== e &&
                    e.collapsed
                  ),
                  conversationSource:
                    null === (e = c.dialogData) || void 0 === e
                      ? void 0
                      : e.source,
                  moderationType:
                    null === (e = c.dialogData) || void 0 === e
                      ? void 0
                      : e.moderationType,
                  userPendingStatus:
                    null === (e = c.dialogData) || void 0 === e
                      ? void 0
                      : e.userPendingStatus,
                };
                s.sendEvent(h.webChatConversationRendered, e);
              } catch (e) {
                l.debug(
                  "sendWebChatConversationRenderedEvent for Conversation "
                    .concat(a, " failed: ")
                    .concat(e),
                );
              }
            });
          var f, b;
          (c.updateShouldShowOsaContextCard = function () {
            c.dialogLayout.shouldShowOsaContextCard =
              !0 === c.chatLibrary.useOneToOneOsaContextCards &&
              (c.dialogData.source === d.conversationSource.FRIENDS ||
                !c.dialogParams.loadMoreMessages ||
                (c.dialogData.chatMessages &&
                  0 < c.dialogData.chatMessages.length &&
                  c.dialogData.chatMessages.length <
                    c.dialogParams.pageSizeOfGetMessages)) &&
              (c.dialogData.osaAcknowledgementStatus ===
                r.osaAcknowledgementStatus.UNACKNOWLEDGED ||
                c.dialogData.osaAcknowledgementStatus ===
                  r.osaAcknowledgementStatus.ACKNOWLEDGED);
          }),
            (c.dialogLayout.currentDialogScreen = "default"),
            (c.dialogLayout.shouldShowContactCard = !1),
            c.$watchGroup(
              [
                "dialogLayout.isAbuseReportConfirmationOn",
                "dialogLayout.confirmDialog.isOpen",
                "dialogLayout.details.isEnabled",
                "dialogData.isUserPending",
                "dialogData.type",
                "dialogLayout.shouldShowContactCard",
              ],
              function () {
                !0 === c.dialogLayout.isAbuseReportConfirmationOn
                  ? (c.dialogLayout.currentDialogScreen =
                      "abuseReportConfirmation")
                  : !0 === c.dialogLayout.confirmDialog.isOpen &&
                      c.dialogData.type ===
                        d.conversationType.multiUserConversation
                    ? (c.dialogLayout.currentDialogScreen = "confirmDialog")
                    : !0 === c.dialogLayout.details.isEnabled
                      ? (c.dialogLayout.currentDialogScreen = "details")
                      : !0 === c.dialogData.isUserPending &&
                          c.dialogData.type ===
                            d.conversationType.multiUserConversation
                        ? (c.dialogLayout.currentDialogScreen = "pending")
                        : c.chatLibrary.isWebChatTcEnabled &&
                            !0 === c.dialogLayout.shouldShowContactCard &&
                            c.dialogData.type ===
                              d.conversationType.oneToOneConversation
                          ? (c.dialogLayout.currentDialogScreen = "contactCard")
                          : (c.dialogLayout.currentDialogScreen = "default");
              },
            ),
            c.$watchGroup(
              [
                "chatLibrary.useOneToOneOsaContextCards",
                "dialogData.osaAcknowledgementStatus",
                "dialogData.chatMessages",
                "dialogParams.loadMoreMessages",
              ],
              function () {
                c.updateShouldShowOsaContextCard();
              },
            ),
            c.dialogData.dialogType === d.dialogType.FRIEND ||
              c.dialogData.isUserPending ||
              ((b = (f = d.shouldScrollFromTop(c.dialogData, c.chatLibrary))
                ? i.getAllMessages(c.dialogData.id)
                : i.getMessages(
                    c.dialogData.id,
                    null,
                    c.dialogParams.pageSizeOfGetMessages,
                  )),
              C().isUndefined(c.dialogData.messagesDict) &&
                (c.dialogLayout.isChatLoading = !0),
              b.then(function (e) {
                var a = e.messages;
                (c.dialogLayout.isChatLoading = !1),
                  a
                    ? ((c.dialogParams.getMessagesNextCursor = e.next_cursor),
                      (c.dialogData.chatMessages = []),
                      (c.dialogData.messagesDict = {}),
                      t.processMessages(
                        c.chatLibrary,
                        c.dialogData,
                        a,
                        c.chatLibrary.friendsDict,
                      ),
                      u.fetchDataForLinkCard(a, c.chatLibrary),
                      (c.dialogData.scrollBarType = d.scrollBarType.MESSAGE),
                      e.next_cursor || (c.dialogParams.loadMoreMessages = !1),
                      f && (c.updateDialog(), c.$apply()))
                    : ((c.dialogData.scrollBarType = d.scrollBarType.MESSAGE),
                      c.updateDialog());
              })),
            c.$on("elastic:resize", function (e, a, t, i) {
              l.debug(
                "---- oldHeight -----"
                  .concat(t, "---- newHeight -----")
                  .concat(i),
              ),
                t !== i &&
                  (e.preventDefault(),
                  e.stopPropagation(),
                  d.setResizeInputLayout(
                    c.chatLibrary,
                    i,
                    c.dialogData,
                    c.dialogLayout,
                  ));
            }),
            c.dialogData.isConversationUnavailableWithUser &&
              d.setResizeInputLayout(
                c.chatLibrary,
                r.dialogLayout.maxHeightOfDisabledInput,
                c.dialogData,
                c.dialogLayout,
              ),
            (c.init = function () {
              c.getLimitLinkNameForMemberList(),
                c.sendWebChatConversationRenderedEvent(),
                c.isKeystrokeCollectionEnabled(),
                c.isAbuseReportRevampEnabled();
            }),
            c.init();
        }
        (r.$inject = [
          "$scope",
          "$log",
          "chatService",
          "chatUtility",
          "messageService",
          "dialogAttributes",
          "keyCode",
          "gameService",
          "resources",
          "$filter",
          "messageHelper",
          "httpStatusCodes",
          "analyticsService",
          "eventNames",
          "diagActionList",
          "guacService",
        ]),
          t.A.controller("dialogController", r),
          (a.default = r);
      },
      3848: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(t, e, i, r) {
          (t.isGameIconAvailable = function () {
            return t.isPinOrActiveGameAvailable();
          }),
            (t.isPinOrActiveGameAvailable = function () {
              return (
                t.dialogData.placeForShown &&
                t.dialogData.placeForShown.universeId &&
                t.dialogData.placeForShown.rootPlaceId
              );
            }),
            (t.openGameList = function () {
              var e = i.eventStreamParams.openGameListInPlayTogether,
                a = { conversationId: t.dialogData.id };
              r.sendEventWithTarget(e, i.eventStreamParams.actions.click, a);
            }),
            (t.init = function () {
              t.gamesListTemplateUrl = i.templates.gamesList;
            }),
            t.init();
        }
        (i.$inject = ["$scope", "$log", "resources", "eventStreamService"]),
          t.A.controller("dialogHeaderController", i),
          (a.default = i);
      },
      3341: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(a, e, t, i) {
          (a.canRenderMessage = function (e) {
            return (
              !!e.sendingMessage || e.isSystemMessage || t.isMessageTypeLegal(e)
            );
          }),
            (a.isMessageOutgoingTrustedComms = function (e) {
              return (
                e &&
                e.sender_user_id === a.chatLibrary.userId &&
                e.moderation_type === i.moderationType.TRUSTED_COMMS
              );
            });
        }
        (i.$inject = ["$scope", "$log", "messageUtility", "chatUtility"]),
          t.A.controller("dialogMessagesController", i),
          (a.default = i);
      },
      2928: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          c = t.n(i),
          t = t(1089);
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function l(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function r(n, r, o, s, i) {
          (n.isNewGroupChat = function (e) {
            return (
              e.dialogType === o.dialogType.NEWGROUPCHAT ||
              (e.addMoreFriends && !e.isGroupChat)
            );
          }),
            (n.canAddFriendInExistedConversation = function (e) {
              return e.addMoreFriends && e.isGroupChat;
            }),
            (n.resetPreviousDialog = function (e, a, t) {
              (n.chatUserDict[e].selectedUserIds = []),
                (n.chatUserDict[e].selectedUsersDict = {}),
                t.preserved
                  ? (n.chatUserDict[e].addMoreFriends = !1)
                  : delete n.chatUserDict[e];
              var i = n.chatLibrary.dialogIdList.indexOf(e);
              -1 < i && !t.preserved
                ? (n.destroyDialogLayout(e),
                  delete n.chatLibrary.dialogDict[e],
                  t.isDuplicatedConversation
                    ? n.chatLibrary.dialogIdList.splice(i)
                    : ((n.chatLibrary.dialogIdList[i] = a),
                      (n.chatLibrary.dialogDict[a] = l({}, o.dialogInitValue))))
                : n.updateDialogList(a, !0);
            }),
            (n.generateDialog = function (e, a, t) {
              var i = t.layoutId,
                r = n.getLayoutId(e.id, a);
              (e.dialogType = a),
                i !== r
                  ? (n.getUserInfoForConversation(e),
                    (e.layoutId = r),
                    n.updateChatViewModel(e, !0),
                    n.resetPreviousDialog(i, r, t))
                  : (n.getUserInfoForConversation(e),
                    n.updateChatViewModel(e, !0),
                    (n.chatLibrary.dialogDict[i].isUpdated = !0),
                    (n.chatLibrary.dialogDict[i].updateStatus =
                      o.dialogStatus.REFRESH));
            }),
            (n.createNewGroupChat = function (e, t) {
              var i, a;
              n.newGroupChatLocked ||
                ((n.newGroupChatLocked = !0),
                (i = { layoutId: e }),
                (a = t.name),
                t.addMoreFriends &&
                  !t.isGroupChat &&
                  ((e = t.participants),
                  c().forEach(e, function (e) {
                    e = e.id;
                    e !== n.chatLibrary.userId &&
                      (t.selectedUserIds &&
                        t.selectedUserIds.indexOf(e) < 0 &&
                        t.selectedUserIds.push(e),
                      (t.selectedUsersDict[e] = c().copy(
                        n.chatLibrary.friendsDict[e],
                      )),
                      (t.selectedUsersDict[e].hiddenFromSelection = !0));
                  }),
                  (i.preserved = !0),
                  (a = "")),
                r
                  .startGroupConversation(t.selectedUserIds, a)
                  .then(function (e) {
                    var a;
                    e.status === o.resultType.SUCCESS &&
                      ((a = n.chatLibrary.allConversationLayoutIdsDict[e.id])
                        ? ((i.isDuplicatedConversation = !0),
                          n.resetPreviousDialog(t.layoutId, a, i),
                          n.chatLibrary.dialogIdList.indexOf(a) < 0 &&
                            n.launchDialog(a, !0))
                        : ((e.isGroupChat =
                            e.type ===
                            o.conversationType.multiUserConversation),
                          s.formatTimestampInConversation(e),
                          n.generateDialog(e, o.dialogType.GROUPCHAT, i))),
                      (n.newGroupChatLocked = !1);
                  })
                  .catch(function (e) {
                    n.newGroupChatLocked = !1;
                  }));
            }),
            (n.sendInvite = function (e) {
              i.debug("------------- sendInvite ------------");
              var a,
                t = n.chatUserDict[e];
              (t.dialogType !== o.dialogType.CHAT &&
                t.dialogType !== o.dialogType.GROUPCHAT) ||
              t.addMoreFriends
                ? n.canAddFriendInExistedConversation(t)
                  ? r
                      .addToConversation(t.selectedUserIds, t.id)
                      .then(function (e) {
                        e &&
                          e.status === o.resultType.SUCCESS &&
                          ((t.addMoreFriends = !1),
                          t.selectedUserIds.forEach(function (e) {
                            t.userIds.indexOf(e) < 0 && t.userIds.push(e);
                          }));
                      })
                      .finally(function () {
                        (t.selectedUserIds = []), (t.selectedUsersDict = {});
                      })
                  : n.isNewGroupChat(t) && n.createNewGroupChat(e, t)
                : (-1 < (e = (a = t.userIds).indexOf(n.chatLibrary.userId)) &&
                    a.splice(e, 1),
                  (t.selectedUserIds = a));
            });
        }
        (r.$inject = [
          "$scope",
          "chatService",
          "chatUtility",
          "messageService",
          "$log",
        ]),
          t.A.controller("dialogsController", r),
          (a.default = r);
      },
      6340: function (e, a, t) {
        "use strict";
        t.r(a);
        var l = t(7472),
          i = t(127),
          d = t.n(i),
          t = t(1089);
        function u(e) {
          return (
            (function (e) {
              if (Array.isArray(e)) return r(e);
            })(e) ||
            (function (e) {
              if ("undefined" != typeof Symbol && Symbol.iterator in Object(e))
                return Array.from(e);
            })(e) ||
            (function (e, a) {
              if (!e) return;
              if ("string" == typeof e) return r(e, a);
              var t = Object.prototype.toString.call(e).slice(8, -1);
              "Object" === t && e.constructor && (t = e.constructor.name);
              if ("Map" === t || "Set" === t) return Array.from(e);
              if (
                "Arguments" === t ||
                /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)
              )
                return r(e, a);
            })(e) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
              );
            })()
          );
        }
        function r(e, a) {
          (null == a || a > e.length) && (a = e.length);
          for (var t = 0, i = new Array(a); t < a; t++) i[t] = e[t];
          return i;
        }
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function g(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function o(s, e, a, t, i, r, n, c, o) {
          (s.dialogLayout.scrollToBottom = !1),
            (s.dialogLayout.IsdialogContainerVisible = !1),
            (s.dialogParams = g({}, e.dialogParams)),
            (s.dialogType = g({}, e.dialogType)),
            (s.userPresenceTypes = g({}, e.userPresenceTypes)),
            (s.friendsScrollbarElm = e.getScrollBarSelector(
              s.dialogData,
              e.scrollBarType.FRIENDSELECTION,
            )),
            (s.dialogData.scrollBarType = e.scrollBarType.FRIENDSELECTION),
            (s.dialogData.isCreated = !0),
            (s.updateFriendsDictData = function (e) {
              var n, o;
              null != e &&
                e.length &&
                ((n = []),
                (o = []),
                d().forEach(e, function (e) {
                  var a,
                    t,
                    i = e,
                    r = i.id;
                  (i.id = parseInt(r, 10)),
                    s.chatLibrary.usePaginatedFriends ||
                      ((a = i.name),
                      (t = i.display_name),
                      (e = i.combined_name),
                      (i.nameForDisplay = e || t || a)),
                    s.chatLibrary.friendsDict[r] ||
                      (s.chatLibrary.usePaginatedFriends
                        ? (s.chatLibrary.friendsDict[r] = {
                            id: i.id,
                            presence: {
                              userPresenceType: i.userPresence
                                ? c.conversion[i.userPresence.UserPresenceType]
                                : 0,
                            },
                          })
                        : (s.chatLibrary.friendsDict[r] = i),
                      n.push(r)),
                    o.push(r);
                }),
                (e = [l.UserProfileField.Names.CombinedName]),
                i.watchUserProfiles(o, e).subscribe(function (e) {
                  e.loading, e.error;
                  var a = e.data;
                  Object.keys(a).forEach(function (e) {
                    s.chatLibrary.friendsDict[e] &&
                      (s.chatLibrary.friendsDict[e].nameForDisplay =
                        a[e].names.combinedName);
                  });
                }),
                n &&
                  0 < n.length &&
                  a.getAvatarHeadshots(n, s.chatLibrary.friendsDict));
            });
          0 < s.chatLibrary.friendIds.length && s.updateFriends(),
            s.$watchGroup(
              [
                "dialogData.dialogType",
                "dialogLayout.details.isAddFriendsEnabled",
              ],
              function () {
                var e, a;
                !(
                  (null === (e = s.dialogData) || void 0 === e
                    ? void 0
                    : e.dialogType) === s.dialogType.NEWGROUPCHAT ||
                  (null !== (e = s.dialogLayout) &&
                    void 0 !== e &&
                    null !== (a = e.details) &&
                    void 0 !== a &&
                    a.isAddFriendsEnabled)
                ) ||
                  s.chatLibrary.isInitialFriendsLoading ||
                  s.chatLibrary.isInitialFriendsLoaded ||
                  ((s.chatLibrary.isInitialFriendsLoading = !0),
                  (s.chatLibrary.usePaginatedFriends
                    ? Promise.all([
                        r.getAllOnlineFriends(s.chatLibrary.userId),
                        r.getPaginatedFriends(s.chatLibrary.userId, ""),
                      ]).then(
                        function (e) {
                          var a = [].concat(u(e[0].data), u(e[1].PageItems));
                          0 < a.length &&
                            (s.updateFriendsDictData(a),
                            (s.chatLibrary.currentFriendCursor =
                              e[1].NextCursor)),
                            (s.chatLibrary.isInitialFriendsLoaded = !0);
                        },
                        function (e) {
                          console.debug(e);
                        },
                      )
                    : t
                        .getFriendsPresence()
                        .then(function (e) {
                          null != e && e.length && s.updateFriendsDictData(e),
                            (s.chatLibrary.isInitialFriendsLoaded = !0);
                        })
                        .catch(function (e) {
                          console.debug(e);
                        })
                  ).finally(function () {
                    s.chatLibrary.isInitialFriendsLoading = !1;
                  }));
              },
            ),
            s.$watch(
              function () {
                return Object.keys(s.chatLibrary.friendsDict).length;
              },
              function () {
                var e, a;
                (null !== (e = s.dialogData) &&
                  void 0 !== e &&
                  null !== (a = e.searchTerm) &&
                  void 0 !== a &&
                  a.length) ||
                  s.updateFriends(Object.values(s.chatLibrary.friendsDict));
              },
            ),
            s.isOverLoaded();
        }
        (o.$inject = [
          "$scope",
          "chatUtility",
          "usersService",
          "usersPresenceService",
          "userProfilesService",
          "friendsService",
          "guacService",
          "presenceLayout",
          "$timeout",
        ]),
          t.A.controller("friendsController", o),
          (a.default = o);
      },
      5300: function (e, a, t) {
        "use strict";
        t.r(a),
          t.d(a, {
            default: function () {
              return r;
            },
          });
        var g = t(7577),
          p = t(1260),
          h = CoreRobloxUtilities,
          t = t(1089);
        function i(n, t, i, r, o, s, c, l, d, u) {
          (n.isLinkCardAvailableAndParsedByClientSide = function (e) {
            return !e.isLinkCard && e.isCard;
          }),
            (n.sendEventStream = function (e, a, t) {
              a = { placeId: a, conversationId: n.dialogData.id };
              t && (a.joinAttemptId = t),
                r.sendEventWithTarget(
                  e,
                  n.chatLibrary.eventStreamParams.actions.click,
                  a,
                );
            }),
            (n.sendLoadLinkCardEvent = function (e) {
              e = { placeId: e, conversationId: n.dialogData.id };
              r.sendEventWithTarget(
                n.chatLibrary.eventStreamParams.loadGameLinkCardInChat,
                n.chatLibrary.eventStreamParams.actions.render,
                e,
              );
            }),
            (n.sendGamePlayEvent = function (e, a) {
              var t = n.chatLibrary.eventStreamParams.context;
              r.sendGamePlayEvent(t.gamePlayFromLinkCard, e, void 0, a);
            }),
            (n.playGame = function (e, a, t) {
              var i = g.GameLauncher.isJoinAttemptIdEnabled()
                  ? p.uuidService.generateRandomUuid()
                  : void 0,
                r = n.chatLibrary.eventStreamParams.context;
              n.sendEventStream(a, e, i),
                n.sendGamePlayEvent(e, i),
                t && t.privateServerLinkCode
                  ? o.playPrivateServerGame(
                      e,
                      t.privateServerLinkCode,
                      i,
                      r.gamePlayFromLinkCard,
                    )
                  : n.chatLibrary.chatLayout.playTogetherGameCardsEnabled
                    ? o.playTogetherGame(
                        e,
                        n.dialogData.id,
                        i,
                        r.gamePlayFromLinkCard,
                      )
                    : o.playRegularGame(e, !1, i, r.gamePlayFromLinkCard);
            }),
            (n.buyAccess = function (e, a) {
              var t = n.chatLibrary.placesLibrary[e],
                e = t.gameIconUrl,
                t = l("formatString")(a.buyAccess.bodyText(), {
                  placeName: t.placeName,
                  creatorName: t.creatorName,
                  price: t.price,
                }),
                a = {
                  titleText: a.buyAccess.title,
                  bodyText: t,
                  imageUrl: e,
                  actionButtonShow: !0,
                  actionButtonText: a.buyAccess.yesButtonText,
                  actionButtonClass: a.buyAccess.yesButtonClass,
                  neutralButtonText: a.buyAccess.noButtonText,
                  closeButtonShow: !0,
                };
              (n.dialogLayout.playTogetherButton.isPlayButtonDisabled = !0),
                s.open(a).result.then(
                  function () {
                    i.debug("--- purchase ---"),
                      (n.dialogLayout.playTogetherButton.isPlayButtonDisabled =
                        !1);
                  },
                  function () {
                    i.debug("--- cancel ---"),
                      (n.dialogLayout.playTogetherButton.isPlayButtonDisabled =
                        !1);
                  },
                );
            }),
            (n.goToPlaceDetails = function (e, a) {
              var t = n.chatLibrary.placesLibrary[e],
                i = {
                  universeId: t.universeId,
                  placeId: e,
                  position: 0,
                  page: n.chatLibrary.eventStreamParams.pageContext
                    .linkCardInChat,
                };
              n.sendEventStream(a, e);
              i = ""
                .concat(t.placeUrl, "?")
                .concat(p.urlService.composeQueryString(i));
              c.location.href = p.urlService.getAbsoluteUrl(i);
            }),
            (n.play = function (e, a, t) {
              switch (
                n.chatLibrary.placesLibrary[e].buttonLayoutForLinkCard.type
              ) {
                case u.playButtonTypes.play:
                  n.playGame(e, a, t);
                  break;
                case u.playButtonTypes.buy:
                  n.buyAccess(e, u);
                  break;
                case u.playButtonTypes.details:
                  n.goToPlaceDetails(e, a);
              }
            }),
            (n.pinGame = function (e, a) {
              (e = parseInt(e)), (a = parseInt(a));
              var t;
              (n.dialogData.pinGame &&
                n.dialogData.pinGame.rootPlaceId === parseInt(a)) ||
                ((t = n.chatLibrary.eventStreamParams.pinGameInLinkCard),
                d.sendPinGameEvent(t, a, n.dialogData),
                (a = {
                  rootPlaceId: a,
                  universeId: e,
                  actorUsername: n.chatLibrary.username,
                  userId: n.chatLibrary.userId,
                  placeName:
                    n.chatLibrary.placesLibrary &&
                    n.chatLibrary.placesLibrary[a]
                      ? n.chatLibrary.placesLibrary[a].placeName
                      : "",
                  encodedPlaceName:
                    n.chatLibrary.placesLibrary &&
                    n.chatLibrary.placesLibrary[a]
                      ? n.chatLibrary.placesLibrary[a].encodedPlaceName
                      : "",
                }),
                d.setPinGameData(n.dialogData, a),
                d.pinGame(n.dialogData, e),
                o.buildButtonLayoutPerConversation(
                  n.dialogData,
                  n.chatLibrary.placesLibrary,
                ));
            }),
            (n.sendGameImpressionEvent = function (e) {
              var a;
              n.gameImpressionSent ||
                ((a = n.chatLibrary.eventStreamParams),
                (n.gameImpressionSent = !0),
                (e = {
                  page: a.pageContext.linkCardInChat,
                  rootPlaceIds: JSON.stringify([e.rootPlaceId]),
                  universeIds: JSON.stringify([e.universeId]),
                  absPositions: JSON.stringify([0]),
                  sortPos: 0,
                }),
                r.sendEventWithTarget(a.gameImpressions, a.actions.render, e));
            }),
            (n.enqueueGameImpressionEvent = function (e) {
              clearTimeout(n.gameImpressionTimeout),
                (n.gameImpressionTimeout = setTimeout(function () {
                  n.sendGameImpressionEvent(e);
                }, 500));
            }),
            (n.observeGameImpressions = function (a) {
              null !== (e = n.visibilityObserver) &&
                void 0 !== e &&
                e.disconnect();
              var e = h.elementVisibilityService.observeVisibility(
                { element: t[0], threshold: 0.5 },
                function (e) {
                  e
                    ? n.enqueueGameImpressionEvent(a)
                    : clearTimeout(n.gameImpressionTimeout);
                },
              );
              n.visibilityObserver = { disconnect: e };
            }),
            n.$on("$destroy", function () {
              var e;
              null !== (e = n.visibilityObserver) &&
                void 0 !== e &&
                e.disconnect(),
                clearTimeout(n.gameImpressionTimeout);
            });
        }
        (i.$inject = [
          "$scope",
          "$element",
          "$log",
          "eventStreamService",
          "gameService",
          "modalService",
          "$window",
          "$filter",
          "pinGameService",
          "gameLayout",
        ]),
          t.A.controller("linkCardController", i);
        var r = i;
      },
      8775: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          r = t.n(i),
          t = t(1089);
        function n(e, a) {
          (e.pinGameLayout = r().copy(a)),
            (e.linkCardMessages = e.message.linkCardMessages);
        }
        (n.$inject = ["$scope", "pinGameLayout"]),
          t.A.controller("linkCardMessagesController", n),
          (a.default = n);
      },
      6893: function (e, a, t) {
        "use strict";
        t.r(a);
        var y = t(7577),
          m = t(1260),
          t = t(1089);
        function i(s, i, t, r, n, c, o, l, d, u, g, p, h) {
          (s.sendEventStream = function (e, a, t, i) {
            a = { placeId: a, conversationId: s.playTogether.id };
            t && (a.gameInstanceId = t),
              i && (a.joinAttemptId = i),
              o.sendEventWithTarget(
                e,
                s.chatLibrary.eventStreamParams.actions.click,
                a,
              );
          }),
            (s.sendGamePlayEvent = function (e, a) {
              var t = s.chatLibrary.eventStreamParams.context;
              o.sendGamePlayEvent(t.gamePlayFromPlayTogether, e, void 0, a);
            }),
            (s.buyAccess = function (e, a) {
              var t =
                s.chatLibrary.eventStreamParams.clickBuyButtonInPlayTogether;
              s.sendEventStream(t, e),
                (s.dialogLayout.playTogetherButton.isPlayButtonDisabled = !0);
              (t = s.chatLibrary.placesLibrary[e]),
                (e = t.gameIconUrl),
                (t = a.buyAccess.bodyText(
                  t.encodedPlaceName,
                  t.encodedCreatorName,
                  t.price,
                )),
                (a = {
                  titleText: a.buyAccess.title,
                  bodyText: t,
                  imageUrl: e,
                  actionButtonShow: !0,
                  actionButtonText: a.buyAccess.yesButtonText,
                  actionButtonClass: a.buyAccess.yesButtonClass,
                  neutralButtonText: a.buyAccess.noButtonText,
                  closeButtonShow: !0,
                });
              r.open(a).result.then(
                function () {
                  i.debug("--- purchase ---"),
                    (s.dialogLayout.playTogetherButton.isPlayButtonDisabled =
                      !1);
                },
                function () {
                  i.debug("--- cancel ---"),
                    (s.dialogLayout.playTogetherButton.isPlayButtonDisabled =
                      !1);
                },
              );
            }),
            (s.goToPlaceDetails = function (e) {
              var a =
                s.chatLibrary.eventStreamParams
                  .clickViewDetailsButtonInPlayTogether;
              s.sendEventStream(a, e),
                (t.location.href = m.urlService.getAbsoluteUrl(
                  s.chatLibrary.placesLibrary[e].placeUrl,
                ));
            }),
            (s.joinGame = function (e) {
              s.chatLibrary.eventStreamParams.clickJoinButtonInPlayTogether;
              var a = s.playTogether.playTogetherDict[e].placeId,
                t = s.playTogether.playTogetherDict[e].gameInstanceId,
                i = s.playTogether.playTogetherDict[e].playerIds
                  ? s.playTogether.playTogetherDict[e].playerIds[0]
                  : null,
                i = h.buildPlayGameProperties(e, a, t, i),
                e = { placeId: e, conversationId: s.playTogether.id };
              t && (e.gameInstanceId = t);
              e = {
                eventName:
                  s.chatLibrary.eventStreamParams.clickJoinButtonInPlayTogether,
                ctx: s.chatLibrary.eventStreamParams.actions.click,
                properties: e,
                gamePlayIntentEventCtx:
                  s.chatLibrary.eventStreamParams.context
                    .gamePlayFromPlayTogether,
              };
              h.launchGame(i, e);
            }),
            (s.playGame = function (e, a) {
              var t = y.GameLauncher.isJoinAttemptIdEnabled()
                  ? m.uuidService.generateRandomUuid()
                  : void 0,
                i =
                  s.chatLibrary.eventStreamParams.context
                    .gamePlayFromPlayTogether,
                r =
                  s.chatLibrary.eventStreamParams.clickPlayButtonInPlayTogether;
              s.sendEventStream(r, e, void 0, t),
                s.sendGamePlayEvent(e, t),
                n.playTogetherGame(e, a, t, i);
            }),
            (s.joinGameFromPlayTogether = function (e) {
              e = parseInt(e);
              var a = s.playTogether.placeButtonLayout[e].type,
                t = s.playTogether.id;
              switch (a) {
                case g.playButtonTypes.join:
                  s.joinGame(e);
                  break;
                case g.playButtonTypes.play:
                  s.playGame(e, t);
                  break;
                case g.playButtonTypes.buy:
                  s.buyAccess(e, g);
                  break;
                case g.playButtonTypes.details:
                  s.goToPlaceDetails(e);
              }
            }),
            (s.toggleActiveGameList = function () {
              (s.playTogetherLayout.activeGamesList.isCollapsed =
                !s.playTogetherLayout.activeGamesList.isCollapsed),
                s.playTogetherLayout.activeGamesList.isCollapsed
                  ? ((s.playTogetherLayout.activeGamesList.toggleMenuText =
                      s.playTogetherLayout.activeGamesList.showMoreText),
                    (s.playTogetherLayout.activeGamesList.limitNumber =
                      s.playTogetherLayout.activeGamesList.minNumberForFit))
                  : ((s.playTogetherLayout.activeGamesList.toggleMenuText =
                      s.playTogetherLayout.activeGamesList.showLess),
                    (s.playTogetherLayout.activeGamesList.limitNumber =
                      s.playTogetherLayout.numberOfActiveGames));
            }),
            (s.hasPinGameAndActiveGames = function () {
              return (
                !(!s.hasActiveGames() || !s.playTogether.pinGame) &&
                (1 !== s.playTogether.playTogetherIds.length ||
                  s.playTogether.playTogetherIds[0] !==
                    s.playTogether.pinGame.rootPlaceId)
              );
            }),
            (s.hasActiveGames = function () {
              var e = !1;
              return s.playTogether.playTogetherIds
                ? (s.playTogether.pinGame &&
                    ((e =
                      -1 <
                      s.playTogether.playTogetherIds.indexOf(
                        s.playTogether.pinGame.rootPlaceId,
                      )),
                    (s.playTogetherLayout.activeGamesList.pinGameIsInActiveGames =
                      e)),
                  e
                    ? s.playTogether.playTogetherIds.length - 1
                    : s.playTogether.playTogetherIds.length)
                : 0;
            }),
            (s.unPinGame = function () {
              var e, a;
              s.playTogether &&
                s.playTogether.pinGame &&
                ((e = s.chatLibrary.eventStreamParams.unpinGameInPlayTogether),
                (a = s.playTogether.pinGame.rootPlaceId),
                l.sendPinGameEvent(e, a, s.playTogether),
                l.setPinGameData(s.playTogether),
                l.unpinGame(s.playTogether),
                n.updateButtonLayoutPerConversation(s.playTogether, a),
                u.updateScrollbar(c.gameListScrollListSelector));
            }),
            (s.pinGame = function (e, a) {
              (e = parseInt(e)), (a = parseInt(a));
              var t = s.chatLibrary.eventStreamParams.pinGameInPlayTogether;
              l.sendPinGameEvent(t, a, s.playTogether);
              t = {
                rootPlaceId: a,
                universeId: e,
                actorUsername: s.chatLibrary.name,
                userId: s.chatLibrary.userId,
                placeName:
                  s.chatLibrary.placesLibrary && s.chatLibrary.placesLibrary[a]
                    ? s.chatLibrary.placesLibrary[a].placeName
                    : "",
                encodedPlaceName:
                  s.chatLibrary.placesLibrary && s.chatLibrary.placesLibrary[a]
                    ? s.chatLibrary.placesLibrary[a].encodedPlaceName
                    : "",
              };
              l.setPinGameData(s.playTogether, t),
                l.pinGame(s.playTogether, e),
                n.updateButtonLayoutPerConversation(s.playTogether, a);
            }),
            (s.initData = function () {
              var e, a, t, i, r, n, o;
              (s.playTogetherLayout = Object.assign({}, c)),
                (s.gameParameters = Object.assign({}, d)),
                (s.gameLayout = Object.assign({}, g)),
                (s.pinGameLayout = Object.assign({}, p)),
                s.dialogData
                  ? ((s.playTogether = s.dialogData),
                    (s.playTogether.inDialog = !0),
                    (s.playTogetherLayout.numberOfActiveGames =
                      s.hasActiveGames()),
                    (e = s.playTogetherLayout.numberOfActiveGames),
                    (a = (i = s.playTogetherLayout.activeGamesList)
                      .isCollapsed),
                    (t = i.pinGameIsInActiveGames),
                    (r = i.limitNumber),
                    (o = i.minNumberForFit),
                    (n = i.maxNumberForFit),
                    (i = i.showLess),
                    t &&
                      ((r = {
                        limitNumber: r + 1,
                        minNumberForFit: o + 1,
                        maxNumberForFit: n + 1,
                      }),
                      (n = s.playTogetherLayout.activeGamesList),
                      Object.assign(n, r)),
                    (o = 0 < (o = e - o) ? o : 0),
                    (o = s.playTogetherLayout.activeGamesList.showMore(o)),
                    (s.playTogetherLayout.activeGamesList.showMoreText = o),
                    1 < s.playTogetherLayout.numberOfActiveGames &&
                      (s.playTogetherLayout.activeGamesList.toggleMenuText = a
                        ? o
                        : i))
                  : ((s.playTogether = s.chatUser),
                    (s.playTogether.inDialog = !1),
                    (s.playTogetherLayout.numberOfActiveGames =
                      s.hasActiveGames()),
                    (s.playTogetherLayout.activeGamesList.limitNumber =
                      s.playTogetherLayout.numberOfActiveGames)),
                (s.chatLibrary.playTogetherLibrary[s.playTogether.id] = {
                  layout: s.playTogetherLayout,
                });
            }),
            s.initData();
        }
        (i.$inject = [
          "$scope",
          "$log",
          "$window",
          "modalService",
          "gameService",
          "playTogetherLayout",
          "eventStreamService",
          "pinGameService",
          "gameParameters",
          "chatUtility",
          "gameLayout",
          "pinGameLayout",
          "playGameService",
        ]),
          t.A.controller("playTogetherController", i),
          (a.default = i);
      },
      4549: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function o(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function i(t, e, i, r) {
          (t.hasGameAlbum = function () {
            var e = 0,
              a = null;
            return (
              t.chatUser.pinGame && (e++, (a = t.chatUser.pinGame.rootPlaceId)),
              t.chatUser.playTogetherIds &&
                (a && -1 < t.chatUser.playTogetherIds.indexOf(a)
                  ? (e = e + t.chatUser.playTogetherIds.length - 1)
                  : (e += t.chatUser.playTogetherIds.length)),
              1 < e
            );
          }),
            (t.isGameAvailableInChat = function () {
              return (
                t.chatUser.placeForShown &&
                t.chatUser.placeForShown.universeId &&
                t.chatUser.placeForShown.rootPlaceId
              );
            }),
            (t.openGameList = function () {
              var e, a;
              t.hoverPopoverParams &&
                !t.hoverPopoverParams.isOpen &&
                ((e = i.eventStreamParams.openGameListInPlayTogether),
                (a = { conversationId: t.chatUser.id }),
                r.sendEventWithTarget(e, i.eventStreamParams.actions.hover, a));
            }),
            (t.setupHoverPopover = function () {
              (t.hoverPopoverParams = o({}, i.hoverPopoverParams)),
                (t.hoverPopoverParams.triggerSelector = ".chat-friend-".concat(
                  t.chatUser.id,
                )),
                (t.hoverPopoverParams.hoverPopoverSelector =
                  ".game-list-".concat(t.chatUser.id));
            }),
            (t.shouldShowUnread = function () {
              return (
                t.chatUser &&
                t.chatUser.hasUnreadMessages &&
                !t.chatUser.isUserPending
              );
            }),
            (t.init = function () {
              (t.gamesListTemplateUrl = i.templates.gamesList),
                t.setupHoverPopover();
            }),
            t.init();
        }
        (i.$inject = ["$scope", "$log", "resources", "eventStreamService"]),
          t.A.controller("userConversationInfoController", i),
          (a.default = i);
      },
      4697: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            templateUrl: e.templates.abuseReportTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("abuseReport", i),
          (a.default = i);
      },
      4239: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            replace: !0,
            templateUrl: e.templates.addFriendsTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("addFriends", i),
          (a.default = i);
      },
      5642: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            link: function (a, e) {
              e.bind("click touchstart", function (e) {
                e.preventDefault(), a.closeDialog(a.dialogData.layoutId);
              });
            },
          };
        }
        (i.$inject = ["$log"]), t.A.directive("backBtn", i), (a.default = i);
      },
      4824: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: { userId: "@", className: "@", layoutLibrary: "=" },
            templateUrl: e.templates.chatAvatarHeadshot,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("chatAvatarHeadshot", i),
          (a.default = i);
      },
      2324: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            replace: !0,
            templateUrl: e.templates.chatBarTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("chatBar", i),
          (a.default = i);
      },
      8606: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            replace: !0,
            templateUrl: e.templates.chatBaseTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("chatBase", i),
          (a.default = i);
      },
      6501: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            link: function (e, a) {
              a.mCustomScrollbar({
                autoExpandScrollbar: !1,
                scrollInertia: 5,
                contentTouchScroll: 1,
                mouseWheel: { preventDefault: !0 },
                advanced: { autoScrollOnFocus: !1 },
              });
            },
          };
        }
        (i.$inject = ["$log"]),
          t.A.directive("chatDialogScrollbar", i),
          (a.default = i);
      },
      6328: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: { universeId: "@", className: "@", layoutLibrary: "=" },
            templateUrl: e.templates.chatGameIcon,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("chatGameIcon", i),
          (a.default = i);
      },
      2340: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            templateUrl: e.templates.chatPlaceholderTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("chatPlaceholder", i),
          (a.default = i);
      },
      5985: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(n) {
          return {
            restrict: "A",
            scope: { expiresAt: "@", onExpiry: "&" },
            link: function (a, t) {
              function i(e) {
                t.text(n.format(e)), e <= 0 && a.onExpiry();
              }
              var r = n.start(parseInt(a.expiresAt), i),
                e = a.$watch("expiresAt", function (e, a) {
                  e !== a && (n.cancel(r), (r = n.start(parseInt(e), i)));
                });
              a.$on("$destroy", function () {
                n.cancel(r), e();
              });
            },
          };
        }
        (i.$inject = ["countdownTimerService"]),
          t.A.directive("chatTimeoutTimer", i),
          (a.default = i);
      },
      8598: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: {
              chatLibrary: "=",
              dialogLayout: "=",
              confirmCallback: "&",
            },
            templateUrl: e.templates.confirmNegativeActionTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("confirmNegativeAction", i),
          (a.default = i);
      },
      2551: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: { dialogLayout: "=", confirmCallback: "&" },
            templateUrl: e.templates.confirmNegativeActionTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("confirmRemoveMember", i),
          (a.default = i);
      },
      2195: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            templateUrl: e.templates.contactCardTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("contactCard", i),
          (a.default = i);
      },
      4924: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            replace: !0,
            templateUrl: e.templates.conversationTitleTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("conversationTitle", i),
          (a.default = i);
      },
      3415: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            replace: !0,
            templateUrl: e.templates.conversationTitleEditorTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("conversationTitleEditor", i),
          (a.default = i);
      },
      1031: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            replace: !0,
            scope: !0,
            templateUrl: e.templates.detailsTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("details", i),
          (a.default = i);
      },
      9763: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          C = t.n(i),
          i = t(7472),
          t = t(1089);
        function I(e) {
          return (
            (function (e) {
              if (Array.isArray(e)) return r(e);
            })(e) ||
            (function (e) {
              if ("undefined" != typeof Symbol && Symbol.iterator in Object(e))
                return Array.from(e);
            })(e) ||
            (function (e, a) {
              if (!e) return;
              if ("string" == typeof e) return r(e, a);
              var t = Object.prototype.toString.call(e).slice(8, -1);
              "Object" === t && e.constructor && (t = e.constructor.name);
              if ("Map" === t || "Set" === t) return Array.from(e);
              if (
                "Arguments" === t ||
                /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)
              )
                return r(e, a);
            })(e) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
              );
            })()
          );
        }
        function r(e, a) {
          (null == a || a > e.length) && (a = e.length);
          for (var t = 0, i = new Array(a); t < a; t++) i[t] = e[t];
          return i;
        }
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function D(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function o(h, o, s, c, y, m, l, v, f, e, a, b, t, i, L) {
          return {
            restrict: "A",
            scope: {
              dialogData: "=",
              chatLibrary: "=",
              chatUser: "=",
              timeoutExpiresAt: "@",
              showTimeoutModal: "&",
              closeDialog: "&",
              sendInvite: "&",
              openConversationFromFriendId: "&",
              updateFriendsDictBySearch: "&",
            },
            link: function (d, u) {
              function g() {
                d.isOverLoaded(),
                  (d.dialogData.currentUserId = d.currentUserId);
                var a,
                  e = f.templates.dialogTemplate,
                  t = f.templates.groupDialogTemplate,
                  i = f.templates.createChatGroupTemplate;
                switch (d.dialogData.dialogType) {
                  case y.dialogType.CHAT:
                    C().forEach(d.dialogData.userIds, function (e) {
                      e !== d.chatLibrary.userId && (a = e);
                    }),
                      (d.dialogLayout.title = d.dialogData.title),
                      (d.dialogLayout.templateUrl = e),
                      (d.dialogLayout.scrollbarElm = y.getScrollBarSelector(
                        d.dialogData,
                        y.scrollBarType.MESSAGE,
                      )),
                      (d.dialogData.name = d.dialogData.title),
                      (d.dialogData.nameLink = d.chatLibrary.friendsDict[a]
                        ? d.chatLibrary.friendsDict[a].profileUrl
                        : "");
                    break;
                  case y.dialogType.GROUPCHAT:
                    (d.dialogLayout.templateUrl = t),
                      (d.dialogLayout.limitMemberDisplay = r),
                      (d.dialogLayout.scrollbarElm = y.getScrollBarSelector(
                        d.dialogData,
                        y.scrollBarType.MESSAGE,
                      )),
                      (d.dialogData.name = d.dialogData.title);
                    break;
                  case y.dialogType.NEWGROUPCHAT:
                    (d.dialogLayout.title = d.dialogData.title),
                      (d.dialogLayout.templateUrl = i);
                }
                d.updateDialogStyle();
              }
              function p() {
                (d.dialogLayout.IsdialogContainerVisible ||
                  u.find(".dialog-container")) &&
                  ((d.dialogLayout.IsdialogContainerVisible = !1), u.empty());
                var e = C().element(s.get(d.dialogLayout.templateUrl));
                d.chatLibrary &&
                  d.chatLibrary.dialogScopeLib[d.dialogData.id] &&
                  (t = d.chatLibrary.dialogScopeLib[d.dialogData.id]),
                  d.$$childHead &&
                    null != d.$$childHead &&
                    d.$$childHead.timeStamp === t &&
                    d.$$childHead.$destroy();
                var a = d.$new(),
                  t = Date.now();
                d.chatLibrary &&
                  (d.chatLibrary.dialogScopeLib[d.dialogData.id] = t),
                  (a.timeStamp = t),
                  (t = o(e)),
                  u.append(e),
                  t(a);
              }
              var r = y.dialogLayout.limitMemberDisplay,
                e = 0,
                a = "";
              d.saveIntoDialogsLayout = function () {
                var e = d.dialogData.layoutId;
                d.dialogLayout &&
                  d.dialogLayout.layoutId === e &&
                  ((d.chatLibrary.dialogsLayout[e] = d.dialogLayout),
                  m.updateStorage(
                    m.storageDictionary.dialogsLayout,
                    d.chatLibrary.dialogsLayout,
                    d.chatLibrary.cookieOption,
                  ));
              };
              function n(e) {
                var a = C().isDefined(d.dialogData.userIds)
                    ? d.dialogData.userIds.indexOf(e)
                    : -1,
                  e = C().isDefined(d.dialogData.selectedUserIds)
                    ? d.dialogData.selectedUserIds.indexOf(e)
                    : -1;
                return a < 0 && e < 0;
              }
              function t() {
                d.dialogLibrary = l.getLocalStorage(
                  d.chatLibrary.dialogLocalStorageName,
                )
                  ? l.getLocalStorage(d.chatLibrary.dialogLocalStorageName)
                  : {};
              }
              var i;
              (d.updateDialogStyle = function () {
                y.updateDialogStyle(
                  d.dialogData,
                  d.dialogLayout,
                  d.chatLibrary,
                );
              }),
                (d.updateFriends = function (e, a) {
                  var t,
                    i = [];
                  e
                    ? ((t = d.chatLibrary.usePaginatedFriends
                        ? null
                        : y.sortFriendList(d.chatLibrary, e)) ||
                        d.chatLibrary.usePaginatedFriends) &&
                      (d.chatLibrary.usePaginatedFriends && (t = e),
                      t.forEach(function (e) {
                        n(e.id) && i.push(e.id),
                          d.chatLibrary.friendsDict[e.id] ||
                            (d.chatLibrary.friendsDict[e.id] = e);
                      }),
                      (d.dialogData.friendIds =
                        a || !d.chatLibrary.usePaginatedFriends
                          ? i
                          : I(new Set(d.dialogData.friendIds.concat(i)))))
                    : ((t = d.chatLibrary.friendIds.slice()),
                      C().forEach(t, function (e) {
                        n(e) && i.push(e);
                      }),
                      (d.dialogData.friendIds =
                        a || !d.chatLibrary.usePaginatedFriends
                          ? i
                          : I(new Set(d.dialogData.friendIds.concat(i)))));
                }),
                (d.isOverLoaded = function () {
                  C().isUndefined(d.dialogData.selectedUserIds) &&
                    ((d.dialogData.selectedUserIds = []),
                    (d.dialogData.selectedUsersDict = {})),
                    d.dialogData.dialogType !== y.dialogType.FRIEND &&
                      (d.dialogData.dialogType === y.dialogType.NEWGROUPCHAT
                        ? (d.dialogData.numberOfSelected =
                            d.dialogData.selectedUserIds.length)
                        : d.dialogData.dialogType === y.dialogType.CHAT
                          ? (d.dialogData.numberOfSelected =
                              d.dialogData.userIds.length +
                              d.dialogData.selectedUserIds.length)
                          : (d.dialogData.numberOfSelected =
                              d.dialogData.userIds.length +
                              d.dialogData.selectedUserIds.length -
                              1),
                      (d.dialogLayout.isMembersOverloaded =
                        d.dialogData.numberOfSelected >=
                        d.chatLibrary.quotaOfGroupChatMembers));
                }),
                (d.dialogData.selectedUserIds = []),
                (d.dialogData.selectedUsersDict = {}),
                (d.selectFriends = function (e) {
                  var a = d.dialogData.selectedUserIds.indexOf(e);
                  a < 0 && !d.dialogLayout.isMembersOverloaded
                    ? (d.dialogData.selectedUserIds.push(e),
                      (d.dialogData.selectedUsersDict[e] = C().copy(
                        d.chatLibrary.friendsDict[e],
                      )))
                    : -1 < a &&
                      (d.dialogData.selectedUserIds.splice(a, 1),
                      delete d.dialogData.selectedUsersDict[e]),
                    (d.dialogData.searchTerm = ""),
                    d.isOverLoaded();
                }),
                (d.isNumberOfMemberOverloaded = function () {
                  var e = d.dialogData.selectedUserIds
                      ? d.dialogData.selectedUserIds.length
                      : 0,
                    a = 0;
                  return (
                    d.dialogData.userIds &&
                      (a =
                        d.dialogData.dialogType === y.dialogType.CHAT
                          ? d.dialogData.userIds.length
                          : d.dialogData.userIds.length - 1),
                    e + a >= d.chatLibrary.quotaOfGroupChatMembers &&
                      ((d.dialogLayout.isMembersOverloaded = !0),
                      (!d.dialogLayout.details.isEnabled &&
                        d.dialogData.dialogType !==
                          y.dialogType.NEWGROUPCHAT) ||
                        ((d.toastLayout.isNeeded = !0),
                        d.toastLayout.text ||
                          (d.toastLayout.text =
                            d.dialogLayout.memberDisplay.toastText(
                              d.chatLibrary.quotaOfGroupChatMembers,
                            ))),
                      !0)
                  );
                }),
                (d.toggleFriendSelection = function (e, a) {
                  a && a.preventDefault();
                  a = d.dialogData.selectedUserIds.indexOf(e);
                  a < 0 && !d.isNumberOfMemberOverloaded()
                    ? (d.dialogData.selectedUserIds.push(e),
                      (d.dialogData.selectedUsersDict[e] = C().copy(
                        d.chatLibrary.friendsDict[e],
                      )),
                      (d.dialogData.selectedUsersDict[e].isSelected = !0))
                    : -1 < a &&
                      (d.dialogData.selectedUserIds.splice(a, 1),
                      delete d.dialogData.selectedUsersDict[e]),
                    (d.dialogData.searchTerm = ""),
                    d.isOverLoaded();
                }),
                (d.toggleDialogContainer = function () {
                  (d.dialogLayout.collapsed = !d.dialogLayout.collapsed),
                    d.toggleDialogFocusStatus(!d.dialogLayout.collapsed),
                    d.saveIntoDialogsLayout(),
                    y.updateDialogsPosition(d.chatLibrary);
                }),
                (d.toggleDialogFocusStatus = function (e) {
                  e &&
                    (y.updateFocusedDialog(
                      d.chatLibrary,
                      d.dialogData.layoutId,
                    ),
                    v.markMessagesAsRead(
                      d.dialogData,
                      d.chatLibrary
                        .shouldRespectConversationHasUnreadMessageToMarkAsRead,
                    )),
                    (d.dialogLayout.hasFocus = e) &&
                      d.dialogLayout.active &&
                      d.markInactive();
                  var a,
                    a =
                      e &&
                      ((a = ""),
                      C().isDefined(window.getSelection)
                        ? (a = window.getSelection().toString())
                        : C().isDefined(window.document.selection) &&
                          "Text" === window.document.selection.type &&
                          (a = window.document.selection.createRange().text),
                      !(0 < a.length)) &&
                      !d.dialogLayout.collapsed &&
                      !d.dialogLayout.renameEditor.isEnabled;
                  return (
                    (d.dialogLayout.focusMeEnabled = a),
                    d.saveIntoDialogsLayout(),
                    !1
                  );
                }),
                (d.getTitle = function (e) {
                  var a = d.dialogData.chatMessages;
                  if (a && 0 < a.length) {
                    var t = a[0].sender_user_id;
                    if (!t) return !1;
                    t = d.chatLibrary.friendsDict[t].name;
                  } else t = d.dialogData.initiator.name;
                  (t = c("formatString")(y.chatLayout.defaultTitleForMessage, {
                    userName: t,
                  })),
                    (d.title = t);
                }),
                (d.changeTitle = function () {
                  (h.document.title =
                    e % 2 == 0 ? d.title : d.chatLibrary.currentTabTitle),
                    e++;
                }),
                (d.markInactive = function () {
                  d.dialogLayout.active &&
                    ((d.dialogLayout.active = !1),
                    t(),
                    d.dialogLibrary &&
                      d.dialogLibrary[d.dialogData.layoutId] &&
                      d.dialogLibrary[d.dialogData.layoutId].active &&
                      (L.debug(
                        " --------------- markInactive -------------- set into local storage",
                      ),
                      C().isUndefined(d.dialogLibrary[d.dialogData.layoutId]) &&
                        (d.dialogLibrary[d.dialogData.layoutId] = {}),
                      (d.dialogLibrary[d.dialogData.layoutId].active = !1),
                      (d.dialogLibrary[d.dialogData.layoutId].played = !1),
                      l.setLocalStorage(
                        d.chatLibrary.dialogLocalStorageName,
                        d.dialogLibrary,
                      )));
                }),
                (d.markActive = function (e) {
                  t(),
                    C().isUndefined(d.dialogLibrary[d.dialogData.layoutId]) &&
                      (d.dialogLibrary[d.dialogData.layoutId] = {}),
                    (d.dialogLibrary[d.dialogData.layoutId].active = !0),
                    (d.dialogLibrary[d.dialogData.layoutId].played = !1),
                    l.setLocalStorage(
                      d.chatLibrary.dialogLocalStorageName,
                      d.dialogLibrary,
                    ),
                    (!d.dialogLayout.collapsed &&
                      d.chatLibrary.chatLayout.focusedLayoutId ===
                        d.dialogData.layoutId) ||
                      ((d.dialogLayout.active = !0),
                      d.dialogLayout.focusMeEnabled &&
                        (d.dialogLayout.focusMeEnabled = !1));
                }),
                (d.handleLocalStorage = function (e) {
                  e.key === d.chatLibrary.dialogLocalStorageName &&
                    (t(),
                    d.dialogLayout.active &&
                      d.dialogLibrary &&
                      d.dialogLibrary[d.dialogData.layoutId] &&
                      !d.dialogLibrary[d.dialogData.layoutId].active &&
                      d.markInactive());
                }),
                (d.checkNewGenerationDialogStatus = function () {
                  d.dialogData.isRenameEditorNeeded &&
                    (d.dialogLayout.focusMeEnabled &&
                      (d.dialogLayout.focusMeEnabled = !1),
                    (d.dialogData.isRenameEditorNeeded = !1),
                    (d.dialogLayout.renameEditor.isEnabled = !0),
                    (d.dialogLayout.renameEditor.hasFocus = !0));
                }),
                (d.searchFriends = function () {
                  clearTimeout(i),
                    (i = setTimeout(function () {
                      0 !== d.dialogData.searchTerm.length
                        ? ((d.chatLibrary.chatLayout.isFriendsLoading = !0),
                          b
                            .searchFriends(
                              d.chatLibrary.userId,
                              d.dialogData.searchTerm,
                            )
                            .then(
                              function (e) {
                                null != e &&
                                  e.PageItems.length &&
                                  (d.updateFriendsDictBySearch({
                                    friends: e.PageItems,
                                  }),
                                  d.updateFriends(e.PageItems, !0),
                                  (d.chatLibrary.chatLayout.isFriendsLoading =
                                    !1),
                                  (a = d.chatLibrary.currentFriendCursor),
                                  (d.chatLibrary.currentFriendCursor =
                                    e.NextCursor));
                              },
                              function (e) {
                                console.debug(e);
                              },
                            ))
                        : (d.updateFriends(
                            Object.values(d.chatLibrary.friendsDict),
                            !0,
                          ),
                          (d.chatLibrary.currentFriendCursor = a),
                          d.$apply());
                    }, 250));
                }),
                (d.search = function (e) {
                  if (!d.chatLibrary.usePaginatedFriends) {
                    var a = d.dialogData.searchTerm;
                    if (!a) return !0;
                    var t = e.name,
                      i = e.contact,
                      r = e.display_name,
                      e = e.nameForDisplay,
                      a = a.toLowerCase();
                    return (
                      -1 !== t.toLowerCase().indexOf(a) ||
                      (r && -1 !== r.toLowerCase().indexOf(a)) ||
                      (i && -1 !== i.toLowerCase().indexOf(a)) ||
                      (e && -1 !== e.toLowerCase().indexOf(a))
                    );
                  }
                }),
                (d.refreshShowTimedOutInputBar = function () {
                  d.showTimedOutInputBar =
                    d.timeoutExpiresAt &&
                    Date.now() < parseInt(d.timeoutExpiresAt);
                }),
                d.refreshShowTimedOutInputBar(),
                d.$watch("timeoutExpiresAt", function (e, a) {
                  e !== a && d.refreshShowTimedOutInputBar();
                }),
                (d.dialogData.friendIds = d.chatLibrary.friendIds
                  ? d.chatLibrary.friendIds.slice()
                  : []),
                (d.dialogMessages = []),
                (d.dialogType = D({}, y.dialogType)),
                (d.dialogBannerTypes = D({}, y.dialogBannerTypes)),
                (d.dialogLayout = C().isDefined(
                  d.chatLibrary.dialogsLayout[d.dialogData.layoutId],
                )
                  ? d.chatLibrary.dialogsLayout[d.dialogData.layoutId]
                  : C().copy(y.dialogLayout)),
                (d.dialogLayout.layoutId = d.dialogData.layoutId),
                (d.toastLayout = {
                  isEnabled: d.dialogLayout.isMembersOverloaded,
                  timeout: d.dialogLayout.memberDisplay.timeoutToast,
                }),
                (d.dialogLayout.defaultStyle = {}),
                d.isOverLoaded(),
                d.$watch(
                  function () {
                    return d.chatLibrary.dialogDict;
                  },
                  function (e, a) {
                    if (
                      C().isDefined(e) &&
                      C().isDefined(e[d.dialogData.layoutId])
                    ) {
                      var t = d.dialogData.layoutId,
                        i = d.chatLibrary,
                        r = i.dialogIdList.indexOf(t),
                        n = e[t];
                      if (!a[t] || n.isUpdated)
                        switch (
                          (C().isDefined(
                            d.chatLibrary.dialogsLayout[d.dialogData.layoutId],
                          )
                            ? (d.dialogLayout =
                                d.chatLibrary.dialogsLayout[
                                  d.dialogData.layoutId
                                ])
                            : C().isUndefined(d.dialogLayout)
                              ? (d.dialogLayout = C().copy(y.dialogLayout))
                              : n.updateStatus === y.dialogStatus.INIT &&
                                d.dialogLayout &&
                                (d.dialogLayout.renameEditor = D(
                                  {},
                                  y.dialogLayout.renameEditor,
                                )),
                          (n.isUpdated = !1),
                          n.updateStatus)
                        ) {
                          case y.dialogStatus.REPLACE:
                            -1 < r &&
                              (d.dialogLayout.collapsed &&
                                (d.dialogLayout.collapsed = !1),
                              (n.updateStatus = y.dialogStatus.INIT),
                              d.toggleDialogFocusStatus(!0));
                          case y.dialogStatus.INIT:
                            -1 < r &&
                              (d.dialogLayout.focusMeEnabled === n.autoOpen &&
                                (d.dialogLayout.focusMeEnabled = !n.autoOpen),
                              d.checkNewGenerationDialogStatus(),
                              g(),
                              p());
                            break;
                          case y.dialogStatus.MINIMIZE:
                            g(),
                              d.chatLibrary.minimizedDialogIdList.indexOf(t) <
                                0 &&
                                (d.chatLibrary.minimizedDialogIdList.push(t),
                                (d.chatLibrary.minimizedDialogData[t] =
                                  d.dialogData)),
                              u.empty();
                            break;
                          case y.dialogStatus.REFRESH:
                            g(), (n.updateStatus = y.dialogStatus.INIT);
                        }
                      m.updateStorage(
                        m.storageDictionary.dialogIdList,
                        d.chatLibrary.dialogIdList,
                        d.chatLibrary.cookieOption,
                      ),
                        m.updateStorage(
                          m.storageDictionary.dialogDict,
                          d.chatLibrary.dialogDict,
                          d.chatLibrary.cookieOption,
                        ),
                        d.saveIntoDialogsLayout(),
                        -1 < r &&
                          ((o = i.dialogIdList),
                          (c = d.dialogData.layoutId),
                          (l = "#".concat(c)),
                          (e = d.chatLibrary.chatLayout),
                          (a = C()
                            .element(document.querySelector(l))
                            .find(".dialog-container")),
                          (i = e.widthOfChat),
                          (l = e.widthOfDialog + e.spaceOfDialog),
                          (o = o.indexOf(c)),
                          (c = d.chatLibrary),
                          (i =
                            +i +
                            y.calculateRightPosition(c, o) +
                            e.spaceOfDialog),
                          h.innerWidth < i + l
                            ? (s = +e.defaultChatZIndex + 1)
                            : ((s = +e.defaultChatZIndex + o),
                              y.updateDialogsPosition(c)),
                          a.css("z-index", s),
                          a.addClass("dialog-visible"),
                          n.markAsActive &&
                            (d.markActive(n.activeType),
                            (n.markAsActive = !1)));
                    }
                    var o, s, c, l;
                  },
                  !0,
                ),
                d.$on("Roblox.Chat.MarkDialogInactive", function (e, a) {
                  a.layoutId === d.dialogData.layoutId && d.markInactive();
                }),
                l.listenLocalStorage(d.handleLocalStorage);
            },
          };
        }
        (o.$inject = [
          "$window",
          "$compile",
          "$templateCache",
          "$filter",
          "chatUtility",
          "chatClientStorageUtilityService",
          "localStorageService",
          "messageService",
          "resources",
          "gameService",
          "gameLayout",
          "friendsService",
          "userProfilesService",
          "usersService",
          "$log",
        ]),
          t.A.directive("dialog", o),
          (a.default = o);
      },
      8648: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            replace: !0,
            scope: !0,
            templateUrl: e.templates.dialogHeader,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("dialogHeader", i),
          (a.default = i);
      },
      5457: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          c = t.n(i),
          t = t(1089);
        function r(a, n, o, s, t) {
          return {
            restrict: "A",
            scope: !0,
            link: function (r, e) {
              (r.callbackScrollToBottom = function () {
                r.updateDialog();
              }),
                (r.callbackLazyLoad = function () {
                  if (
                    !r.dialogParams.loadMoreMessages ||
                    !r.dialogLayout.IsdialogContainerVisible ||
                    r.dialogData.dialogType === n.dialogType.FRIEND
                  )
                    return !1;
                  r.dialogLayout.isChatLoading = !0;
                  r.dialogData.chatMessages.length;
                  var e = r.dialogParams.getMessagesNextCursor;
                  a.getMessages(
                    r.dialogData.id,
                    e,
                    r.dialogParams.pageSizeOfGetMessages,
                  ).then(
                    function (e) {
                      var a = e.messages;
                      if (((r.dialogLayout.isChatLoading = !1), a)) {
                        if (
                          (c().isUndefined(r.dialogData.messagesDict) &&
                            (r.dialogData.messagesDict = {}),
                          (r.dialogParams.getMessagesNextCursor =
                            e.next_cursor),
                          0 < a.length)
                        ) {
                          (r.dialogLayout.scrollToBottom = !1),
                            o.preProcessMessages(
                              r.chatLibrary,
                              r.dialogData,
                              a,
                            );
                          for (var t = 0; t < a.length; t++) {
                            var i = a[t];
                            i.type === n.messageSenderType.SYSTEM &&
                              (i.isSystemMessage = !0),
                              o.buildFallbackTimeStamp(i, r.dialogData),
                              (c().isDefined(i.id) &&
                                c().isDefined(
                                  r.dialogData.messagesDict[i.id],
                                )) ||
                                (o.setFallbackClusterMaster(r.dialogData, i),
                                c().isDefined(i.id) &&
                                  (r.dialogData.messagesDict[i.id] = i));
                          }
                          s.fetchDataForLinkCard(a, r.chatLibrary);
                        }
                        !e.next_cursor &&
                          (r.dialogParams.loadMoreMessages = !1);
                      } else
                        (r.dialogParams.loadMoreMessages = !1),
                          o.processMessages(
                            r.chatLibrary,
                            r.dialogData,
                            a,
                            r.chatLibrary.friendsDict,
                          ),
                          s.fetchDataForLinkCard(a, r.chatLibrary);
                    },
                    function () {
                      (r.dialogLayout.isChatLoading = !1),
                        t.debug(
                          "---error from get getMessages in dialogLazyLoadDirective.js---",
                        );
                    },
                  );
                });
              e.mCustomScrollbar({
                autoExpandScrollbar: !1,
                scrollInertia: 5,
                contentTouchScroll: 1,
                mouseWheel: { preventDefault: !0 },
                callbacks: {
                  onInit: function () {
                    t.debug("---- onInit callback ---- Scrollbars updated"),
                      n.shouldScrollFromTop(r.dialogData, r.chatLibrary)
                        ? r.updateDialog()
                        : (r.dialogLayout.scrollToBottom = !0);
                  },
                  onUpdate: function () {
                    t.debug(
                      "---- onUpdate callback ---- Scrollbars updated" +
                        r.dialogLayout.scrollToBottom,
                    ),
                      r.dialogLayout.scrollToBottom
                        ? (e.mCustomScrollbar("scrollTo", "bottom", {
                            scrollInertia: 0,
                          }),
                          r.chatLibrary.useOneToOneOsaContextCards &&
                            (r.dialogLayout.scrollToBottom = !1))
                        : r.chatLibrary.useOneToOneOsaContextCards ||
                          (r.dialogLayout.scrollToBottom = !0),
                      e.hasClass("mCS_no_scrollbar") && r.updateDialog();
                  },
                  onTotalScroll: r.callbackScrollToBottom,
                  onTotalScrollOffset: 60,
                  onTotalScrollBack: r.callbackLazyLoad,
                },
              });
            },
          };
        }
        (r.$inject = [
          "chatService",
          "chatUtility",
          "messageService",
          "gameService",
          "$log",
        ]),
          t.A.directive("dialogLazyLoad", r),
          (a.default = r);
      },
      3315: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          i = t(127),
          s = t.n(i),
          t = t(1089);
        function r(n, e, o) {
          return {
            restrict: "A",
            scope: { chatLibrary: "=" },
            templateUrl: e.templates.dialogMinimizeTemplate,
            link: function (t, i) {
              function r() {
                var e = t.chatLibrary.chatLayout,
                  a = t.chatLibrary.dialogIdList.length,
                  e =
                    +e.widthOfChat +
                    n.calculateRightPosition(t.chatLibrary, a) +
                    e.spaceOfDialog;
                i.css("right", e);
              }
              (t.dialogType = n.dialogType),
                (t.chatLibrary.hasMinimizedDialogs = !1),
                (t.layoutIdHasClicked = !1),
                (t.openDialog = function (e) {
                  o.debug(
                    " -------------------openDialog------------------ " + e,
                  );
                  var a = t.chatLibrary.dialogIdList.pop();
                  (t.chatLibrary.dialogDict[a].isUpdated = !0),
                    (t.chatLibrary.dialogDict[a].updateStatus =
                      n.dialogStatus.MINIMIZE),
                    t.chatLibrary.dialogIdList.push(e),
                    (t.chatLibrary.dialogDict[e].isUpdated = !0),
                    (t.chatLibrary.dialogDict[e].updateStatus =
                      n.dialogStatus.REPLACE);
                  a = t.chatLibrary.minimizedDialogIdList.indexOf(e);
                  -1 < a &&
                    (t.chatLibrary.minimizedDialogIdList.splice(a, 1),
                    delete t.chatLibrary.minimizedDialogData[e]);
                }),
                (t.remove = function (e) {
                  var a = t.chatLibrary.minimizedDialogIdList.indexOf(e);
                  -1 < a &&
                    (t.chatLibrary.minimizedDialogIdList.splice(a, 1),
                    delete t.chatLibrary.minimizedDialogData[e],
                    delete t.chatLibrary.dialogDict[e]);
                }),
                Roblox.BootstrapWidgets.SetupPopover(
                  "top",
                  { selector: "#dialogs-minimize" },
                  "#dialogs-minimize-container",
                ),
                t.$watch(
                  function () {
                    return t.chatLibrary.minimizedDialogIdList;
                  },
                  function (e, a) {
                    s().isUndefined(e) ||
                      e == a ||
                      (o.debug("------ watch minimizedDialogIdList ----- "),
                      0 < e.length
                        ? (t.chatLibrary.hasMinimizedDialogs ||
                            (t.chatLibrary.hasMinimizedDialogs = !0),
                          r())
                        : 0 === e.length &&
                          (t.chatLibrary.hasMinimizedDialogs = !1));
                  },
                  !0,
                ),
                t.$watch(
                  function () {
                    return t.chatLibrary.chatLayout.areDialogsUpdated;
                  },
                  function (e, a) {
                    e &&
                      e !== a &&
                      (t.$evalAsync(function () {
                        t.chatLibrary.chatLayout.areDialogsUpdated = !1;
                      }),
                      r());
                  },
                  !0,
                );
            },
          };
        }
        (r.$inject = ["chatUtility", "resources", "$log"]),
          t.A.directive("dialogMinimize", r),
          (a.default = r);
      },
      7656: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(t, e, a) {
          return {
            restrict: "A",
            scope: !0,
            link: function (a, e) {
              (a.callbackLazyLoad = function () {
                a.chatLibrary.chatLayout.isFriendsLoading ||
                  null === a.chatLibrary.currentFriendCursor ||
                  "" === a.chatLibrary.currentFriendCursor ||
                  ((a.chatLibrary.chatLayout.isFriendsLoading = !0),
                  t
                    .getPaginatedFriends(
                      a.chatLibrary.userId,
                      a.chatLibrary.currentFriendCursor,
                    )
                    .then(
                      function (e) {
                        null != e &&
                          e.PageItems.length &&
                          (a.updateFriendsDictData(e.PageItems),
                          (a.chatLibrary.chatLayout.isFriendsLoading = !1),
                          (a.chatLibrary.currentFriendCursor = e.NextCursor));
                      },
                      function (e) {
                        console.debug(e);
                      },
                    ));
              }),
                e.mCustomScrollbar({
                  autoExpandScrollbar: !1,
                  scrollInertia: 100,
                  contentTouchScroll: 1,
                  mouseWheel: { preventDefault: !0 },
                  callbacks: {
                    onTotalScrollOffset: 100,
                    onTotalScroll: a.callbackLazyLoad,
                    onOverflowYNone: a.callbackLazyLoad,
                  },
                });
            },
          };
        }
        (i.$inject = ["friendsService", "$log", "$document"]),
          t.A.directive("friendsLazyLoad", i),
          (a.default = i);
      },
      3844: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          n = t.n(i),
          t = t(1089);
        function r(e) {
          return {
            restrict: "A",
            link: function (i, e) {
              var r = i.chatLibrary.layout.topBarHeight;
              i.$watch(
                function () {
                  return e.innerHeight();
                },
                function (e, a) {
                  var t;
                  e &&
                    e !== a &&
                    ((t = "#".concat(
                      i.dialogData.layoutId,
                      " .dialog-container",
                    )),
                    (a = "#"
                      .concat(i.dialogData.layoutId, " ")
                      .concat(i.friendsScrollbarElm)),
                    (t = n().element(t)),
                    (a = n().element(a)),
                    (e = r + e),
                    (e = t.height() - e),
                    a.css("height", e),
                    a.mCustomScrollbar("update"));
                },
                !0,
              );
            },
          };
        }
        (r.$inject = ["$log"]),
          t.A.directive("groupSelect", r),
          (a.default = r);
      },
      3325: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(a, n, t, i, o, s, c) {
          return {
            restrict: "A",
            scope: !0,
            link: function (r, e) {
              (r.callbackLazyLoad = function () {
                if (
                  !r.chatApiParams ||
                  r.chatLibrary.chatLayout.errorMaskEnable ||
                  !r.chatApiParams.loadMoreConversations
                )
                  return !1;
                var e;
                (r.chatLibrary.chatLayout.isChatLoading = !0),
                  r.chatApiParams.loadMoreConversations &&
                    ((e = r.chatApiParams.getUserConversationsNextCursor),
                    a
                      .getUserConversations(
                        e,
                        r.chatApiParams.pageSizeOfConversations,
                        r.chatLibrary.friendsDict,
                      )
                      .then(
                        function (e) {
                          var a = e.conversations,
                            t = r.chatLibrary.friendsDict,
                            i = o.getUserIdsNotInFriendsDict(a, t);
                          return (
                            (r.chatLibrary.chatLayout.isChatLoading = !1),
                            a && 0 < a.length
                              ? (r.buildChatUserListByConversations(a),
                                (r.chatApiParams.getUserConversationsNextCursor =
                                  e.next_cursor),
                                n.updateScrollbar(
                                  n.chatLayout.scrollbarClassName,
                                ),
                                e.next_cursor ||
                                  ((r.chatApiParams.loadMoreConversations = !1),
                                  (r.chatApiParams.getUserConversationsNextCursor =
                                    null)))
                              : ((r.chatApiParams.loadMoreConversations = !1),
                                (r.chatApiParams.getUserConversationsNextCursor =
                                  null)),
                            c.getUserContacts(i, t),
                            s.getUserInfo(i, t)
                          );
                        },
                        function () {
                          (r.chatLibrary.chatLayout.isChatLoading = !1),
                            t.debug(
                              "---error from get Conversations in lazyLoadDirective.js---",
                            );
                        },
                      ));
              }),
                (r.callbackScrollStart = function () {
                  r.$broadcast("Roblox.Chat.ConversationListScroll"),
                    i.triggerHandler("HoverPopover.EnableClose");
                }),
                e.mCustomScrollbar({
                  autoExpandScrollbar: !1,
                  scrollInertia: 5,
                  contentTouchScroll: 1,
                  mouseWheel: { preventDefault: !0 },
                  callbacks: {
                    onTotalScrollOffset: 100,
                    onTotalScroll: r.callbackLazyLoad,
                    onOverflowYNone: r.callbackLazyLoad,
                    onScrollStart: r.callbackScrollStart,
                  },
                });
            },
          };
        }
        (i.$inject = [
          "chatService",
          "chatUtility",
          "$log",
          "$document",
          "conversationsUtility",
          "usersService",
          "contactsService",
        ]),
          t.A.directive("lazyLoad", i),
          (a.default = i);
      },
      5737: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            replace: !0,
            templateUrl: e.templates.linkCard,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("linkCard", i),
          (a.default = i);
      },
      8994: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          r = t.n(i),
          t = t(1089);
        function n(e) {
          return {
            restrict: "A",
            scope: !0,
            link: function (e) {
              r()
                .element("#dialogs-minimize")
                .on(
                  "click touchstart",
                  ".popover-content #" + e.dialogLayoutId + " .minimize-title",
                  function () {
                    e.$apply(e.openDialog(e.dialogLayoutId));
                  },
                );
              r()
                .element("#dialogs-minimize")
                .on(
                  "click touchstart",
                  ".popover-content #" + e.dialogLayoutId + " .minimize-close",
                  function () {
                    e.$apply(e.remove(e.dialogLayoutId));
                  },
                );
            },
          };
        }
        (n.$inject = ["$log"]),
          t.A.directive("minimizeItem", n),
          (a.default = n);
      },
      5041: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e, t, i, r) {
          return {
            restrict: "A",
            templateUrl: e.templates.osaContextCardTemplate,
            link: function (a) {
              a.dialogData.osaAcknowledgementStatus ===
                r.osaAcknowledgementStatus.UNACKNOWLEDGED &&
                t
                  .recordModalSequenceResponse({
                    conversationId:
                      a.dialogData.source === r.conversationSource.CHANNELS
                        ? a.dialogData.id
                        : null,
                    friendId:
                      a.dialogData.source === r.conversationSource.FRIENDS
                        ? a.dialogData.id
                        : null,
                    modalSequence:
                      r.modalSequence.CONVERSATION_INLINE_TOP_MODAL,
                    modalVariant: r.modalVariant.OSA_CONTEXT_CARD,
                    actionType: r.modalActionType.RECORD_HAS_SEEN,
                  })
                  .then(function (e) {
                    e.status === r.resultType.SUCCESS &&
                      ((a.dialogData.osaAcknowledgementStatus =
                        r.osaAcknowledgementStatus.ACKNOWLEDGED),
                      a.dialogData.source === r.conversationSource.CHANNELS &&
                        t
                          .getMessages(
                            a.dialogData.id,
                            null,
                            a.dialogParams.pageSizeOfGetMessages,
                          )
                          .then(function (e) {
                            e = e.messages;
                            e &&
                              0 < e.length &&
                              i.updatePreviewMessage(a.dialogData, e);
                          }));
                  });
            },
          };
        }
        (i.$inject = [
          "resources",
          "chatService",
          "messageService",
          "chatUtility",
        ]),
          t.A.directive("osaContextCard", i),
          (a.default = i);
      },
      1547: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            templateUrl: e.templates.pendingStateTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("pendingState", i),
          (a.default = i);
      },
      5897: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            scope: !0,
            link: function (a, e) {
              e.bind("click touchstart", function (e) {
                e.preventDefault(), a.sendMessage();
              });
            },
          };
        }
        (i.$inject = ["$log"]),
          t.A.directive("removeFocus", i),
          (a.default = i);
      },
      3378: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e, a) {
          return {
            link: function () {
              e.buildScrollbar(a.gameListScrollListSelector);
            },
          };
        }
        (i.$inject = ["chatUtility", "playTogetherLayout"]),
          t.A.directive("repeatDone", i),
          (a.default = i);
      },
      7546: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          r = t.n(i),
          t = t(1089);
        function n(t, e) {
          return {
            restrict: "A",
            replace: !0,
            templateUrl: e.templates.selectFriendsTemplate,
            link: function (e) {
              function a() {
                r().isUndefined(e.dialogData) ||
                  r().isUndefined(e.dialogData.selectedUserIds) ||
                  (e.dialogData.dialogType === t.dialogType.NEWGROUPCHAT
                    ? (e.dialogLayout.inviteBtnDisabled =
                        e.dialogData.selectedUserIds.length < 2)
                    : (e.dialogLayout.inviteBtnDisabled =
                        0 === e.dialogData.selectedUserIds.length));
              }
              a(),
                e.$watch(
                  function () {
                    return e.dialogData && e.dialogData.selectedUserIds;
                  },
                  function () {
                    a();
                  },
                  !0,
                );
            },
          };
        }
        (n.$inject = ["chatUtility", "resources"]),
          t.A.directive("selectFriends", n),
          (a.default = n);
      },
      9634: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          o = t.n(i),
          t = t(1089);
        function r(n, e) {
          return {
            restrict: "A",
            link: function (i, e) {
              var r = i.chatLibrary.layout.topBarHeight;
              i.$watch(
                function () {
                  return e.innerHeight();
                },
                function (e, a) {
                  var t;
                  e &&
                    e !== a &&
                    ((t = "#" + i.dialogData.layoutId + " .dialog-container"),
                    (a =
                      "#" +
                      i.dialogData.layoutId +
                      " " +
                      i.friendsScrollbarElm),
                    (t = o().element(t)),
                    (a = o().element(a)),
                    (e = r + i.chatLibrary.layout.detailsActionHeight + e),
                    i.dialogData.dialogType === n.dialogType.NEWGROUPCHAT &&
                      (e += i.chatLibrary.layout.detailsInputHeight),
                    (e = t.height() - e),
                    a.css("height", e),
                    a.mCustomScrollbar("update"));
                },
                !0,
              );
            },
          };
        }
        (r.$inject = ["chatUtility", "$log"]),
          t.A.directive("selectFriendsResize", r),
          (a.default = r);
      },
      2657: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e, a) {
          return {
            restrict: "A",
            replace: !0,
            scope: !0,
            templateUrl: e.templates.systemMessage,
            link: function (e) {
              e.messageHelper = a;
            },
          };
        }
        (i.$inject = ["resources", "messageHelper"]),
          t.A.directive("systemMessage", i),
          (a.default = i);
      },
      3502: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          p = t.n(i),
          t = t(1089);
        function r(e, g) {
          return {
            restrict: "A",
            replace: !0,
            scope: !0,
            link: function (i, e) {
              var a = i.dialogLayout.togglePopoverParams,
                r = a.dialogSelector,
                t = a.triggerSelector,
                n = a.pinIconClassName,
                o = a.dialogTriggerClassSelector,
                s = a.isExclusiveClickSelector || "is-exclusive-click";
              function c() {
                g.on("click", function (e) {
                  e.stopPropagation();
                  var a,
                    t = p().element(e.target);
                  l(t) ||
                    ((a = t),
                    (e = p().element(r)).find(a) && 0 < e.find(a).length) ||
                    (function (e) {
                      var a = !1;
                      !(function (e) {
                        return e.hasClass(n);
                      })(e) ||
                        (a =
                          (i.dialogData.playTogetherIds &&
                            0 < i.dialogData.playTogetherIds.length) ||
                          i.dialogData.pinGame);
                      !(function (e) {
                        var a = p().element(o);
                        return a.is(e) || (a.find(e) && 0 < a.find(e).length);
                      })(e) || (a = !0);
                      e.hasClass(s) && (a = !0);
                      return a;
                    })(t) ||
                    (i.dialogLayout.togglePopoverParams.isOpen = !1);
                });
              }
              function l(e) {
                var a = p().element(t);
                return a.is(e) || (a.find(e) && 0 < a.find(e).length);
              }
              e.on("click", function (e) {
                l(p().element(e.target)) &&
                  (i.dialogLayout.togglePopoverParams.isOpen =
                    !i.dialogLayout.togglePopoverParams.isOpen);
              });
              var d = i.$watch(
                  function () {
                    return i.dialogData.playTogetherIds;
                  },
                  function (e, a) {
                    e !== a &&
                      e &&
                      0 < e.length &&
                      (i.dialogLayout.togglePopoverParams.isOpen ||
                        (i.dialogLayout.togglePopoverParams.isOpen = !0));
                  },
                  !0,
                ),
                u = i.$watch(
                  function () {
                    return i.dialogLayout.togglePopoverParams.isFirstTimeOpen;
                  },
                  function (e, a) {
                    e && c();
                  },
                  !0,
                );
              i.$on("$destroy", function () {
                d(), u();
              });
            },
          };
        }
        (r.$inject = ["$log", "$document"]),
          t.A.directive("togglePopover", r),
          (a.default = r);
      },
      5823: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            restrict: "A",
            replace: !0,
            scope: !0,
            templateUrl: e.templates.userConversationInfoTemplate,
          };
        }
        (i.$inject = ["resources"]),
          t.A.directive("userConversationInfo", i),
          (a.default = i);
      },
      365: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(1089),
          s = t(7577);
        function r(e, a, o) {
          var t = window.EventTracker;
          return {
            sendEvent: function (e, a) {
              s.EventStream &&
                s.EventStream.SendEventWithTarget(
                  e,
                  "WebChatEventContext",
                  a,
                  s.EventStream.TargetTypes.WWW,
                );
            },
            incrementCounter: function (e) {
              t && t.fireEvent(e);
            },
            getConversationIdForAnalytics: function (e) {
              if ((null == e ? void 0 : e.dialogType) !== a.dialogType.FRIEND)
                return null == e ? void 0 : e.id;
              e = e.id || "unknown-id";
              return "friends:".concat(e);
            },
            sendInterventionEvent: function (e) {
              var a = e.eventType,
                t = e.interventionType,
                i = e.renderedTimestamp,
                r = e.eventId,
                n = e.durationSeconds;
              s.EventStream &&
                ((n = {
                  user_id: parseInt(s.CurrentUser.userId),
                  timestamp_milliseconds: (e = Date.now()),
                  event_type: a,
                  interventionType: t,
                  event_id: r,
                  timeout_duration_seconds: n,
                  placement: "Web",
                }),
                (a !== o.eventTypes.appealClicked &&
                  a !== o.eventTypes.ctaClicked &&
                  a !== o.eventTypes.learnClicked) ||
                  (n.time_to_interact_seconds = (e - i) / 1e3),
                s.EventStream.SendEventWithTarget(
                  o.eventName,
                  o.eventContext,
                  n,
                  s.EventStream.TargetTypes.WWW,
                ));
            },
          };
        }
        (r.$inject = ["$log", "chatUtility", "featureInterventionAnalytics"]),
          i.A.factory("analyticsService", r),
          (a.default = r);
      },
      5577: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e, i, r) {
          return {
            storageDictionary: {
              dialogIdList: "dialogIdList",
              dialogDict: "dialogDict",
              dialogsLayout: "dialogsLayout",
              chatBarLayout: "chatBarLayout",
              chatFriendsListReloadTime: "chatFriendsListReloadTime",
            },
            isStorageDefined: function (e) {
              return void 0 !== window.Storage
                ? this.getFromStorage(e)
                : r.isCookieDefined(e);
            },
            getFromStorage: function (e) {
              return void 0 !== window.Storage
                ? i.getLocalStorage(e)
                : r.retrieveCookie(e);
            },
            updateStorage: function (e, a, t) {
              void 0 !== window.Storage
                ? i.setLocalStorage(e, a)
                : r.updateCookie(e, a, t);
            },
            removeFromStorage: function (e, a) {
              void 0 !== window.Storage
                ? i.removeLocalStorage(e)
                : r.destroyCookie(e, a);
            },
            updateChatFriendsListReloadTime: function (e) {
              this.updateStorage(
                this.storageDictionary.chatFriendsListReloadTime,
                e,
              );
            },
          };
        }
        (i.$inject = ["chatUtility", "localStorageService", "cookieService"]),
          t.A.factory("chatClientStorageUtilityService", i),
          (a.default = i);
      },
      717: function (e, a, t) {
        "use strict";
        t.r(a);
        var r = t(7577),
          t = t(1089);
        function c(e) {
          return (
            (function (e) {
              if (Array.isArray(e)) return i(e);
            })(e) ||
            (function (e) {
              if ("undefined" != typeof Symbol && Symbol.iterator in Object(e))
                return Array.from(e);
            })(e) ||
            (function (e, a) {
              if (!e) return;
              if ("string" == typeof e) return i(e, a);
              var t = Object.prototype.toString.call(e).slice(8, -1);
              "Object" === t && e.constructor && (t = e.constructor.name);
              if ("Map" === t || "Set" === t) return Array.from(e);
              if (
                "Arguments" === t ||
                /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)
              )
                return i(e, a);
            })(e) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.",
              );
            })()
          );
        }
        function i(e, a) {
          (null == a || a > e.length) && (a = e.length);
          for (var t = 0, i = new Array(a); t < a; t++) i[t] = e[t];
          return i;
        }
        function d(e, a, t, i, r, n, o) {
          try {
            var s = e[n](o),
              c = s.value;
          } catch (e) {
            return void t(e);
          }
          s.done ? a(c) : Promise.resolve(c).then(i, r);
        }
        function n(a, e) {
          var t,
            i = Object.keys(a);
          return (
            Object.getOwnPropertySymbols &&
              ((t = Object.getOwnPropertySymbols(a)),
              e &&
                (t = t.filter(function (e) {
                  return Object.getOwnPropertyDescriptor(a, e).enumerable;
                })),
              i.push.apply(i, t)),
            i
          );
        }
        function s(i) {
          for (var e = 1; e < arguments.length; e++) {
            var r = null != arguments[e] ? arguments[e] : {};
            e % 2
              ? n(Object(r), !0).forEach(function (e) {
                  var a, t;
                  (a = i),
                    (e = r[(t = e)]),
                    t in a
                      ? Object.defineProperty(a, t, {
                          value: e,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0,
                        })
                      : (a[t] = e);
                })
              : Object.getOwnPropertyDescriptors
                ? Object.defineProperties(
                    i,
                    Object.getOwnPropertyDescriptors(r),
                  )
                : n(Object(r)).forEach(function (e) {
                    Object.defineProperty(
                      i,
                      e,
                      Object.getOwnPropertyDescriptor(r, e),
                    );
                  });
          }
          return i;
        }
        function o(e, l, o, a, t) {
          var i = function (e) {
            for (var a in e) {
              var t,
                i = e[a],
                r = (i.participants = []);
              for (t in i.participant_user_ids) {
                var n = Object.assign(
                  {},
                  i.user_data[i.participant_user_ids[t]],
                );
                r.push(n);
              }
              (i.initiator = Object.assign({}, i.user_data[i.created_by])),
                (i.hasUnreadMessages = 0 < i.unread_message_count),
                (i.hasDefaultName = !i.name),
                (i.conversationTitle = { titleForViewer: i.name }),
                (i.userPendingStatus = i.user_pending_status),
                (i.participantPendingStatus = i.participant_pending_status),
                (i.moderationType = i.moderation_type),
                (i.osaAcknowledgementStatus = i.osa_acknowledgement_status);
            }
          };
          return {
            apiSets: {},
            setParams: function () {
              var e = r.EnvironmentUrls.chatApi;
              (this.apiSets.markAsReadApi = {
                url: "".concat(e, "/v1/mark-conversations"),
                retryable: !1,
                withCredentials: !0,
              }),
                (this.apiSets.sendMessageApi = {
                  url: "".concat(e, "/v1/send-messages"),
                  retryable: !1,
                  withCredentials: !0,
                }),
                (this.apiSets.getConversationsApi = {
                  url: "".concat(e, "/v1/get-conversations"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.userConversationsApi = {
                  url: "".concat(e, "/v1/get-user-conversations"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.getMessagesApi = {
                  url: "".concat(e, "/v1/get-conversation-messages"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.getUnreadConversationCountApi = {
                  url: "".concat(e, "/v1/get-conversation-metadata"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.getConversationsParticipantsMetadataApi = {
                  url: "".concat(
                    e,
                    "/v1/get-conversations-participants-metadata",
                  ),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.getChatModerationStatuses = {
                  url: "".concat(e, "/v1/get-chat-moderation-statuses"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.startOneToOneConversationApi = {
                  url: "".concat(e, "/v1/create-conversations"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.startGroupConversationApi = {
                  url: "".concat(e, "/v1/create-conversations"),
                  retryable: !1,
                  withCredentials: !0,
                }),
                (this.apiSets.addToConversationApi = {
                  url: "".concat(e, "/v1/add-users"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.removeFromConversationApi = {
                  url: "".concat(e, "/v1/remove-users"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.renameGroupConversationApi = {
                  url: "".concat(e, "/v1/update-conversations"),
                  retryable: !1,
                  withCredentials: !0,
                }),
                (this.apiSets.updateUserTypingStatusApi = {
                  url: "".concat(e, "/v1/update-typing-status"),
                  retryable: !1,
                  withCredentials: !0,
                }),
                (this.apiSets.recordModalSequenceResponseApi = {
                  url: "".concat(e, "/v1/record-modal-sequence-response"),
                  retryable: !0,
                  withCredentials: !0,
                }),
                (this.apiSets.uiPerformanceTrackingApi = {
                  url: "".concat(
                    r.EnvironmentUrls.metricsApi,
                    "/v1/performance/send-measurement",
                  ),
                  retryable: !1,
                  withCredentials: !0,
                });
            },
            getMetaData: function (e) {
              var a =
                  0 < arguments.length && void 0 !== e && e
                    ? s(s({}, t.apiSets.getMetaData), {}, { noCache: !0 })
                    : t.apiSets.getMetaData,
                e = {
                  userId:
                    null !==
                      (e =
                        null === r.CurrentUser || void 0 === r.CurrentUser
                          ? void 0
                          : r.CurrentUser.userId) && void 0 !== e
                      ? e
                      : "",
                };
              return o.httpGet(a, e);
            },
            getUnreadConversationCount: function () {
              return o
                .httpGet(this.apiSets.getUnreadConversationCountApi, null)
                .then(function (e) {
                  return { count: 0 < e.global_unread_message_count ? 1 : 0 };
                });
            },
            getUserConversations: function (e, a) {
              a = { include_user_data: !0, cursor: e, pageSize: a };
              return o
                .httpGet(this.apiSets.userConversationsApi, a)
                .then(function (e) {
                  return i(e.conversations), e;
                });
            },
            getConversations: function (e) {
              e = {
                ids: e,
                include_messages: !0,
                include_participants: !0,
                include_user_data: !0,
              };
              return o
                .httpPost(this.apiSets.getConversationsApi, e)
                .then(function (e) {
                  return i(e.conversations), e.conversations;
                });
            },
            addToConversation: function (e, a) {
              e = { conversation_id: a, user_ids: e };
              return o.httpPost(this.apiSets.addToConversationApi, e);
            },
            removeFromConversation: function (e, a) {
              e = { conversation_id: a, user_ids: [e] };
              return o.httpPost(this.apiSets.removeFromConversationApi, e);
            },
            startOneToOneConversation: function (e) {
              e = {
                conversations: [
                  { type: "one_to_one", participant_user_ids: [e] },
                ],
                include_user_data: !0,
              };
              return o
                .httpPost(this.apiSets.startOneToOneConversationApi, e)
                .then(function (e) {
                  return i(e.conversations), e.conversations[0];
                });
            },
            startGroupConversation: function (e, a) {
              e = {
                conversations: [
                  { type: "group", name: a, participant_user_ids: e },
                ],
                include_user_data: !0,
              };
              return o
                .httpPost(this.apiSets.startGroupConversationApi, e)
                .then(function (e) {
                  return i(e.conversations), e.conversations[0];
                });
            },
            getMessages: function (e, a) {
              if (!e)
                return new Promise(function (e) {
                  return { messages: [] };
                });
              a = { conversation_id: e, cursor: a };
              return o.httpGet(this.apiSets.getMessagesApi, a);
            },
            getAllMessages: function (r) {
              var s,
                n = this;
              return (
                (s = regeneratorRuntime.mark(function e() {
                  var a, t, i;
                  return regeneratorRuntime.wrap(function (e) {
                    for (;;)
                      switch ((e.prev = e.next)) {
                        case 0:
                          (a = null), (t = []);
                        case 2:
                          return (
                            (i = { conversation_id: r, cursor: a }),
                            (e.next = 5),
                            o.httpGet(n.apiSets.getMessagesApi, i)
                          );
                        case 5:
                          (i = e.sent),
                            t.push.apply(t, c(i.messages)),
                            (a = i.next_cursor);
                        case 8:
                          if (a) {
                            e.next = 2;
                            break;
                          }
                        case 9:
                          return e.abrupt("return", { messages: t });
                        case 10:
                        case "end":
                          return e.stop();
                      }
                  }, e);
                })),
                (function () {
                  var e = this,
                    o = arguments;
                  return new Promise(function (a, t) {
                    var i = s.apply(e, o);
                    function r(e) {
                      d(i, a, t, r, n, "next", e);
                    }
                    function n(e) {
                      d(i, a, t, r, n, "throw", e);
                    }
                    r(void 0);
                  });
                })()
              );
            },
            getMessagesByPageSize: function (i, e, r, n, o, s) {
              var c = this;
              this.getMessages(i.id, e, r).then(function (e) {
                var a,
                  t = e.messages;
                t && 0 < t.length
                  ? ((a = 2 * r),
                    t.forEach(function (e) {
                      n.push(e);
                    }),
                    (function (e, a) {
                      if (!e || !e.chatMessages || e.chatMessages.length <= 0)
                        return !1;
                      for (var t = 0; t < a.length; t++)
                        if (a[t].id === e.chatMessages[0].id) return !1;
                      return !0;
                    })(i, t) &&
                    a <= l.dialogParams.pageSizeOfGetMessages &&
                    t.length === r
                      ? c.getMessagesByPageSize(i, e.next_cursor, a, n, o, s)
                      : o(s))
                  : t && 0 === t.length && o(s);
              });
            },
            getConversationsParticipantsMetadata: function (e) {
              e = { conversation_ids: e };
              return o.httpPost(
                this.apiSets.getConversationsParticipantsMetadataApi,
                e,
              );
            },
            getChatModerationStatuses: function (e) {
              e = { ids: e };
              return o.httpPost(this.apiSets.getChatModerationStatuses, e);
            },
            markAsRead: function (e) {
              e = { conversation_ids: [e] };
              return o.httpPost(this.apiSets.markAsReadApi, e);
            },
            sendMessage: function (e, a) {
              a = { conversation_id: e, messages: [{ content: a }] };
              return o
                .httpPost(this.apiSets.sendMessageApi, a)
                .then(function (e) {
                  return { data: e.messages[0] };
                });
            },
            renameGroupConversation: function (e, a) {
              a = { conversations: [{ id: e, name: a }] };
              return o
                .httpPost(this.apiSets.renameGroupConversationApi, a)
                .then(function (e) {
                  var a;
                  return null !==
                    (a =
                      null == e ||
                      null === (a = e.conversations) ||
                      void 0 === a
                        ? void 0
                        : a[0]) && void 0 !== a
                    ? a
                    : {};
                });
            },
            updateUserTypingStatus: function (e) {
              e = { conversation_id: e };
              return o.httpPost(this.apiSets.updateUserTypingStatusApi, e);
            },
            recordModalSequenceResponse: function (e) {
              e = {
                conversation_id: e.conversationId,
                friend_id: e.friendId,
                modal_sequence: e.modalSequence,
                modal_variant: e.modalVariant,
                modal_id: e.modalId,
                action_type: e.actionType,
              };
              return o.httpPost(this.apiSets.recordModalSequenceResponseApi, e);
            },
            sendPerformanceData: function (e, a) {
              a = { featureName: "Chat", measureName: e, value: a };
              return o.httpPost(this.apiSets.uiPerformanceTrackingApi, a);
            },
          };
        }
        (o.$inject = [
          "$q",
          "chatUtility",
          "httpService",
          "$log",
          "apiParamsInitialization",
        ]),
          t.A.factory("chatService", o),
          (a.default = o);
      },
      6611: function (e, a, t) {
        "use strict";
        t.r(a);
        var v = t(7577),
          i = t(127),
          f = t.n(i),
          t = t(1089);
        function r(o, e, c, a, t, i, r, n, s, l, d, u, g, p) {
          function h(e) {
            return f().isDefined(v.Linkify) &&
              "function" == typeof v.Linkify.String
              ? v.Linkify.String(e.escapeHTML())
              : e;
          }
          function y(e) {
            e = e.match(g.gameCardRegexs.privateServerLinkCode);
            if (e && 2 == e.length) return { privateServerLinkCode: e[1] };
          }
          function m(e, a) {
            return { content: e, isEmoji: a };
          }
          return {
            linksLibrary: f().copy(d.linksLibrary),
            chatLayout: f().copy(d.chatLayout),
            chatApiParams: f().copy(u.chatApiParams),
            dialogParams: f().copy(u.dialogParams),
            dialogLayoutResetConstant: f().copy(c.dialogLayoutResetConstant),
            dialogLayout: f().copy(c.dialogLayout),
            dialogBannerTypes: f().copy(c.dialogBannerTypes),
            userPresenceTypes: f().copy(r.userPresenceTypes),
            dialogType: f().copy(c.dialogTypes),
            newGroup: f().copy(c.newGroup),
            scrollBarType: f().copy(c.scrollBarTypes),
            errorMessages: f().copy(d.errors),
            pendingStatus: f().copy(c.pendingStatus),
            moderationType: f().copy(c.moderationType),
            osaAcknowledgementStatus: f().copy(c.osaAcknowledgementStatus),
            dialogInitValue: f().copy(c.dialogInitValue),
            dialogStatus: f().copy(c.dialogStatus),
            conversationInitStatus: f().copy(c.conversationInitStatus),
            conversationType: f().copy(c.conversationType),
            conversationSource: f().copy(c.conversationSource),
            messageSenderType: f().copy(c.messageSenderType),
            modalSequence: f().copy(c.modalSequence),
            modalVariant: f().copy(c.modalVariant),
            modalActionType: f().copy(c.modalActionType),
            notificationsName: a,
            channelsNotificationType: t,
            notificationType: i,
            activeType: f().copy(c.activeType),
            performanceMarkLabels: s.chat,
            resultType: { SUCCESS: "success", MODERATED: "moderated" },
            sendMessageErrorCode: n.sendMessageErrorCode,
            linkCardTypes: f().copy(g.linkCardTypes),
            eventStreamParams: f().copy(l.eventStreamParams),
            urlParamNames: f().copy(l.urlParamNames),
            getChatDisabledReasonsByPriority: function (e) {
              if (!e || !e.chatLayout) return ["CHAT_DISABLED_REASON_UNKNOWN"];
              var a = [];
              return (
                e.isWebChatRegionalityEnabled &&
                  !e.chatLayout.isChatEnabledByRegion &&
                  a.push("CHAT_DISABLED_REASON_REGION"),
                e.chatLayout.isChatEnabledByPrivacySetting ||
                  a.push("CHAT_DISABLED_REASON_PRIVACY_SETTING"),
                e.chatLayout.isChatEnabled ||
                  a.push("CHAT_DISABLED_REASON_UNKNOWN"),
                a
              );
            },
            getIsChatEnabled: function (e) {
              return 0 === this.getChatDisabledReasonsByPriority(e).length;
            },
            getIsGroupChatEnabled: function (e) {
              var a;
              return e.isWebChatSettingsMigrationEnabled
                ? this.getIsChatEnabled(e) &&
                    (null === (a = e.chatLayout) || void 0 === a
                      ? void 0
                      : a.isGroupChatEnabled)
                : this.getIsChatEnabled(e);
            },
            hashOutContent: function (e) {
              return e && e.replace(/\S/g, "#");
            },
            buildScrollbar: function (e) {
              f()
                .element(document.querySelector(e))
                .mCustomScrollbar({
                  autoExpandScrollbar: !1,
                  scrollInertia: 1,
                  contentTouchScroll: 1,
                  mouseWheel: { preventDefault: !0 },
                });
            },
            updateScrollbar: function (e) {
              f().element(document.querySelector(e)).mCustomScrollbar("update");
            },
            htmlEntities: function (e) {
              return String(e)
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;");
            },
            getAssetDetails: y,
            buildLinkCard: function (e) {
              var a,
                t,
                i = h(e),
                r = { content: i, isCard: !1 },
                n = g.messageRegexs;
              for (a in n)
                n.hasOwnProperty(a) &&
                  ((t = n[a]),
                  (t = e.match(t)) &&
                    2 === t.length &&
                    (r = {
                      id: t[1],
                      type: a,
                      isCard: !0,
                      content: i,
                      assetDetails: y(e),
                    }));
              return this.buildEmojiPieces(r), r;
            },
            buildEmojiPieces: function (e) {
              e.pieces = [];
              for (
                var a = e.content,
                  t = g.emojiRegex,
                  i = g.zwjRegex,
                  r = g.emojiRepRegex,
                  n = "",
                  o = !1,
                  s = 0;
                null !== (l = t.exec(a));

              ) {
                var c = l.index,
                  l = l[0];
                s !== c
                  ? (n && e.pieces.push(m(n, !0)),
                    e.pieces.push(m(a.slice(s, c), !1)),
                    (n = l))
                  : null != l.match(i)
                    ? ((n += "&zwj;"), (o = !0))
                    : o || null != l.match(r)
                      ? ((n += l), (o = !1))
                      : (n && e.pieces.push(m(n, !0)), (n = l)),
                  (s = t.lastIndex);
              }
              n && e.pieces.push(m(n, !0)),
                s < a.length && e.pieces.push(m(a.slice(s), !1));
            },
            buildLinkCardMessages: function (e) {
              var a = e.parsedContent;
              if (a && 0 < a.length) {
                var t = a.split(g.urlRegex);
                if (!t) return (e.hasLinkCard = !1);
                e.linkCardMessages = [];
                for (var i = 0; i < t.length; i++) {
                  var r = t[i],
                    n = null;
                  r.match(g.urlRegex)
                    ? (n = this.buildLinkCard(r))
                    : r &&
                      0 < r.length &&
                      !r.match(g.onlyNewLineRegex) &&
                      ((n = {
                        content: (r = h(
                          (r = r.replace(g.removeNewLineRegex, "")),
                        )),
                        isCard: !1,
                      }),
                      this.buildEmojiPieces(n)),
                    n && e.linkCardMessages.push(n);
                }
              }
              return !0;
            },
            sortFriendList: function (t, e) {
              var a = o("orderBy"),
                i = [],
                r = [],
                n = [];
              return (
                t.friendIds.forEach(function (e) {
                  var a = t.friendsDict[e];
                  (0 < (a && a.presence ? a.presence : a).userPresenceType
                    ? i
                    : r
                  ).push(a),
                    n.push(e);
                }),
                f().forEach(e, function (e) {
                  n.indexOf(e.id) < 0 &&
                    (0 < (e && e.presence ? e.presence : e).userPresenceType
                      ? i
                      : r
                    ).push(e),
                    t.friendIds.indexOf(e.id) < 0 && t.friendIds.push(e.id);
                }),
                (i = a(i, "+name")),
                (r = a(r, "+name")),
                (e = i.concat(r))
              );
            },
            getScrollBarSelector: function (e, a) {
              var t = e.layoutId;
              switch ((f().isUndefined(a) && (a = e.scrollBarType), a)) {
                case c.scrollBarTypes.FRIENDSELECTION:
                  return "#scrollbar_friend_" + e.dialogType + "_" + t;
                case c.scrollBarTypes.MESSAGE:
                default:
                  return "#scrollbar_" + e.dialogType + "_" + t;
              }
            },
            hasLinkifyContent: function (e) {
              return (
                f().isString(e) &&
                0 <= e.search("<a") &&
                0 <= e.search("href=") &&
                0 <= e.search("text-link")
              );
            },
            sanitizeMessage: function (e) {
              var a, t;
              e &&
                e.content &&
                ((a = e.content),
                (t = e.content),
                (e.content = h(e.content)),
                t !== e.content
                  ? ((e.parsedContent = a),
                    (e.hasLinkCard = !0),
                    (e.hasLinkifyMessage = this.hasLinkifyContent(e.content)),
                    this.buildLinkCardMessages(e))
                  : this.buildEmojiPieces(e));
            },
            sanitizeMessages: function (e) {
              if (e && 0 < e.length)
                for (var a = 0; a < e.length; a++) {
                  var t = e[a];
                  this.sanitizeMessage(t);
                }
            },
            updateConversationTitle: function (e, a) {
              (e.title = a), (e.name = a);
            },
            updateDialogStyle: function (e, a, t) {
              var i = a.defaultStyle;
              i &&
                i.inputStyle &&
                this.setResizeInputLayout(t, i.inputStyle.height, e, a);
            },
            setResizeInputLayout: function (e, a, t, i) {
              var r = e.layout,
                n = r.topBarHeight,
                e =
                  ((e = a),
                  (a = i).maxHeightOfTextInput < e ? a.maxHeightOfInput : e),
                n =
                  (r.bannerHeight,
                  i.renameEditor.isEnabled
                    ? (r.renameEditorHeight, n + e + r.renameEditorHeight)
                    : n + e),
                r = r.dialogHeight - n + "px",
                n = c.dialogLayoutResetConstant.paddingOfInput / 2;
              (i.defaultStyle.dialogStyle = { height: r }),
                (i.defaultStyle.inputStyle = { height: e }),
                (i.defaultStyle.inputTextStyle = { "padding-top": n });
            },
            calculateRightPosition: function (e, a) {
              for (
                var t =
                    this.chatLayout.widthOfDialog +
                    this.chatLayout.spaceOfDialog,
                  i =
                    this.chatLayout.widthOfCollapsedDialog +
                    this.chatLayout.spaceOfDialog,
                  r = 0,
                  n = 0;
                n < a;
                n++
              ) {
                var o,
                  s = e.dialogIdList[n];
                r += (
                  (null === (o = e.dialogsLayout) || void 0 === o
                    ? void 0
                    : o[s]) || f().copy(c.dialogLayout)
                ).collapsed
                  ? i
                  : t;
              }
              return r;
            },
            updateDialogsPosition: function (e) {
              for (
                var a = e.chatLayout, t = a.widthOfChat, i = 0;
                i < e.dialogIdList.length;
                i++
              ) {
                var r = "#" + e.dialogIdList[i],
                  n = f()
                    .element(document.querySelector(r))
                    .find(this.dialogLayout.dialogContainerClass),
                  r = +t + this.calculateRightPosition(e, i) + a.spaceOfDialog;
                n.css("right", r);
              }
              0 < e.minimizedDialogIdList.length &&
                (e.chatLayout.areDialogsUpdated = !0);
            },
            updateFocusedDialog: function (e, a) {
              p.debug(" ------ focused layoutId ------ " + a),
                (e.chatLayout.focusedLayoutId = a);
            },
            invalidateLinkCardsInMessageDict: function (e, t) {
              e.forEach(function (e) {
                var a;
                t[(a = e)].linkCardMessages.forEach(function (e) {
                  a === e.id && (e.isCard = !1);
                });
              });
            },
            invalidatePlaceDetails: function (a, e) {
              e.forEach(function (e) {
                a.placesLibrary[e] || (a.placesLibrary[e] = {}),
                  (a.placesLibrary[e] = { isInvalid: !0 });
              });
            },
            isPlaceDetailQualifiedInLibrary: function (e, a) {
              return e[a] && e[a].reasonProhibited;
            },
            shouldScrollFromTop: function (e, a) {
              return (
                a.useOneToOneOsaContextCards &&
                e.osaAcknowledgementStatus ===
                  this.osaAcknowledgementStatus.UNACKNOWLEDGED
              );
            },
          };
        }
        (r.$inject = [
          "$filter",
          "$window",
          "dialogAttributes",
          "notificationsName",
          "channelsNotificationType",
          "notificationType",
          "presenceLayout",
          "httpResponse",
          "performanceMarkLabels",
          "resources",
          "libraryInitialization",
          "apiParamsInitialization",
          "messageHelper",
          "$log",
        ]),
          t.A.factory("chatUtility", r),
          (a.default = r);
      },
      6278: function (e, a, t) {
        "use strict";
        t.r(a);
        var r = t(7577),
          i = t(127),
          c = t.n(i),
          t = t(1089);
        function n(e, t, i) {
          function o(e, a) {
            return (
              (i = a)[(t = e)] &&
              c().isDefined(i[t].avatarHeadshot) &&
              (a = a)[(e = e)] &&
              c().isDefined(a[e].userPresenceType)
            );
            var t, i;
          }
          function s(e) {
            var a;
            return (
              e.conversationUniverse &&
                ((a = {
                  rootPlaceId: e.conversationUniverse.rootPlaceId,
                  universeId: e.conversationUniverse.universeId,
                  actorUsername: r.CurrentUser.name,
                  userId: parseInt(r.CurrentUser.userId),
                }),
                t.setPinGameData(e, a)),
              e
            );
          }
          return {
            buildPinGameInConversation: s,
            getUserIdsNotInFriendsDict: function (e, r) {
              var a,
                t,
                n = [];
              return (
                e &&
                  0 < e.length &&
                  ((a = i.conversationType),
                  (t = i.dialogTypes),
                  e.forEach(function (e) {
                    (e.isGroupChat = e.type === a.multiUserConversation),
                      c().forEach(e.participants, function (e) {
                        var a,
                          t,
                          i = e.id;
                        n.indexOf(i) < 0 && !o(i, r) && n.push(i),
                          r[i] ||
                            ((a = e.name),
                            (t = e.display_name),
                            (e = e.combined_name),
                            (r[i] = {
                              id: i,
                              name: a,
                              display_name: t,
                              nameForDisplay: e || t || a,
                            }));
                      }),
                      e.dialogType ||
                        (e.dialogType = e.isGroupChat ? t.GROUPCHAT : t.CHAT),
                      s(e);
                  })),
                n
              );
            },
          };
        }
        (n.$inject = ["$log", "pinGameService", "dialogAttributes"]),
          t.A.factory("conversationsUtility", n),
          (a.default = n);
      },
      2104: function (e, a, t) {
        "use strict";
        t.r(a),
          t.d(a, {
            default: function () {
              return o;
            },
          });
        var a = jQuery,
          i = t.n(a),
          a = t(127),
          r = t.n(a),
          t = t(1089);
        function n(e) {
          return {
            isCookieDefined: function (e) {
              return r().isDefined(i().cookie(e)) && i().cookie(e);
            },
            updateCookie: function (e, a, t) {
              i().cookie(e, JSON.stringify(a), t);
            },
            retrieveCookie: function (e) {
              return this.isCookieDefined(e) ? JSON.parse(i().cookie(e)) : [];
            },
            destroyCookie: function (e, a) {
              i().cookie(e, null, a);
            },
          };
        }
        (n.$inject = ["$log"]), t.A.factory("cookieService", n);
        var o = n;
      },
      5219: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(l) {
          return {
            start: function (o, s) {
              var c = {};
              return (
                (function t() {
                  var e = Date.now(),
                    a = o - e;
                  if (a <= 0) return s(0), void delete c.timeout;
                  var i = a % 1e3,
                    r = Math.ceil(a / 1e3),
                    n = e + i;
                  s(r);
                  e = function e() {
                    var a = Date.now() - n;
                    1e3 < a
                      ? t()
                      : ((n += 1e3),
                        s(--r),
                        r <= 0
                          ? delete c.timeout
                          : (c.timeout = l(e, Math.max(0, 1e3 - a))));
                  };
                  c.timeout = l(e, i);
                })(),
                c
              );
            },
            cancel: function (e) {
              l.cancel(null == e ? void 0 : e.timeout),
                null == e || delete e.timeout;
            },
            format: function (e) {
              var a = Math.floor(e / 3600),
                t = Math.floor((e % 3600) / 60),
                e = e % 60;
              return (
                0 < a
                  ? "".concat(a, ":").concat(String(t).padStart(2, "0"), ":")
                  : "".concat(t, ":")
              ).concat(String(e).padStart(2, "0"));
            },
          };
        }
        (i.$inject = ["$timeout"]),
          t.A.factory("countdownTimerService", i),
          (a.default = i);
      },
      380: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          var a = e,
            t = { default: -1, member: 0, game: 1 },
            i = {
              INIT: 0,
              OPEN: 1,
              REPLACE: 2,
              MINIMIZE: 3,
              COLLAPSE: 4,
              REMOVE: 5,
              REFRESH: 6,
            },
            r = {
              maxHeightOfTextInput: 64,
              maxHeightOfInput: 80,
              maxHeightOfDisabledInput: 48,
              paddingOfInput: 16,
              typing: {
                isTypingAsSender: !1,
                lastTimeTypingAsSender: null,
                isTypingFromSender: !1,
                lastTimeReceiveTypingEvent: null,
                lastTimeReceiveTimer: null,
                userIds: [],
                userTypingDict: {},
              },
              hoverOnCollapsed: !1,
              memberDisplay: {
                limitNumber: 3,
                defaultLimit: 3,
                isAll: !1,
                linkName: a.get("Label.SeeMore"),
                seeMoreLink: a.get("Label.SeeMore"),
                seeLessLink: a.get("Label.SeeLess"),
                toastText: function (e) {
                  return a.get("Message.ToastText", { friendNum: e });
                },
                timeoutToast: 5e3,
              },
              playTogetherButton: {
                buttonType: null,
                isPlayButtonDisabled: !1,
              },
              togglePopoverParams: {
                isOpen: !1,
                dialogSelector: "",
                triggerSelector: "",
                dialogSelectorPrefix: "#dialog-container-",
                popoverTriggerSelectorPrefix: "#play-together-",
                pinIconClassName: "pin-icon",
                dialogTriggerClassSelector: "",
                dialogTriggerClassPrefix: ".chat-friend-",
                isFirstTimeOpen: !1,
              },
              layoutId: null,
            },
            e = {
              FRIEND: -1,
              CHAT: 0,
              GROUPCHAT: 1,
              NEWGROUPCHAT: 2,
              ADDFRIENDS: 6,
            };
          return {
            activeType: { NEWMESSAGE: "New message" },
            conversationInitStatus: { remove: !1 },
            conversationType: {
              oneToOneConversation: "one_to_one",
              multiUserConversation: "group",
            },
            conversationSource: { FRIENDS: "friends", CHANNELS: "channels" },
            dialogBannerTypes: t,
            dialogInitValue: {
              isUpdated: !0,
              updateStatus: i.INIT,
              markAsActive: !1,
              activeType: null,
              autoOpen: !1,
            },
            dialogLayout: {
              lookUpMembers: !1,
              focusMeEnabled: !0,
              hasFocus: !1,
              isFocused: !1,
              active: !1,
              isChatLoading: !1,
              collapsed: !1,
              isMembersOverloaded: !1,
              scrollToBottom: !1,
              IsdialogContainerVisible: !1,
              inviteBtnDisabled: !0,
              limitMemberDisplay: 6,
              heightOfInput: 32,
              maxHeightOfTextInput: r.maxHeightOfTextInput,
              maxHeightOfInput: r.maxHeightOfInput,
              maxHeightOfDisabledInput: r.maxHeightOfDisabledInput,
              paddingOfInput: r.paddingOfInput,
              limitCharacterCount: 160,
              heightOfBanner: 40,
              templateUrl: "chat-dialog",
              scrollbarElm: null,
              listenToScrollInitialized: !1,
              isBannerEnabled: !1,
              renameEditor: { isEnabled: !1, hasFocus: !1 },
              bannerType: t.default,
              confirmDialog: { isOpen: !1, title: "", btnName: "", type: "" },
              typing: r.typing,
              dialogContainerClass: ".dialog-container",
              hoverOnCollapsed: !1,
              details: {
                isEnabled: !1,
                isConversationTitleEditorEnabled: !1,
                isAddFriendsEnabled: !1,
                isNegativeConfirmationEnabled: !1,
                friendMenuAction: {},
                friendIdForMenuOn: null,
              },
              memberDisplay: r.memberDisplay,
              playTogetherButton: r.playTogetherButton,
              togglePopoverParams: r.togglePopoverParams,
            },
            dialogLayoutResetConstant: r,
            dialogStatus: i,
            dialogTypes: e,
            pendingStatus: {
              INVALID: "invalid",
              PENDING: "pending",
              NOT_PENDING: "not_pending",
            },
            moderationType: {
              TRUSTED_COMMS: "trusted_comms",
              MODERATED: "moderated",
              INVALID: "invalid",
              UNKNOWN_TYPE: "unknown_type",
            },
            osaAcknowledgementStatus: {
              ACKNOWLEDGED: "acknowledged",
              UNACKNOWLEDGED: "unacknowledged",
              NOT_APPLICABLE: "not_applicable",
            },
            messageSenderType: { SYSTEM: "system", USER: "user" },
            negativeAction: {
              removeUser: {
                title: a.get("Heading.RemoveUser"),
                headerTitle: a.get("Heading.RemoveUser"),
                btnName: a.get("Action.Remove"),
                cancelBtnName: a.get("Action.Cancel"),
                type: "removeUser",
              },
              leaveChatGroup: {
                title: a.get("Heading.ConfirmLeaving"),
                headerTitle: a.get("Heading.LeaveChatGroup"),
                btnName: a.get("Action.Leave"),
                cancelBtnName: a.get("Action.Stay"),
                type: "leaveChatGroup",
              },
            },
            newGroup: {
              dialogType: e.NEWGROUPCHAT,
              layoutId: "newGroup",
              title: a.get("Heading.NewChatGroup"),
            },
            scrollBarTypes: { MESSAGE: 0, FRIENDSELECTION: 1 },
            systemMessage: { isSystemMessage: !0, isErrorMsg: !1 },
            modalSequence: {
              CONVERSATION_INLINE_TOP_MODAL: "conversation_inline_top_modal",
            },
            modalVariant: { OSA_CONTEXT_CARD: "osa_context_card" },
            modalActionType: {
              RECORD_HAS_SEEN: "record_has_seen",
              RECORD_DONT_SHOW_AGAIN: "record_dont_show_again",
            },
          };
        }
        (i.$inject = ["languageResource"]),
          t.A.factory("dialogAttributes", i),
          (a.default = i);
      },
      3214: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          t = t(1089);
        function r(e, t, a) {
          return {
            getAllOnlineFriends: function (e) {
              return t.httpGet({
                url: ""
                  .concat(i.EnvironmentUrls.friendsApi, "/v1/users/")
                  .concat(e, "/friends/online"),
                retryable: !0,
                withCredentials: !0,
              });
            },
            getPaginatedFriends: function (e, a) {
              a = { cursor: a };
              return t.httpGet(
                {
                  url: ""
                    .concat(i.EnvironmentUrls.friendsApi, "/v1/users/")
                    .concat(e, "/friends/find"),
                  retryable: !0,
                  withCredentials: !0,
                },
                a,
              );
            },
            searchFriends: function (e, a) {
              a = { query: a };
              return t.httpGet(
                {
                  url: ""
                    .concat(i.EnvironmentUrls.friendsApi, "/v1/users/")
                    .concat(e, "/friends/search"),
                  retryable: !0,
                  withCredentials: !0,
                },
                a,
              );
            },
          };
        }
        (r.$inject = ["$q", "httpService", "$log"]),
          t.A.factory("friendsService", r),
          (a.default = r);
      },
      3943: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          var i = e;
          return {
            playButtonTypes: {
              play: "play",
              join: "join",
              buy: "buy",
              details: "details",
              notAvailable: "notAvailable",
            },
            playButtons: {
              play: {
                type: "play",
                text: i.get("Label.PlayButton"),
                className: "btn-primary-xs btn-growth-xs",
                isPlayable: !0,
              },
              join: {
                type: "join",
                text: i.get("Label.JoinButton"),
                className: "btn-primary-xs btn-growth-xs",
                isPlayable: !0,
              },
              buy: {
                type: "buy",
                text: i.get("Label.BuyButton"),
                className: "btn-control-xs",
                isPlayable: !1,
              },
              details: {
                type: "details",
                text: i.get("Label.ViewDetailsButton"),
                className: "btn-control-xs",
                isPlayable: !1,
              },
              notAvailable: {
                type: "notAvailable",
                text: i.get("Label.GameNotAvailableButton"),
                isPlayable: !1,
              },
            },
            buyAccess: {
              title: i.get("Heading.BuyItem"),
              yesButtonText: i.get("Action.BuyAccess"),
              yesButtonClass: "btn-primary-xs btn-growth-xs",
              noButtonText: i.get("Action.Cancel"),
              bodyText: function (e, a, t) {
                (e = "<span class='font-bold'>".concat(e, "</span>")),
                  (t =
                    "<span class='icon-robux-16x16'></span><span class='text-robux'>".concat(
                      t,
                      "</span>",
                    ));
                return i.get("Label.BuyAccessToGameForModal", {
                  placeName: e,
                  creatorName: a,
                  robux: t,
                });
              },
            },
          };
        }
        (i.$inject = ["languageResource"]),
          t.A.factory("gameLayout", i),
          (a.default = i);
      },
      737: function (e, a, t) {
        "use strict";
        t.r(a);
        var r = t(7577),
          i = t(127),
          h = t.n(i),
          t = t(1089);
        function n(s, t, e, i, a, c, o, l, d) {
          var n = {};
          function u(i, r) {
            var e = { placeIds: i };
            return t.httpGet(n.multiGetPlaceDetails, e).then(function (e) {
              if (e && 0 < e.length) {
                var a = {};
                e.forEach(function (e) {
                  a[e.placeId] = e;
                });
                var t = [];
                return (
                  i.forEach(function (e) {
                    a[e] || ((a[e] = null), t.push(e));
                  }),
                  r.forEach(function (e) {
                    e &&
                      e.linkCardMessages &&
                      e.linkCardMessages.forEach(function (e) {
                        e.isCard && -1 < t.indexOf(e.id) && (e.isCard = !1);
                      });
                  }),
                  a
                );
              }
            });
          }
          function g(r, e, n) {
            h().forEach(e, function (e, t) {
              if (e) {
                var a;
                r.placesLibrary[t] && (a = r.placesLibrary[t]);
                var i = e.creatorName || e.builder;
                if (
                  ((r.placesLibrary[t] = {
                    universeId: e.universeId,
                    placeId: t,
                    rootPlaceId:
                      e.universeRootPlaceId || e.placeId || e.rootPlaceId,
                    placeName: e.name,
                    encodedPlaceName: s.htmlEntities(e.name),
                    creatorName: i,
                    encodedCreatorName: s.htmlEntities(i),
                    creatorId: e.creatorId || e.builderId,
                    gameIconUrl: e.gameIconUrl,
                    placeUrl: e.url || e.placeUrl,
                    reasonProhibited: e.reasonProhibited,
                    description: e.description,
                    price: e.price,
                    isPlayable: e.isPlayable,
                    gameReferralUrl: e.gameReferralUrl,
                  }),
                  a &&
                    h().forEach(a, function (e, a) {
                      r.placesLibrary[t][a] || (r.placesLibrary[t][a] = e);
                    }),
                  e.reasonProhibited)
                )
                  switch (e.reasonProhibited) {
                    case c.reasonProhibitedMessage.None:
                    case c.reasonProhibitedMessage.Playable:
                      r.placesLibrary[t].buttonLayoutForLinkCard = h().copy(
                        o.playButtons.play,
                      );
                      break;
                    case c.reasonProhibitedMessage.PurchaseRequired:
                    default:
                      r.placesLibrary[t].buttonLayoutForLinkCard = h().copy(
                        o.playButtons.details,
                      );
                  }
                r.universeLibrary[e.universeId] = r.placesLibrary[t];
              } else
                !e &&
                  r.placesLibrary[t] &&
                  ((r.placesLibrary[t] = { isInvalid: !0 }),
                  n && s.invalidateLinkCardInPieceOfMessage(t, n));
            });
          }
          function p(a, e) {
            e.forEach(function (e) {
              a.placesLibrary[e] || (a.placesLibrary[e] = {}),
                (a.placesLibrary[e] = { isInvalid: !0 });
            });
          }
          return {
            apiSets: n,
            setParams: function (e) {
              (n.multiGetPlaceDetails = {
                url: e + a.gameUrls.multiGetPlaceDetails,
                retryable: !0,
                withCredentials: !0,
              }),
                (n.getGamesByUniverseIds = {
                  url: a.gameUrls.getGamesByUniverseIds,
                  retryable: !0,
                  withCredentials: !0,
                }),
                (n.multiGetPlayabilityStatus = {
                  url: a.gameUrls.multiGetPlayabilityStatus,
                  retryable: !0,
                  withCredentials: !0,
                });
            },
            setConversationUniverse: function (e, a) {
              a = { conversationId: e, universeId: a };
              return t.httpPost(n.setConversationUniverse, a);
            },
            resetConversationUniverse: function (e) {
              e = { conversationId: e };
              return t.httpPost(n.resetConversationUniverse, e);
            },
            multiGetPlaceDetailsForLinkCard: u,
            multiGetPlaceDetails: function (e) {
              return (
                (e = { placeIds: e }),
                t.httpGet(n.multiGetPlaceDetails, e).then(function (e) {
                  var a = {};
                  return (
                    h().forEach(e, function (e) {
                      a[e.placeId] = e;
                    }),
                    a
                  );
                })
              );
            },
            playRegularGame: function (e, a, t, i) {
              (a = !0 === a),
                r.GameLauncher.joinMultiplayerGame(e, !0, a, t, i);
            },
            playTogetherGame: function (e, a, t, i) {
              r.GameLauncher.playTogetherGame(e, a, t, i);
            },
            joinGame: function (e, a, t, i) {
              r.GameLauncher.joinGameInstance(e, a, !0, !0, t, i);
            },
            playPrivateServerGame: function (e, a, t, i) {
              r.GameLauncher.joinPrivateGame(e, null, a, t, i);
            },
            fetchDataForLinkCard: function (e, i) {
              if (!e) return !1;
              var r = [],
                n = {},
                o = [];
              e.forEach(function (t) {
                t.hasLinkCard &&
                  t.linkCardMessages.forEach(function (e) {
                    var a;
                    e.isCard &&
                      e.type === s.linkCardTypes.gameCard &&
                      ((a = e.id),
                      s.isPlaceDetailQualifiedInLibrary(i.placesLibrary, a)
                        ? i.placesLibrary[a] &&
                          i.placesLibrary[a].isInvalid &&
                          (e.isCard = !1)
                        : (o.push(t),
                          r.indexOf(a) < 0 && (r.push(a), (n[a] = t))));
                  });
              }),
                0 < r.length &&
                  u(r, o).then(
                    function (e) {
                      return e
                        ? void g(i, e, n)
                        : (p(i, r),
                          s.invalidateLinkCardsInMessageDict(r, n),
                          !1);
                    },
                    function () {
                      p(i, r), s.invalidateLinkCardsInMessageDict(r, n);
                    },
                  );
            },
            updateButtonLayoutPerConversation: function (e, a) {
              if (
                !e.placeButtonLayout ||
                (e.placeButtonLayout && !e.placeButtonLayout[a].isPlayable)
              )
                return !1;
              e.pinGame &&
              e.playTogetherIds &&
              -1 < e.playTogetherIds.indexOf(a)
                ? (e.placeButtonLayout[a] = h().copy(o.playButtons.join))
                : (e.placeButtonLayout[a] = h().copy(o.playButtons.play));
            },
            buildButtonLayoutPerConversation: function (t, i) {
              var e = [],
                r = null,
                n = !0;
              t.playTogetherIds &&
                0 < t.playTogetherIds.length &&
                (e = h().copy(t.playTogetherIds)),
                t.pinGame &&
                  ((r = t.pinGame.rootPlaceId),
                  e.indexOf(r) < 0 && ((n = !1), e.push(r))),
                t.placeButtonLayout || (t.placeButtonLayout = {}),
                h().forEach(e, function (e) {
                  var a = i[e];
                  if (a)
                    switch (a.reasonProhibited) {
                      case c.reasonProhibitedMessage.None:
                      case c.reasonProhibitedMessage.Playable:
                        t.placeButtonLayout[e] =
                          n || e !== r
                            ? h().copy(o.playButtons.join)
                            : h().copy(o.playButtons.play);
                        break;
                      case c.reasonProhibitedMessage.PurchaseRequired:
                        t.placeButtonLayout[e] = h().copy(
                          o.playButtons.details,
                        );
                        break;
                      default:
                        t.placeButtonLayout[e] = h().copy(
                          o.playButtons.notAvailable,
                        );
                    }
                });
            },
            buildPlacesLibrary: g,
            getGames: function (e) {
              var a = { universeIds: e },
                e = {};
              return (
                (e.getGamesInfo = t.httpGet(n.getGamesByUniverseIds, a)),
                (e.getPlayabilityStatus = t.httpGet(
                  n.multiGetPlayabilityStatus,
                  a,
                )),
                i.all(e).then(function (e) {
                  if (e && e.getGamesInfo && e.getPlayabilityStatus) {
                    var a = e.getGamesInfo.data,
                      r = e.getPlayabilityStatus,
                      n = {},
                      o = {};
                    return (
                      h().forEach(a, function (e, a) {
                        var t = e.rootPlaceId,
                          i = r[a].universeId;
                        (n[t] = e),
                          (n[t].universeId = i),
                          (n[t].placeId = t),
                          (n[t].isPlayable = r[a].isPlayable),
                          (n[t].reasonProhibited = r[a].playabilityStatus),
                          (n[t].placeUrl =
                            ((e = n[t]),
                            (a = l.getAbsoluteUrl(c.gameUrl)),
                            d("formatString")(a, { placeId: e.placeId }))),
                          (o[i] = n[t]);
                      }),
                      n
                    );
                  }
                })
              );
            },
          };
        }
        (n.$inject = [
          "chatUtility",
          "httpService",
          "$log",
          "$q",
          "apiParamsInitialization",
          "gameParameters",
          "gameLayout",
          "urlService",
          "$filter",
        ]),
          t.A.factory("gameService", n),
          (a.default = n);
      },
      2106: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          r = t.n(i),
          t = t(1089);
        function n(e) {
          return {
            isGameExistedInPlacesLibrary: function (e, a) {
              var t = null;
              return (
                r().forEach(e, function (e) {
                  if (e.universeId === a) return (t = e.placeId), !1;
                }),
                t
              );
            },
          };
        }
        (n.$inject = ["$log"]), t.A.factory("gameUtility", n), (a.default = n);
      },
      5152: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          t = t(1089);
        function r(e, a, t) {
          return {
            getChatUiPolicies: function () {
              return a.httpGet({
                url: "".concat(
                  i.EnvironmentUrls.apiGatewayUrl,
                  "/universal-app-configuration/v1/behaviors/chat-ui/content",
                ),
                retryable: !0,
                withCredentials: !0,
              });
            },
            getAppPolicies: function () {
              return a.httpGet({
                url: "".concat(
                  i.EnvironmentUrls.apiGatewayUrl,
                  "/universal-app-configuration/v1/behaviors/app-policy/content",
                ),
                retryable: !0,
                withCredentials: !0,
              });
            },
            getAbuseReportRevampPolicies: function () {
              return a.httpGet({
                url: "".concat(
                  i.EnvironmentUrls.universalAppConfigurationApi,
                  "/v1/behaviors/abuse-reporting-revamp/content",
                ),
                retryable: !0,
                withCredentials: !0,
              });
            },
          };
        }
        (r.$inject = ["$q", "httpService", "$log"]),
          t.A.factory("guacService", r),
          (a.default = r);
      },
      6128: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          t = t(1089);
        function r(e) {
          var a = e,
            e = {
              scrollbarClassName: "#chat-friend-list",
              chatContentSelector: "#chat-main",
              collapsed: !0,
              pageInitializing: !1,
              pageDataLoading: !1,
              chatBarInitialized: !1,
              isChatLoading: !1,
              isFriendsLoading: !1,
              widthOfChatCollapsed: 112,
              widthOfChat: 286,
              widthOfDialog: 260,
              widthOfCollapsedDialog: 160,
              spaceOfDialog: 6,
              widthOfDialogMinimize: 200,
              numberOfDialogOpen: 0,
              defaultChatZIndex: 1060,
              errorMaskEnable: !1,
              isFriendListEmpty: !1,
              isUserConversationEmpty: !1,
              chatLandingEnabled: !1,
              thresholdMobile: 543,
              thresholdChatBarOpen: 1748,
              resizing: !1,
              defaultTitleForMessage: a.get("Message.DefaultTitleForMsg"),
              urlParseInitialized: !1,
              noConnectionMsg: a.get("Message.NoConnectionMsg"),
              isChatEnabledByPrivacySetting: 1,
              focusedDialogId: null,
              areDialogsUpdated: !1,
              maxOpenDialogs: 12,
              conversationTitleChangedText: a.get(
                "Message.conversationTitleChangedText",
              ),
              abuseReportUrl:
                "/abusereport/chat?id={userId}&redirectUrl={location}&conversationId={conversationId}",
            },
            a = {
              default: a.get("Message.DefaultErrorMsg"),
              conversationTitleModerated: a.get(
                "Message.ConversationTitleModerated",
              ),
              messageContentModerated: a.get("Message.MessageContentModerated"),
              messageFilterForReceivers: a.get(
                "Message.MessageFilterForReceivers",
              ),
              textTooLong: a.get("Message.TextTooLong"),
              sendingMessagesTooQuickly: a.get(
                "Message.SendingMessagesTooQuickly",
              ),
              sendMessageConflict: a.get("Message.RefreshChat"),
            };
          return {
            chatLayout: e,
            chatLibrary: {
              chatLayout: e,
              chatLayoutIds: [],
              conversationsDict: {},
              currentTabTitle: null,
              dialogIdList: [],
              dialogDict: {},
              dialogScopeLib: {},
              dialogsLayout: {},
              dialogRequestedToOpenParams: { layoutId: null, autoPop: !1 },
              errors: a,
              friendIds: [],
              friendLayoutIds: [],
              friendsDict: {},
              currentFriendCursor: "",
              isTakeOverOn: angular
                .element(document.querySelector("#wrap"))
                .data("gutter-ads-enabled"),
              layout: {
                bannerHeight: 40,
                playTogetherBannerHeight: 102,
                dialogHeight: 360,
                inputHeight: 32,
                renameEditorHeight: 32,
                searchHeight: 32,
                topBarHeight: 34,
                detailsActionHeight: 48,
                detailsInputHeight: 48,
              },
              layoutIdList: [],
              minimizedDialogIdList: [],
              minimizedDialogData: {},
              userConversationsDict: {},
              allConversationLayoutIdsDict: {},
              placesLibrary: {},
              playTogetherLibrary: {},
              layoutIdsDictPerUserId: {},
              gamesPageLink: "".concat(
                i.EnvironmentUrls.websiteUrl,
                "/discover",
              ),
              isMetaDataLoaded: !1,
              universeLibrary: {},
              voiceChannelMapToConversation: {},
              usePaginatedFriends: !1,
            },
            chatViewModel: { friendsDict: {}, chatUserDict: {} },
            dialogLocalStorageNamePrefix: "dialogLibrary_",
            errors: a,
            linksLibrary: {
              settingTabName: "Settings",
              settingLink: "/my/account#!/privacy",
              trustedCommsLearnMoreLink: "https://help.roblox.com/",
            },
          };
        }
        (r.$inject = ["languageResource"]),
          t.A.factory("libraryInitialization", r),
          (a.default = r);
      },
      184: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          b = t.n(i),
          t = t(1089);
        function r(t, d, u, g, p, n, a, h, o, s, y) {
          var r = 3e4;
          function l(e) {
            e.created_at &&
              !e.parsedTimestamp &&
              (e.parsedTimestamp = new Date(e.created_at).getTime());
          }
          function c(e, a, t) {
            var i = e.parsedTimestamp,
              r = b().isDefined(t) ? t : new Date(),
              n = new Date(r - 864e5),
              o = new Date(i),
              s = o.toDateString(),
              c = Math.round(Math.abs(r.getTime() - o.getTime()) / 864e5),
              l = o.getDay(),
              d = r.getFullYear(),
              t = o.getFullYear(),
              o = "h:mm a";
            r.toDateString() === s
              ? ((r = g("date")(i, o)),
                a ? (e.briefTimeStamp = r) : (e.displayTimeStamp = r))
              : n.toDateString() === s
                ? a
                  ? (e.briefTimeStamp = "Yesterday")
                  : (e.displayTimeStamp = "Yesterday | ".concat(
                      g("date")(i, o),
                    ))
                : c <= l
                  ? a
                    ? ((o = "EEE"), (e.briefTimeStamp = g("date")(i, o)))
                    : ((o = "EEE | ".concat(o)),
                      (e.displayTimeStamp = g("date")(i, o)))
                  : d === t
                    ? a
                      ? ((o = "MMM d"), (e.briefTimeStamp = g("date")(i, o)))
                      : ((o = "MMM d | ".concat(o)),
                        (e.displayTimeStamp = g("date")(i, o)))
                    : a
                      ? ((o = "MMM d, yyyy"),
                        (e.briefTimeStamp = g("date")(i, o)))
                      : ((o = "MMM d, yyyy | " + o),
                        (e.displayTimeStamp = g("date")(i, o)));
          }
          var i,
            m,
            v =
              ((m = !(i = {})),
              {
                queueMessageToMarkRead: function (e) {
                  !(i[e.id] = { conversation: e }) === m &&
                    ((m = !0), a(f, 1e3));
                },
              });
          function f() {
            for (var e in i) {
              var a = i[e];
              t.markAsRead(e).then(
                function (e) {
                  (a.conversation.hasUnreadMessages = !1),
                    u.$broadcast("Roblox.Chat.LoadUnreadConversationCount");
                },
                function () {
                  p.debug("----- markAsRead request is failed ! ------");
                },
              );
            }
            m = !(i = {});
          }
          return {
            setParams: function (e) {
              r = parseInt(e.partyChromeDisplayTimeStampInterval);
            },
            setFallbackClusterMaster: function (e, a) {
              b().isUndefined(e.chatMessages) && (e.chatMessages = []);
              var t = e.chatMessages.length - 1;
              a.displayTimeStamp && (a.isClusterMaster = !0),
                0 < e.chatMessages.length &&
                  e.chatMessages[t].sender_user_id !== a.sender_user_id &&
                  (e.chatMessages[t].isClusterMaster = !0),
                e.chatMessages.push(a);
            },
            setClusterMaster: function (e, a) {
              b().isUndefined(e.chatMessages) && (e.chatMessages = []),
                ((0 < e.chatMessages.length &&
                  e.chatMessages[0].sender_user_id !== a.sender_user_id) ||
                  a.displayTimeStamp) &&
                  (a.isClusterMaster = !0),
                a.resetClusterMessage || e.chatMessages.unshift(a);
            },
            buildFallbackTimeStamp: function (e, a, t) {
              if (!e.created_at) return !1;
              l(e);
              var i = e.parsedTimestamp;
              (!a.startTimeStamp || i + r < a.startTimeStamp) &&
                (c(e, !1, t), (a.startTimeStamp = i));
            },
            buildTimeStamp: function (e, a, t) {
              if (!e.created_at) return !1;
              l(e);
              var i = e.parsedTimestamp;
              return (
                a.previousTimeStamp || (a.startTimeStamp = i),
                (!a.previousTimeStamp || i - r > a.previousTimeStamp) &&
                  (c(e, !1, t), (a.previousTimeStamp = i)),
                !0
              );
            },
            preProcessMessages: function (e, a, t) {
              d.sanitizeMessages(t);
            },
            processMessages: function (e, a, t, i) {
              this.preProcessMessages(e, a, t),
                this.manipulateMessages(a, t, i);
            },
            manipulateMessages: function (e, a, t) {
              if (
                (a || (e.messagesDict = {}),
                b().isUndefined(e.messagesDict) && (e.messagesDict = {}),
                a && 0 < a.length)
              ) {
                var i = a.length,
                  r = [];
                e.previousTimeStamp = null;
                for (var n = i - 1; 0 <= n; n--) {
                  var o = a[n];
                  this.buildTimeStamp(o, e),
                    o.type === d.messageSenderType.SYSTEM &&
                      (o.isSystemMessage = !0),
                    e.messagesDict[o.id] ||
                      ((e.messagesDict[o.id] = o), this.setClusterMaster(e, o)),
                    (c = t),
                    (l = r),
                    (s = o).type === h.messageTypes.user &&
                      c &&
                      !c[s.sender_user_id] &&
                      l.indexOf(s.sender_user_id) < 0 &&
                      ((s = o.sender_user_id),
                      p.debug(
                        " ----- new friend information for this message, trying to get now -----" +
                          s,
                      ),
                      (o = [s]),
                      r.push(s),
                      y.getUserInfo(o, t));
                }
                e.hasUnreadMessages &&
                  u.$broadcast("Roblox.Chat.LoadUnreadConversationCount");
              }
              var s, c, l;
            },
            formatTimestampInConversation: function (e) {
              e.briefTimeStamp ||
                ((e.parsedTimestamp = new Date(e.updated_at).getTime()),
                c(e, !0));
            },
            appendMessages: function (e, a, t) {
              if (!t) return !1;
              if (
                (b().isUndefined(a.messagesDict) && (a.messagesDict = {}),
                d.sanitizeMessages(t),
                a.chatMessages && 0 !== a.chatMessages.length)
              ) {
                if (a.chatMessages) {
                  for (var i = {}, r = 0; r < a.chatMessages.length; r++) {
                    var n = a.chatMessages[r];
                    if (
                      n.id &&
                      !n.sendMessageHasError &&
                      !n.resetClusterMessage
                    ) {
                      l((i = a.chatMessages[r]));
                      break;
                    }
                  }
                  for (r = t.length - 1; 0 <= r; r--) {
                    (c = t[r]).type === d.messageSenderType.SYSTEM &&
                      (c.isSystemMessage = !0),
                      l(c);
                    var o =
                        c.id === i.id ||
                        (i.id &&
                          "string" != typeof i.id &&
                          i.id.toString() === c.id),
                      s =
                        !b().isUndefined(c.id) &&
                        !b().isUndefined(a.messagesDict[c.id]);
                    !(
                      b().equals({}, i) || c.parsedTimestamp > i.parsedTimestamp
                    ) ||
                      o ||
                      s ||
                      (this.buildTimeStamp(c, a),
                      this.setClusterMaster(a, c),
                      (a.messagesDict[c.id] = c).sender_user_id !== e.userId &&
                        c.is_badgeable &&
                        (a.hasUnreadMessages = !0));
                  }
                }
              } else {
                for (var c, r = t.length - 1; 0 <= r; r--)
                  (c = t[r]).type === d.messageSenderType.SYSTEM &&
                    (c.isSystemMessage = !0),
                    this.buildTimeStamp(c, a),
                    this.setClusterMaster(a, c),
                    b().isDefined(c.id) && (a.messagesDict[c.id] = c),
                    c.sender_user_id !== e.userId &&
                      c.is_badgeable &&
                      (a.hasUnreadMessages = !0);
                a.chatMessages = t;
              }
              this.updatePreviewMessage(a, t),
                0 < a.hasUnreadMessages &&
                  u.$broadcast("Roblox.Chat.LoadUnreadConversationCount");
            },
            markMessagesAsRead: function (e, a) {
              e.dialogType !== d.dialogType.FRIEND &&
                (e.chatMessages || a) &&
                e.hasUnreadMessages &&
                v.queueMessageToMarkRead(e);
            },
            buildSystemMessage: function (e, a, t) {
              var i = b().copy(s.systemMessage);
              switch ((o.setSystemMessage(i, t), e)) {
                case d.notificationType.conversationTitleModerated:
                  i.content = d.errorMessages.conversationTitleModerated;
                  break;
                case d.notificationType.conversationTitleChanged:
                  var r = d.htmlEntities(a.name);
                  i.content = g("formatString")(
                    d.chatLayout.conversationTitleChangedText,
                    { userName: a.actorUsername, groupName: r },
                  );
                  break;
                case d.notificationType.conversationUniverseChanged:
                  i.content = n.playTogether.pinGameUpdate(
                    a.pinGame.actorUsername,
                    a.pinGame.encodedPlaceName,
                  );
                  break;
                case d.notificationType.presenceOnline:
                  (i.content = n.playTogether.playGameUpdate),
                    (i.hasParams = !0);
              }
              b().isUndefined(a.messages) && (a.chatMessages = []),
                l(i),
                this.setClusterMaster(a, i);
            },
            resetConversationUnreadStatus: function (e, a) {
              0 === a.length &&
                e.hasUnreadMessages &&
                v.queueMessageToMarkRead(e);
            },
            buildPreviewMessage: function (e, a) {
              var t;
              return (
                d.sanitizeMessage(e),
                (e.previewContent =
                  null !==
                    (t =
                      null !== (t = e.preview_content) && void 0 !== t
                        ? t
                        : e.parsedContent) && void 0 !== t
                    ? t
                    : e.content),
                l(e),
                c(e, !0, a),
                e
              );
            },
            updatePreviewMessage: function (e, a) {
              var t =
                null !== (t = e.previewMessage) && void 0 !== t
                  ? t
                  : e.preview_message;
              !a ||
                ((a = a.find(function (e) {
                  return e.is_previewable;
                })) &&
                  (!t || a.created_at >= t.created_at) &&
                  (t = a)),
                t &&
                  t !== e.previewMessage &&
                  (e.previewMessage = this.buildPreviewMessage(t));
            },
            refreshTypingStatus: function (e, a, t, i) {
              if (
                e &&
                t &&
                e.type === d.conversationType.multiUserConversation
              ) {
                var r = e.chatMessages;
                if (r && 0 < r.length)
                  for (
                    var n = i.typing.userTypingDict[a], o = {}, s = 0;
                    s < r.length;
                    s++
                  ) {
                    var c = r[s];
                    if (
                      c.isClusterMaster &&
                      c.sender_user_id === a &&
                      (!o[a] || o[a].messageId !== c.id)
                    ) {
                      n.messageId = c.id;
                      break;
                    }
                  }
              }
            },
          };
        }
        (r.$inject = [
          "chatService",
          "chatUtility",
          "$rootScope",
          "$filter",
          "$log",
          "systemMessages",
          "$timeout",
          "messageHelper",
          "messageUtility",
          "dialogAttributes",
          "usersService",
        ]),
          t.A.factory("messageService", r),
          (a.default = r);
      },
      8063: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          r = t.n(i),
          t = t(1089);
        function n(e, i, a) {
          return {
            isMessageTypeLegal: function (a) {
              var t = !1;
              return (
                r().forEach(i.messageTypes, function (e) {
                  if (e === a.type) return !(t = !0);
                }),
                t
              );
            },
            setSystemMessage: function (t, e) {
              t
                ? r().forEach(a.systemMessage, function (e, a) {
                    t[a] = e;
                  })
                : (t = r().copy(a.systemMessage)),
                e && (t.isErrorMsg = !0);
              e = new Date();
              t.created_at = e.toISOString();
            },
            hasUnreadMessages: function (e, a) {
              return (
                e.hasUnreadMessages ||
                  a.some(function (e) {
                    return !e.read;
                  }),
                e.hasUnreadMessages
              );
            },
          };
        }
        (n.$inject = ["$log", "messageHelper", "dialogAttributes"]),
          t.A.factory("messageUtility", n),
          (a.default = n);
      },
      5204: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            tooltipForPinGame: e.get("Label.PinGameTooltip"),
            tooltipForUnPinGame: e.get("Label.UnpinGameTooltip"),
            titleForPinGame: e.get("Label.PinnedGame"),
          };
        }
        (i.$inject = ["languageResource"]),
          t.A.factory("pinGameLayout", i),
          (a.default = i);
      },
      7642: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e, i, t, r, n) {
          return {
            sendPinGameEvent: function (e, a, t) {
              t = { placeId: a, conversationId: t.id };
              r.sendEventWithTarget(e, n.eventStreamParams.actions.click, t);
            },
            setPinGameData: function (e, a) {
              var t;
              a && a.universeId
                ? ((t = a.rootPlaceId),
                  (e.pinGame = {
                    universeId: a.universeId,
                    rootPlaceId: t,
                    placeName: a.placeName,
                    encodedPlaceName: a.encodedPlaceName,
                    actorUsername: a.actorUsername,
                    userId: a.userId,
                  }))
                : (e.pinGame = null),
                i.setPlaceForShown(e);
            },
            pinGame: function (e, a) {
              e && a && t.setConversationUniverse(e.id, a);
            },
            unpinGame: function (e) {
              e && t.resetConversationUniverse(e.id);
            },
          };
        }
        (i.$inject = [
          "$log",
          "playTogetherService",
          "gameService",
          "eventStreamService",
          "resources",
        ]),
          t.A.factory("pinGameService", i),
          (a.default = i);
      },
      9149: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          var a = e;
          return {
            numberOfMembers: { inPinnedGame: 3, inActiveGame: 4 },
            gameListScrollListSelector: "#active-game-list",
            activeGamesList: {
              maxNumberForFit: 4,
              minNumberForFit: 1,
              limitNumber: 1,
              showMore: function (e) {
                return a.get("Label.ShowMoreGames", { count: e });
              },
              showMoreText: "",
              showLess: a.get("Label.ShowLessGames"),
              toggleMenuText: "",
              isCollapsed: !0,
              pinGameIsInActiveGames: !1,
            },
            recommendedLabel: a.get("Label.RecommendedGames"),
          };
        }
        (i.$inject = ["languageResource"]),
          t.A.factory("playTogetherLayout", i),
          (a.default = i);
      },
      787: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(7577),
          r = t(127),
          l = t.n(r),
          t = t(1089);
        function n(e) {
          return {
            isPlacePlayersOnlyMe: function (e, a) {
              if (e.playTogetherDict && e.playTogetherDict[a]) {
                a = e.playTogetherDict[a].playerIds;
                if (
                  a &&
                  1 === a.length &&
                  a[0] === parseInt(i.CurrentUser.userId)
                )
                  return !0;
              }
              return !1;
            },
            setPlaceForShown: function (e) {
              var a, t;
              e.playTogetherIds && 0 < e.playTogetherIds.length
                ? ((t = e.playTogetherIds[0]),
                  this.isPlacePlayersOnlyMe(e, t) ||
                    ((a = e.playTogetherDict[t].universeId),
                    (e.placeForShown = { rootPlaceId: t, universeId: a })))
                : e.pinGame
                  ? ((a = (t = e.pinGame).rootPlaceId),
                    (t = t.universeId),
                    (e.placeForShown = { rootPlaceId: a, universeId: t }))
                  : (e.placeForShown = null);
            },
            sortPlayTogetherIds: function (i, e) {
              if (!i || !e || !e.rootPlaceId) return !1;
              var r,
                n = parseInt(e.rootPlaceId),
                a = parseInt(e.placeId),
                t = e.gameId,
                o = parseInt(e.userId),
                s = parseInt(e.universeId),
                c = (c = e.lastOnline) && new Date(c).getTime();
              if (!i.playTogetherIds) {
                (i.playTogetherIds = [n]), (i.playTogetherDict = {});
                return !(i.playTogetherDict[n] = {
                  playerIds: [o],
                  gameInstanceId: t,
                  lastSeen: c,
                  placeId: a,
                  universeId: s,
                });
              }
              i.playTogetherDict[n]
                ? i.playTogetherDict[n].placeId !== a &&
                  (i.playTogetherDict[n].placeId = a)
                : (i.playTogetherDict[n] = {
                    playerIds: [o],
                    gameInstanceId: t,
                    lastSeen: c,
                    placeId: a,
                    universeId: s,
                  }),
                i.playTogetherDict[n].playerIds.indexOf(o) < 0 &&
                  i.playTogetherDict[n].playerIds.push(o),
                i.playTogetherDict[n] &&
                  ((r = i.playTogetherDict[n].playerIds.length),
                  l().forEach(i.playTogetherIds, function (e, a) {
                    var t = i.playTogetherDict[e].playerIds;
                    if (
                      (-1 < t.indexOf(o) &&
                        n !== e &&
                        ((t = t.indexOf(o)),
                        i.playTogetherDict[e].playerIds.splice(t, 1)),
                      i.playTogetherDict[e].playerIds.length < r)
                    )
                      return i.playTogetherIds.splice(a, 0, n), !1;
                  }),
                  i.playTogetherIds.indexOf(n) < 0 &&
                    i.playTogetherIds.push(n)),
                i.playTogetherDict[n].lastSeen < c &&
                  ((i.playTogetherDict[n].gameInstanceId = t),
                  (i.playTogetherDict[n].lastSeen = c)),
                (i.recentPlaceIdFromPresence = e.rootPlaceId),
                (i.recentUserIdFromPresence = e.userId);
            },
          };
        }
        (n.$inject = ["$log"]),
          t.A.factory("playTogetherService", n),
          (a.default = n);
      },
      2286: function (e, a, t) {
        "use strict";
        t.r(a);
        t = t(1089);
        function i(e) {
          return {
            userPresenceTypes: [
              { className: "", title: e.get("Label.Offline") },
              { className: "online", title: e.get("Label.Online") },
              { className: "game", title: e.get("Label.InGame") },
              { className: "studio", title: e.get("Label.InStudio") },
            ],
            status: { offline: 0, online: 1, inGame: 2, inStudio: 3 },
            conversion: { Online: 1, InGame: 2, InStudio: 3 },
          };
        }
        (i.$inject = ["languageResource"]),
          t.A.factory("presenceLayout", i),
          (a.default = i);
      },
      9061: function (e, a, t) {
        "use strict";
        t.r(a);
        var r = t(7577),
          t = t(1089);
        function i(e, a, t) {
          var i =
            r.EnvironmentUrls.profileInsightsApi ||
            "".concat(r.EnvironmentUrls.apiGatewayUrl, "/profile-insights-api");
          return {
            getProfileInsights: function (a) {
              return t
                .httpPost(
                  {
                    url: "".concat(i, "/v1/multiProfileInsights"),
                    retryable: !0,
                    withCredentials: !0,
                  },
                  { userIds: [a], count: 2 },
                )
                .then(function (e) {
                  var e = (
                    null !== (e = null == e ? void 0 : e.userInsights) &&
                    void 0 !== e
                      ? e
                      : []
                  ).find(function (e) {
                    return e.targetUser === a;
                  });
                  return null !==
                    (e = null == e ? void 0 : e.profileInsights) && void 0 !== e
                    ? e
                    : [];
                });
            },
          };
        }
        (i.$inject = ["$q", "apiParamsInitialization", "httpService"]),
          t.A.factory("profileInsightsService", i),
          (a.default = i);
      },
      4194: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          n = t.n(i),
          t = t(1089);
        function r(i, e, t) {
          var r = !1,
            a = 1e4;
          return {
            chatDataName: {
              getUserConversations: "getUserConversations",
              getConversations: "getConversations",
              getMessages: "getMessages",
            },
            setStorageParams: function (e) {
              (r = e.IsChatDataFromLocalStorageEnabled),
                (a = 1e3 * e.ChatDataFromLocalStorageExpirationSeconds);
            },
            getStorageName: function (e, a) {
              var t = i.chatDataLSNamePrefix + "." + e;
              return (
                n().forEach(a, function (e) {
                  t = t + "." + e;
                }),
                t
              );
            },
            saveChatDataToLocalStorage: function (e, a) {
              r && t.saveDataByTimeStamp(e, a);
            },
            getChatDataFromLocalStorage: function (e) {
              return r && t.fetchNonExpiredCachedData(e, a), null;
            },
            clearLocalStorage: function () {
              var e = t.storage();
              if (e)
                for (var a in e)
                  a &&
                    -1 < a.search(i.chatDataLSNamePrefix) &&
                    t.removeLocalStorage(a);
            },
          };
        }
        (r.$inject = ["resources", "$log", "localStorageService"]),
          t.A.factory("storageService", r),
          (a.default = r);
      },
      3493: function (e, a, t) {
        "use strict";
        t.r(a);
        var i = t(127),
          n = t.n(i),
          t = t(1089);
        function r(i) {
          var r;
          return {
            showSystemFeedback: function (e, a) {
              a = 1 < arguments.length && void 0 !== a ? a : 5e3;
              n().element("#chat-system-feedback .alert-content").text(e);
              var t = n().element("#chat-system-feedback .alert");
              t.addClass("alert-active"),
                r && i.cancel(r),
                (r = i(function () {
                  t.removeClass("alert-active");
                }, a));
            },
          };
        }
        (r.$inject = ["$timeout"]),
          t.A.factory("systemFeedbackService", r),
          (a.default = r);
      },
      6692: function (e, a, t) {
        "use strict";
        t.r(a);
        t(127);
        t = t(1089);
        function i(e) {
          var t = e;
          return {
            playTogether: {
              pinGameUpdate: function (e, a) {
                return t.get("Message.PinGameUpdate", {
                  userName: e,
                  gameName: a,
                });
              },
              playGameUpdate: t.get("Message.PlayGameUpdate"),
            },
          };
        }
        (i.$inject = ["languageResource"]),
          t.A.factory("systemMessages", i),
          (a.default = i);
      },
      2565: function (e, a, t) {
        "use strict";
        t.r(a);
        var n = t(7577),
          i = t(127),
          o = t.n(i),
          t = t(1089);
        function r(t, i, r) {
          return {
            getAvatarHeadshots: function (e, t) {
              var a = i.apiSets.multiGetAvatarHeadshots;
              return r
                .buildBatchPromises(a, e, 50, "userIds")
                .then(function (e) {
                  if (e && 0 < e.length) {
                    var a = [];
                    return (
                      o().forEach(e, function (e) {
                        a = a.concat(e.data);
                      }),
                      o().forEach(a, function (e) {
                        var a = e.targetId;
                        t[a] || (t[a] = {}), (t[a].avatarHeadshot = e);
                      }),
                      a
                    );
                  }
                  return null;
                });
            },
            getUserPresence: function (e, t) {
              var a = i.apiSets.multiGetPresence;
              return r
                .buildBatchPromises(a, e, 100, "userIds", "POST")
                .then(function (e) {
                  if (e && 0 < e.length) {
                    var a = [];
                    return (
                      o().forEach(e, function (e) {
                        e = e.userPresences;
                        a = a.concat(e);
                      }),
                      a.forEach(function (e) {
                        var a = e.userId;
                        t[a] || (t[a] = {}),
                          (t[a].presence = e),
                          n.Endpoints &&
                            (t[a].profileUrl = n.Endpoints.generateAbsoluteUrl(
                              "/users/{id}/profile",
                              { id: a },
                              !0,
                            ));
                      }),
                      a
                    );
                  }
                  return null;
                });
            },
            getUserInfo: function (e, a) {
              a = {
                avatarHeadshots: this.getAvatarHeadshots(e, a),
                presences: this.getUserPresence(e, a),
              };
              return t.all(a).then(function (e) {
                return e;
              });
            },
          };
        }
        (r.$inject = ["$q", "apiParamsInitialization", "httpService"]),
          t.A.factory("usersService", r),
          (a.default = r);
      },
      3108: function (e) {
        e.exports =
          '<div class="details-container add-friends-container" ng-class="{\'collapsed\': dialogLayout.collapsed}" ng-show="dialogLayout.details.isAddFriendsEnabled" ng-controller="friendsController"> <div class="chat-windows-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-back" ng-click="toggleAddFriends()"> <span class="icon-chat-back"></span> </div> <div class="chat-header-label chat-header-create-group" ng-click="toggleDialogContainer()"> <span class="font-bold font-caption-header" ng-bind="\'Label.AddFriends\' | translate"></span> </div> <div class="chat-header-action"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})"></span> </div> </div> <div select-friends></div> <div class="details-btns-fixed select-friends-btns"> <button id="select-friends-cancel" ng-click="toggleAddFriends()" ng-bind="\'Action.Cancel\' | translate" class="btn-fixed-width btn-control-sm details-btn-cancel select-friends-cancel"></button> <button id="select-friends-save" class="btn-fixed-width btn-secondary-sm btn-cta-sm details-btn-save select-friends-save" ng-bind="\'Action.Add\' | translate" ng-disabled="dialogLayout.inviteBtnDisabled" ng-click="sendInvite(); toggleAddFriends()"></button> </div> </div>';
      },
      9080: function (e) {
        e.exports =
          '<div class="details-confirmation-container"> <div class="dialog-report-content"> <div class="chat-windows-header"> <div class="chat-header-back" ng-click="dialogLayout.isAbuseReportConfirmationOn = false"> <span class="icon-chat-back"></span> </div> <div class="chat-header-label details-dialog-title" ng-click="toggleDialogContainer()"> <span ng-bind="\'Action.Report\'|translate" class="font-caption-header">Report</span> </div> <div class="chat-header-action"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})"></span> </div> </div> <div class="details-negative-confirmation-body"> <span ng-bind="\'Heading.ContinueToReport\'|translate" class="small text details-negative-confirmation-text">Continue to report?</span> <div class="details-btns-fixed select-friends-btns"> <button class="btn-control-sm details-btn-cancel" ng-bind="\'Action.Cancel\'|translate" ng-click="dialogLayout.isAbuseReportConfirmationOn = false"></button> <button id="chat-abuse-report-btn" class="btn-alert-sm details-btn-save" ng-bind="\'Action.Report\'|translate" ng-click="abuseReport(null, true)"></button> </div> </div> </div> </div> ';
      },
      3905: function (e) {
        e.exports =
          '<thumbnail-2d thumbnail-target-id="userId" thumbnail-type="layoutLibrary.thumbnailTypes.avatarHeadshot" thumbnail-options="{size: layoutLibrary.avatarHeadshotSize.size48}" class="{{className}}" alt-name="userId" title="{{userId}}"> </thumbnail-2d>';
      },
      7193: function (e) {
        e.exports =
          '<div id="chat-main" class="chat-main" ng-controller="chatBarController" ng-class="{\'chat-main-empty\': isChatEmpty() }" ng-cloak> <div id="chat-header" class="chat-windows-header chat-header"> <div class="chat-header-label" ng-click="toggleChatContainer()"> <span class="font-caption-header chat-header-title" ng-bind="\'Heading.Chat\' | translate"></span> </div> <div class="chat-header-action"> <span class="xsmall notification-red notification" ng-show="chatLibrary.chatLayout.collapsed && chatViewModel.unreadConversationCount" ng-cloak>{{chatViewModel.unreadConversationCount}}</span> <span> <span id="chat-group-create" class="icon-chat-group-create" ng-hide="chatLibrary.chatLayout.collapsed \r\n                        || chatLibrary.chatLayout.errorMaskEnable \r\n                        || chatLibrary.chatLayout.chatLandingEnabled \r\n                        || chatLibrary.chatLayout.pageDataLoading \r\n                        || !getIsChatEnabled()\r\n                        || !getIsGroupChatEnabled()" ng-click="launchDialog(newGroup.layoutId)" uib-tooltip="{{\'Label.SpanTitle.CreateGroupNeeds2More\' | translate}}" tooltip-placement="bottom-right" ng-cloak></span> </span> </div> </div> <div id="chat-body" class="chat-body" ng-show="!chatLibrary.chatLayout.errorMaskEnable && !chatLibrary.chatLayout.pageDataLoading && !chatLibrary.chatLayout.pageInitializing" ng-if="!(chatLibrary.chatLayout.chatLandingEnabled || !getIsChatEnabled())"> <div class="border-bottom chat-search" ng-class="{\'chat-search-focus\': chatLibrary.chatLayout.searchFocus}"> <span> <input type="text" placeholder="{{\'Label.InputPlaceHolder.SearchForFriends\' | translate }}" class="input-field chat-search-input font-caption-body" ng-model="chatViewModel.searchTerm" ng-focus="chatLibrary.chatLayout.searchFocus = true"/> </span> <span class="icon-chat-search"></span> <span class="icon-chat-search-cancel" ng-click="cancelSearch()"></span> </div> <div id="chat-friend-list" class="rbx-scrollbar chat-friend-list" lazy-load> <ul id="chat-friends" class="chat-friends"> <li ng-repeat="chatUser in chatUserDict | orderList: chatLibrary.chatLayoutIds | filter : search" class="chat-friend chat-friend-{{chatUser.id}}"> <div ng-if="chatUser.dialogType === dialogType.CHAT || chatUser.dialogType === dialogType.FRIEND" class="chat-friend-container" ng-click="launchFromConversationList(chatUser.layoutId)"> <div class="avatar avatar-headshot-sm card-plain chat-friend-avatar" ng-click="launchFromConversationList(chatUser.layoutId)"> <span class="chat-avatar-headshot" class-name="avatar-card-image chat-avatar" chat-avatar-headshot user-id="{{chatUser.displayUserId}}" layout-library="chatLibrary.layoutLibrary"> </span> <div class="avatar-status chat-friend-status" ng-class="userPresenceTypes[chatLibrary.friendsDict[chatUser.displayUserId].presence.userPresenceType][\'className\']"> </div> </div> <div user-conversation-info></div> </div> <div ng-if="chatUser.dialogType === dialogType.GROUPCHAT" class="chat-friend-container chat-friend-groups" ng-click="launchFromConversationList(chatUser.layoutId)"> <div class="chat-friend-avatar" ng-click="launchFromConversationList(chatUser.layoutId)"> <ul class="avatar-group card-plain chat-avatar-groups" ng-class="{\'avatar-double\': chatUser.userIds.length === 2,\'avatar-triple\' : chatUser.userIds.length === 3,\'avatar-all\' : chatUser.userIds.length>= 4}"> <li ng-repeat="userId in chatUser.userIds | limitTo : 4" class="avatar-item chat-avatar"> <span class="chat-avatar-headshot" class-name="avatar-card-image" chat-avatar-headshot user-id="{{userId}}" layout-library="chatLibrary.layoutLibrary"> </span> </li> </ul> </div> <div user-conversation-info></div> </div> </li> </ul> <div class="chat-loading loading-bottom" ng-show="chatLibrary.chatLayout.isChatLoading"> <span class="spinner spinner-sm" title="{{\'Label.SpanTitle.Loading\' | translate}}"></span> </div> </div> </div> <div id="chat-disconnect" class="chat-disconnect" ng-show="isChatDisconnected()" ng-cloak> <p class="text-info" ng-show="chatLibrary.chatLayout.errorMaskEnable">{{chatLibrary.chatLayout.noConnectionMsg}} </p> <span><span class="spinner spinner-default" title="{{\'Label.SpanTitle.Loading\' | translate}}"></span></span> </div> <div id="chat-empty-list" class="chat-disconnect" ng-hide="chatLibrary.chatLayout.errorMaskEnable" ng-if="isChatEmpty()"> <span class="icon-chat-friends"></span> <p ng-show="getIsChatEnabled()" class="text-info small font-caption-body text-default" ng-bind="\'Message.MakeFriendsToChatNPlay\' | translate"></p> <a id="find-game" ng-bind="\'Label.PlayGames\' | translate" class="btn-primary-sm btn-cta-sm" ng-show="getIsChatEnabled()" ng-href="{{chatLibrary.gamesPageLink}}"></a> <div ng-if="!getIsChatEnabled()"> <div ng-switch="getChatDisabledReason()"> <p ng-switch-when="CHAT_DISABLED_REASON_PRIVACY_SETTING" class="text-info small" ng-click="openSettingsPage()"> <span ng-bind-html="\'Message.ChatPrivacySetting\' | translate:{frontLink: \'<span class=text-link>\', endLink: \'</span>\'}"></span> </p> <p ng-switch-when="CHAT_DISABLED_REASON_REGION" ng-bind="\'Message.ChatUnavailableRegion\' | translate" class="text-info small"> </p> <div ng-switch-default></div> </div> </div> </div> </div>';
      },
      6823: function (e) {
        e.exports =
          '<div ng-controller="chatController" ng-class="{\'collapsed\': chatLibrary.chatLayout.collapsed}" ng-cloak> <div chat-bar></div> <div id="dialogs" class="dialogs" ng-controller="dialogsController" ng-hide="!getIsChatEnabled()"> <div dialog id="{{chatLayoutId}}" dialog-data="chatUserDict[chatLayoutId]" chat-library="chatLibrary" timeout-expires-at="{{getTimeoutExpiresAt(chatUserDict[chatLayoutId].id)}}" show-timeout-modal="showTimeoutModal(chatUserDict[chatLayoutId].id)" close-dialog="closeDialog(chatLayoutId)" send-invite="sendInvite(chatLayoutId)" open-conversation-from-friend-id="openConversationFromFriendId(chatUserDict[chatLayoutId].id)" update-friends-dict-by-search="updateFriendsDictBySearch(friends)" ng-repeat="chatLayoutId in chatLibrary.layoutIdList"></div> <div dialog id="{{newGroup.layoutId}}" dialog-data="newGroup" chat-library="chatLibrary" timeout-expires-at="{{getTimeoutExpiresAt(chatUserDict[chatLayoutId].id)}}" show-timeout-modal="showTimeoutModal(chatUserDict[chatLayoutId].id)" close-dialog="closeDialog(\'newGroup\')" send-invite="sendInvite(newGroup.layoutId)" open-conversation-from-friend-id="openConversationFromFriendId(chatUserDict[chatLayoutId].id)" update-friends-dict-by-search="updateFriendsDictBySearch(friends)" ng-if="newGroup"></div> <div id="dialogs-minimize" class="dialogs-minimize" ng-class="{\'dialogs-minimize-non-interactable\': !chatLibrary.hasMinimizedDialogs}" dialog-minimize chat-library="chatLibrary"> </div> <div class="chat-placeholder" chat-placeholder> </div> </div> <div class="sg-system-feedback"> <div id="chat-system-feedback" class="alert-system-feedback"> <div class="alert alert-loading"> <span class="alert-content"></span> </div> </div> </div> </div>';
      },
      4466: function (e) {
        e.exports =
          '<div id="dialog-container-{{dialogData.id}}" class="dialog-container" ng-class="{\'collapsed\': dialogLayout.collapsed,\'active\': dialogLayout.active && dialogData.layoutId !== chatLibrary.chatLayout.focusedLayoutId,\'focused\': !dialogLayout.collapsed && dialogData.layoutId === chatLibrary.chatLayout.focusedLayoutId}" ng-controller="dialogController"> <div abuse-report ng-show="dialogLayout.currentDialogScreen === \'abuseReportConfirmation\'"></div> <div details ng-show="dialogLayout.currentDialogScreen === \'details\'"></div> <div contact-card ng-show="dialogLayout.currentDialogScreen === \'contactCard\'"></div> <div class="dialog-main" ng-show="dialogLayout.currentDialogScreen === \'default\'"> <div class="chat-windows-header dialog-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-label" ng-click="toggleDialogContainer()"> <span class="font-caption-header text-overflow chat-header-title dialog-header-title"> {{dialogData.name}} </span> </div> <div dialog-header></div> </div> <div id="scrollbar_{{dialogData.dialogType}}_{{dialogData.layoutId}}" class="rbx-scrollbar dialog-body" ng-style="dialogLayout.defaultStyle.dialogStyle" focus-model="toggleDialogFocusStatus(true)" dialog-lazy-load> <ul class="dialog-messages" ng-controller="dialogMessagesController"> <li ng-if="dialogLayout.shouldShowOsaContextCard"> <div osa-context-card></div> </li> <li class="dialog-message-container" ng-repeat="message in dialogData.chatMessages | reverse" ng-class="{\'message-inbound\': message.sender_user_id != chatLibrary.userId && !message.isSystemMessage,\'system-message\': message.isSystemMessage,\'message-cluster-master\': message.isClusterMaster}" ng-if="canRenderMessage(message)" on-finish-render="ngRepeatFinished"> <div class="indicated-message" ng-hide="!message.displayTimeStamp"> <span class="font-footer text-muted indicated-message-bubble">{{message.displayTimeStamp}}</span> </div> <a ng-href="{{chatLibrary.friendsDict[message.sender_user_id].profileUrl}}" ng-hide="message.isSystemMessage" class="avatar avatar-headshot-sm dialog-message-avatar-link"> <span ng-if="message.sender_user_id != chatLibrary.userId" class="chat-avatar-headshot" class-name="avatar-card-image dialog-message-avatar" chat-avatar-headshot user-id="{{message.sender_user_id}}" layout-library="chatLibrary.layoutLibrary"></span> </a> <div class="dialog-message-body"> <div class="dialog-message dialog-message-content dialog-triangle" ng-class="{\'message-is-sending\': message.sendingMessage, \'trusted-comms\': isMessageOutgoingTrustedComms(message)}" ng-hide="message.isSystemMessage" ng-if="!message.hasLinkCard && canRenderMessage(message)"> <span class="message-piece font-caption-body text-emphasis" ng-repeat="piece in message.pieces" ng-bind-html="piece.content"></span> <span ng-show="message.canResend" ng-click="resendMessage(message)" class="icon-chat-resend"></span> </div> <div ng-if="message.hasLinkCard" link-card></div> <div class="xsmall text-error dialog-sending" ng-show="message.sendMessageHasError" ng-bind="message.error || (\'Message.Error\' | translate)"></div> </div> <div class="indicated-message" system-message></div> </li> <li class="dialog-message-container message-inbound typing-indicator" ng-show="dialogLayout.typing.isTypingFromSender"> <a ng-href="{{chatLibrary.friendsDict[dialogLayout.typing.userIds[0]].profileUrl}}" class="avatar avatar-headshot-sm dialog-message-avatar-link"> <span class="chat-avatar-headshot" class-name="avatar-card-image dialog-message-avatar" chat-avatar-headshot user-id="{{dialogLayout.typing.userIds[0]}}" layout-library="chatLibrary.layoutLibrary"></span> </a> <div class="small dialog-message dialog-triangle"> <span class="typing"></span> </div> </li> </ul> </div> <div class="chat-loading loading-top" ng-show="dialogLayout.isChatLoading"> <span class="spinner spinner-sm" title="{{\'Label.SpanTitle.Loading\' | translate}} ..."></span> </div> <div class="dialog-input-container-disabled chat-unavailable" ng-if="dialogData.isConversationUnavailableWithUser"> <span>{{ \'Message.ChatUnavailableWithUser\' | translate }}</span> <span class="dialog-input-disabled-trailing"> <span class="icon-chat-error"></span> </span> </div> <div class="dialog-input-container-disabled chat-timed-out" ng-if="showTimedOutInputBar && !dialogData.isConversationUnavailableWithUser" ng-click="showTimeoutModal()"> <span>{{ \'Label.ChatDisabled\' | translate }}</span> <span class="dialog-input-disabled-trailing"> <span chat-timeout-timer expires-at="{{timeoutExpiresAt}}" on-expiry="refreshShowTimedOutInputBar()"></span> <span class="icon-chat-error"></span> </span> </div> <div class="border-top dialog-input-container" ng-class="{\'disabled\': chatLibrary.chatLayout.errorMaskEnable}" ng-style="dialogLayout.defaultStyle.inputStyle" ng-if="!showTimedOutInputBar && !dialogData.isConversationUnavailableWithUser"> <textarea id="dialog-input" msd-elastic dialog-input rows="1" focus-me="{{dialogLayout.focusMeEnabled && dialogData.layoutId === chatLibrary.chatLayout.focusedLayoutId}}" placeholder="{{\'Label.InputPlaceHolder.SendMessage\' | translate}}" ng-model="dialogData.messageForSend" enter-escape-shift="keyPressEnter($event)" ng-keypress="typing($event, true)" ng-blur="typing($event, false)" ng-keyup="keyStroke($event, chatLibrary.userId)" ng-keydown="keyStroke($event, chatLibrary.userId)" class="dialog-input" input-max-length="{{dialogLayout.limitCharacterCount}}" ng-disabled="chatLibrary.chatLayout.errorMaskEnable" ng-style="dialogLayout.defaultStyle.inputTextStyle" hinteractive hinteractive-domain="chat"></textarea> </div> </div> <div places></div> </div> ';
      },
      7993: function (e) {
        e.exports =
          '<thumbnail-2d class="{{className}}" thumbnail-target-id="universeId" thumbnail-type="layoutLibrary.thumbnailTypes.gameIcon"> </thumbnail-2d>';
      },
      9651: function (e) {
        e.exports =
          '<div id="dialog-container-{{dialogData.id}}" class="dialog-container group-dialog" ng-class="{\'group-has-banner\': dialogLayout.renameEditor.isEnabled,\'collapsed\': dialogLayout.collapsed,\'active\': dialogLayout.active && dialogData.layoutId !== chatLibrary.chatLayout.focusedLayoutId,\'focused\': !dialogLayout.collapsed && dialogData.layoutId === chatLibrary.chatLayout.focusedLayoutId}" ng-controller="dialogController"> <div abuse-report ng-show="dialogLayout.currentDialogScreen === \'abuseReportConfirmation\'"></div> <div confirm-negative-action chat-library="chatLibrary" dialog-layout="dialogLayout" confirm-callback="confirmCallBack()" ng-show="dialogLayout.currentDialogScreen === \'confirmDialog\'"></div> <div details ng-show="dialogLayout.currentDialogScreen === \'details\'"></div> <div pending-state ng-show="dialogLayout.currentDialogScreen === \'pending\'"></div> <div class="dialog-main" ng-show="dialogLayout.currentDialogScreen === \'default\'"> <div class="chat-windows-header dialog-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-label" ng-click="toggleDialogContainer()"> <span id="group-chat-title" class="font-caption-header text-overflow dialog-header-title max-width" title="{{dialogData.title}}">{{dialogData.title}}</span> </div> <div dialog-header></div> </div> <div id="scrollbar_{{dialogData.dialogType}}_{{dialogData.layoutId}}" ng-style="dialogLayout.defaultStyle.dialogStyle" class="rbx-scrollbar dialog-body" dialog-lazy-load focus-model="toggleDialogFocusStatus(true)"> <ul class="dialog-messages" ng-controller="dialogMessagesController"> <li class="dialog-message-container" ng-repeat="message in dialogData.chatMessages | reverse" ng-class="{\'message-inbound\': message.sender_user_id != chatLibrary.userId && !message.isSystemMessage,\'system-message\': message.isSystemMessage,\'message-cluster-master\': message.isClusterMaster}" ng-if="canRenderMessage(message)" on-finish-render="ngRepeatFinished"> <div class="indicated-message" ng-hide="!message.displayTimeStamp"> <span class="font-footer text-muted indicated-message-bubble"> {{message.displayTimeStamp}} </span> </div> <a ng-href="{{chatLibrary.friendsDict[message.sender_user_id].profileUrl}}" ng-hide="message.isSystemMessage" class="avatar avatar-headshot-sm dialog-message-avatar-link"> <span ng-if="message.sender_user_id != chatLibrary.userId" class="chat-avatar-headshot" class-name="avatar-card-image dialog-message-avatar" chat-avatar-headshot user-id="{{message.sender_user_id}}" layout-library="chatLibrary.layoutLibrary"> </span> </a> <div class="dialog-message-body" ng-if="canRenderMessage(message)"> <div ng-if="chatLibrary.friendsDict[message.sender_user_id] && !message.isSystemMessage" ng-show="message.isClusterMaster && message.sender_user_id != chatLibrary.userId" class="xxsmall dialog-message-author"> <span class="font-footer text-muted" ng-bind="chatLibrary.friendsDict[message.sender_user_id].nameForDisplay"></span> <span class="typing" ng-show="message.id == dialogLayout.typing.userTypingDict[message.sender_user_id].messageId"></span> </div> <div class="dialog-message dialog-triangle" ng-class="{\'message-is-sending\': message.sendingMessage, \'trusted-comms\': isMessageOutgoingTrustedComms(message)}" ng-hide="message.isSystemMessage" ng-if="!message.hasLinkCard"> <span class="dialog-message-content"> <span class="message-piece" ng-repeat="piece in message.pieces" ng-bind-html="piece.content"></span> </span> <span ng-show="message.canResend" ng-click="resendMessage(message)" class="icon-chat-resend"></span> </div> <div ng-if="message.hasLinkCard" link-card></div> <div class="text-error dialog-sending" ng-show="message.sendMessageHasError" ng-bind="message.error || (\'Message.Error\'|translate)"></div> </div> <div class="indicated-message" system-message></div> </li> </ul> </div> <div class="chat-loading loading-top" ng-show="dialogLayout.isChatLoading"> <span class="spinner spinner-sm" title="{{\'Label.SpanTitle.Loading\'|translate}}"></span> </div> <div class="dialog-input-container-disabled chat-timed-out" ng-if="showTimedOutInputBar" ng-click="showTimeoutModal()"> <span>{{\'Label.ChatDisabled\' | translate}}</span> <span class="dialog-input-disabled-trailing"> <span chat-timeout-timer expires-at="{{timeoutExpiresAt}}" on-expiry="refreshShowTimedOutInputBar()"></span> <span class="icon-chat-error"></span> </span> </div> <div class="border-top dialog-input-container" ng-class="{\'disabled\': chatLibrary.chatLayout.errorMaskEnable}" ng-style="dialogLayout.defaultStyle.inputStyle" ng-if="!showTimedOutInputBar"> <textarea msd-elastic focus-me="{{dialogLayout.focusMeEnabled && dialogData.layoutId === chatLibrary.chatLayout.focusedLayoutId}}" placeholder="{{\'Label.InputPlaceHolder.SendMessage\'|translate}}" ng-model="dialogData.messageForSend" enter-escape-shift="keyPressEnter($event)" ng-keypress="typing($event, true)" ng-blur="typing($event, false)" class="dialog-input" rows="1" input-max-length="{{dialogLayout.limitCharacterCount}}" ng-disabled="chatLibrary.chatLayout.errorMaskEnable" ng-style="dialogLayout.defaultStyle.inputTextStyle" hinteractive hinteractive-domain="chat"></textarea> </div> </div> </div> ';
      },
      7197: function (e) {
        e.exports =
          '<div class="chat-placeholder-container" ng-show="chatLibrary.chatPlaceholderEnabled"> <div class="chat-placeholder-header"></div> <span class="icon-chat-placeholder"></span> </div>';
      },
      115: function (e) {
        e.exports =
          '<div class="confirm-negative-action details-confirmation-container"> <div class="confirm-negative-action-container"> <div class="chat-windows-header"> <div class="chat-header-back" ng-click="dialogLayout.confirmDialog.isOpen = false"> <span class="icon-chat-back"></span> </div> <div class="chat-header-label details-dialog-title" ng-click="toggleDialogContainer()"> <span class="font-caption-header">{{dialogLayout.confirmDialog.headerTitle}}</span> </div> <div class="chat-header-action"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})" data-toggle="tooltip" title="{{\'Label.Close\'|translate}}"></span> </div> </div> <div class="details-negative-confirmation-body"> <span class="small text details-negative-confirmation-text">{{dialogLayout.confirmDialog.title}}</span> <div class="details-btns-fixed select-friends-btns"> <button class="btn-control-sm details-btn-cancel" ng-click="dialogLayout.confirmDialog.isOpen = false"> {{dialogLayout.confirmDialog.cancelBtnName}} </button> <button id="negative-action-confirm-btn" class="btn-alert-sm details-btn-save" ng-click="confirmCallback()"> {{dialogLayout.confirmDialog.btnName}} </button> </div> </div> </div> </div> ';
      },
      7196: function (e) {
        e.exports =
          '<div class="chat-contact-card" ng-controller="contactCardController"> <div class="chat-contact-card-container"> <div class="chat-windows-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-back" ng-click="dismissContactCard()"> <span class="icon-chat-back"></span> </div> <div class="chat-header-label" ng-click="toggleDialogContainer()"> <span id="chat-title" class="font-caption-header text-overflow dialog-header-title max-width">New Title Placeholder</span> </div> <div dialog-header></div> </div> <div class="chat-dialog-scrollbar rbx-scrollbar" chat-dialog-scrollbar> <div class="chat-contact-card-body"> <div class="chat-contact-card-description font-caption-body text-wrap"> Big body text that is long and should wrap to the next line please! </div> <div class="chat-contact-card-profile-container"> <div class="chat-contact-card-user-info"> <div class="chat-contact-card-avatar-container"> <a ng-href="{{chatLibrary.friendsDict[getOneToOneFriendId()].profileUrl}}" class="avatar avatar-headshot-sm friend-avatar"> <span class="chat-avatar-headshot" class-name="avatar-card-image avatar" chat-avatar-headshot user-id="{{getOneToOneFriendId()}}" layout-library="chatLibrary.layoutLibrary"> </span> </a> </div> <div class="chat-contact-card-name-container"> <div class="chat-contact-card-display-name"> <span class="font-caption-body font-bold chat-contact-card-name-text"> {{chatLibrary.friendsDict[getOneToOneFriendId()].nameForDisplay}} </span> </div> <div class="chat-contact-card-name"> <span class="font-caption-body chat-contact-card-name-text"> @{{chatLibrary.friendsDict[getOneToOneFriendId()].name}} </span> <span class="font-caption-body chat-contact-card-verification-text"> • Another Section ! </span> </div> </div> </div> <div class="chat-contact-card-profile-insights"> <div class="chat-profile-insights-entry" ng-if="shouldShowInsightOfType(\'numMutualFriends\')"> <span class="icon-friends"></span> <span class="chat-profile-insights-label">{{getInsightTextOfType(\'numMutualFriends\')}}</span> </div> </div> </div> <div class="chat-button-stack"> <button class="btn-growth-sm"> Primary action </button> <button class="btn-secondary-sm"> Secondary action </button> </div> </div> </div> </div> </div> ';
      },
      4389: function (e) {
        e.exports =
          '<div class="details-header-container conversation-title-container"> <div class="details-label conversation-title-icon"> <span class="icon-chat-group-name" ng-show="dialogData.dialogType === dialogType.NEWGROUPCHAT"></span> <ul class="avatar-group card-plain chat-avatar-groups" ng-show="dialogData.dialogType != dialogType.NEWGROUPCHAT" ng-class="{\'avatar-double\': dialogData.userIds.length === 2,\'avatar-triple\' : dialogData.userIds.length === 3,\'avatar-all\' : dialogData.userIds.length >= 4}"> <li ng-repeat="userId in dialogData.userIds | limitTo : 4" class="avatar-item chat-avatar"> <span class="chat-avatar-headshot" class-name="avatar-card-image" chat-avatar-headshot user-id="{{userId}}" layout-library="chatLibrary.layoutLibrary"> </span> </li> </ul> </div> <div class="border-bottom small details-input-container" ng-show="dialogData.dialogType == dialogType.NEWGROUPCHAT"> <input type="text" focus-me="{{dialogLayout.focusMeEnabled}}" class="small details-input conversation-title-input" placeholder="{{\'Label.NameYourChatGroup\'|translate}}" ng-model="dialogData.name" maxlength="{{chatLibrary.maxConversationTitleLengthInput}}"> </div> <div class="details-title conversation-title-content" ng-click="toggleConversationEditor()" ng-class="{\'not-clickable\': dialogData.isUserPending}" ng-show="dialogData.dialogType != dialogType.NEWGROUPCHAT"> <span class="small text conversation-title-label text-overflow" ng-bind="dialogData.title"></span> <span class="icon-chat-arrow-right"></span> </div> </div>';
      },
      3040: function (e) {
        e.exports =
          '<div class="details-container conversation-title-editor-container" ng-show="dialogLayout.details.isConversationTitleEditorEnabled"> <div class="chat-windows-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-back" ng-click="toggleConversationEditor()"> <span class="icon-chat-back"></span> </div> <div class="chat-header-label details-dialog-title" ng-click="toggleDialogContainer()"> <span class="font-caption-header" ng-bind="\'Label.ChatGroupName\' | translate"></span> </div> <div class="chat-header-action"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})"></span> </div> </div> <div class="details-container conversation-title-editor-body"> <div ng-bind="\'Label.ChangeChatGroupName\' | translate" class="font-caption-body text conversation-title-editor-title"> </div> <div class="conversation-title-editor-content"> <textarea auto-resize rows="1" maxlength="{{chatLibrary.maxConversationTitleLengthInput}}" focus-me="{{dialogLayout.focusMeEnabled}}" class="font-caption-body input-field details-input conversation-title-editor-textarea" key-press-enter="renameTitle()" ng-model="dialogData.name">\r\n            </textarea> <span class="font-footer text-subheader conversation-title-editor-count">{{dialogData.name.length}}/{{chatLibrary.maxConversationTitleLengthInput}}</span> </div> <div class="details-btns-fixed select-friends-btns"> <button id="select-friends-cancel" ng-bind="\'Action.Cancel\'|translate" ng-click="toggleConversationEditor()" class="btn-fixed-width btn-control-sm details-btn-cancel"></button> <button id="select-friends-save" ng-bind="\'Action.Save\'|translate" class="btn-fixed-width btn-secondary-sm details-btn-save" ng-click="renameTitle()"></button> </div> </div> </div>';
      },
      155: function (e) {
        e.exports =
          '<div class="dialog-container create-chat-container" ng-class="{\'collapsed\': dialogLayout.collapsed}" ng-controller="friendsController"> <div class="chat-windows-header"> <div class="chat-header-label chat-header-create-group" ng-click="toggleDialogContainer()"> <span class="font-caption-header">{{dialogLayout.title}}</span> </div> <div class="chat-header-action"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})"></span> </div> </div> <div conversation-title></div> <div select-friends></div> <div class="details-btns-fixed select-friends-btns"> <button id="select-friends-cancel" ng-bind="\'Action.Cancel\'|translate" ng-click="closeDialog({layoutId: dialogData.layoutId})" class="btn-fixed-width btn-control-sm details-btn-cancel select-friends-cancel"> </button> <button id="select-friends-save" ng-bind="\'Action.Create\'|translate" class="btn-fixed-width btn-secondary-sm btn-cta-sm details-btn-save select-friends-save" ng-disabled="dialogLayout.inviteBtnDisabled" ng-click="sendInvite()"> </button> </div> </div>';
      },
      8636: function (e) {
        e.exports =
          '<div class="details-dialog-container" ng-controller="detailsController"> <div class="details-dialog" ng-class="{\'collapsed\': dialogLayout.collapsed}" ng-hide="dialogLayout.details.isAddFriendsEnabled || dialogLayout.details.isConversationTitleEditorEnabled"> <div class="chat-windows-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-back" ng-click="toggleDetails()"> <span class="icon-chat-back"></span> </div> <div class="chat-header-label details-dialog-title" ng-click="toggleDialogContainer()"> <span ng-bind="\'Label.ChatDetails\'| translate" class="font-caption-header"></span> </div> <div class="chat-header-action"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})"></span> </div> </div> <div id="scrollbar_details_{{dialogData.layoutId}}" class="rbx-scrollbar details-container details-scrollbar" chat-dialog-scrollbar> <div class="xsmall border-bottom text-secondary details-general-label" ng-if="dialogData.isGroupChat" ng-bind="\'Label.General\'|translate"> </div> <div conversation-title ng-if="dialogData.isGroupChat"></div> <div class="xsmall border-top border-bottom text-secondary details-members-label font-footer text-muted" ng-bind="\'Label.Members\' | translate"></div> <div class="details-members-container"> <div class="add-friends-option" ng-show="shouldShowAddUser()"> <div class="add-friends-icon" ng-click="toggleAddFriends()"> <div class="add-friends-cirle-container"> <span class="icon-chat-add-friends"></span> </div> </div> <div class="small border-bottom text-sec add-friends-label" ng-bind="\'Label.AddFriends\' | translate" ng-click="toggleAddFriends()"> </div> </div> <div id="group-members" class="participant-list"> <ul class="friends-list-container participant-list-container"> <li ng-repeat="userId in dialogData.userIds | limitTo: dialogLayout.memberDisplay.limitNumber" id="member-list-{{userId}}"> <div class="friend-container"> <a ng-href="{{chatLibrary.friendsDict[userId].profileUrl}}" class="avatar avatar-headshot-sm friend-avatar"> <span class="chat-avatar-headshot" class-name="avatar-card-image avatar" chat-avatar-headshot user-id="{{userId}}" layout-library="chatLibrary.layoutLibrary"> </span> <div class="avatar-status avatar-status" ng-class="userPresenceTypes[chatLibrary.friendsDict[userId].presence.userPresenceType][\'className\']"> </div> </a> <div class="border-bottom friend-info-action"> <div class="text-overflow friend-info"> <div class="friend-username dynamic-overflow-container no-wrap"> <div class="small text-overflow text-sec friend-name dynamic-ellipsis-item"> {{chatLibrary.friendsDict[userId].nameForDisplay}}</div> </div> <div class="xsmall text-overflow friend-status"> {{userPresenceTypes[chatLibrary.friendsDict[userId].presence.userPresenceType].title}} </div> </div> <div class="friend-label-container" ng-show="shouldShowPendingLabel(userId)"> <div class="friend-label"> <div class="small text-sec" ng-bind="\'Label.Pending\' | translate"> </div> </div> </div> <div class="friend-action" ng-show="userId !== chatLibrary.userId"> <div class="friend-action-more-option more-options-{{dialogData.layoutId}}" click-outside="toggleFriendsMenu(userId, true)" ng-click="toggleFriendsMenu(userId)"> <span class="icon-chat-more-options"></span> </div> <div class="friend-menu" ng-class="{\'three-items\': canConversationRemoveMember() }" ng-show="dialogLayout.details.friendIdForMenuOn == userId && dialogLayout.details.friendMenuAction[userId]"> <ul class="dropdown-menu" role="menu" ng-show="dialogLayout.details.friendIdForMenuOn == userId && dialogLayout.details.friendMenuAction[userId]"> <li> <a id="add-friends-{{userId}}" ng-href="{{chatLibrary.friendsDict[userId].profileUrl}}" ng-click="toggleFriendsMenu(userId)" ng-bind="\'Label.ViewProfile\' | translate" class="font-caption-header"></a> </li> <li> <a id="abuse-report-{{userId}}" ng-click="abuseReport(userId, false); toggleFriendsMenu(userId)" class="font-caption-header" ng-bind="\'Action.Report\' | translate"></a> </li> <li ng-if="canConversationRemoveMember()"> <a id="remove-member-{{userId}}" ng-click="removeMember(userId, false); toggleFriendsMenu(userId)" class="font-caption-header" ng-bind="\'Action.Remove\' | translate"></a> </li> </ul> </div> </div> <div class="friend-info-action-spacing"></div> </div> </div> </li> <li class="participant-list-action" ng-show="dialogData.userIds.length > dialogLayout.memberDisplay.defaultLimit"> <a class="small text-link" ng-click="toggleMemberList()">{{dialogLayout.memberDisplay.linkName}}</a> </li> </ul> </div> </div> <div class="details-btns"> <button id="leave-group" ng-click="leaveGroupChat(false)" class="btn-full-width btn-alert-sm select-friends-cancel" ng-if="dialogData.dialogType !== dialogType.CHAT && dialogData.isGroupChat" ng-bind="\'Label.LeaveChatGroup\' | translate"></button> </div> </div> </div> <div add-friends></div> <div conversation-title-editor></div> </div> ';
      },
      9009: function (e) {
        e.exports =
          '<div class="chat-header-action" ng-controller="dialogHeaderController"> <span class="icon-chat-close-white" ng-click="closeDialog({layoutId: dialogData.layoutId})"></span> <span class="icon-chat-info-white" id="dialog-info" uib-tooltip="{{\'Label.ChatDetails\'| translate}}" tooltip-placement="bottom" ng-click="toggleDetails()" ng-hide="dialogLayout.collapsed || chatLibrary.chatLayout.errorMaskEnable"></span> <span id="play-together-{{dialogData.id}}" class="cursor-pointer dialog-header-active-game" ng-if="isPinOrActiveGameAvailable()" ng-hide="dialogLayout.collapsed || chatLibrary.chatLayout.errorMaskEnable" ng-click="openGameList()" popover-trigger=" \'none\' " popover-class="game-list-in-dialog" popover-placement="bottom-right" popover-append-to-body="false" popover-is-open="dialogLayout.togglePopoverParams.isOpen" uib-popover-template="\'{{gamesListTemplateUrl}}\'" toggle-popover> <span chat-game-icon class-name="dialog-header-active-game-image" ng-if="dialogData.placeForShown.universeId" universe-id="{{dialogData.placeForShown.universeId}}" layout-library="chatLibrary.layoutLibrary"></span> </span> </div>';
      },
      5992: function (e) {
        e.exports =
          '<div id="dialogs-minimize-container" class="dialogs-minimize-container" ng-show="chatLibrary.hasMinimizedDialogs" data-toggle="popover" data-bind="dialogs"> <span class="icon-chat-more-dialogs"></span> <span class="font-header-2 minimize-count">{{chatLibrary.minimizedDialogIdList.length}}</span> <div class="rbx-popover-content" data-toggle="dialogs"> <ul class="dropdown-menu minimize-list" role="menu"> <li ng-repeat="dialogLayoutId in chatLibrary.minimizedDialogIdList" class="minimize-item" id="{{dialogLayoutId}}" minimize-item> <a class="text-overflow minimize-title"> <span> {{chatLibrary.minimizedDialogData[dialogLayoutId].name}} </span> </a> <span class="icon-chat-close-black minimize-close"></span> </li> </ul> </div> </div>';
      },
      8249: function (e) {
        e.exports =
          '<div ng-controller="playTogetherController"> <div class="game-item-container pinned-game-container" ng-class="{\'has-active-game\': hasPinGameAndActiveGames()}" ng-show="playTogether.pinGame && playTogether.pinGame.rootPlaceId"> <a ng-href="{{chatLibrary.placesLibrary[playTogether.pinGame.rootPlaceId].placeUrl}}" class="text-title game-link"> <span chat-game-icon class-name="game-icon" layout-library="chatLibrary.layoutLibrary" ng-if="chatLibrary.placesLibrary[playTogether.pinGame.rootPlaceId].universeId" universe-id="{{chatLibrary.placesLibrary[playTogether.pinGame.rootPlaceId].universeId}}" title="{{chatLibrary.placesLibrary[playTogether.pinGame.rootPlaceId].placeName}}"></span> </a> <div class="game-details pinned-game-details"> <div class="pinned-game-header"></div> <div class="text-overflow small text-title game-name"> <a ng-href="{{chatLibrary.placesLibrary[playTogether.pinGame.rootPlaceId].placeUrl}}" class="text-title game-link"> {{chatLibrary.placesLibrary[playTogether.pinGame.rootPlaceId].placeName}} </a> </div> <div class="game-info pinned-game-info"> <ul class="game-players"> <li ng-repeat="userId in playTogether.playTogetherDict[playTogether.pinGame.rootPlaceId].playerIds | limitTo: playTogetherLayout.numberOfMembers.inPinnedGame" class="avatar avatar-headshot-sm card-plain game-player" title="{{chatLibrary.friendsDict[userId].nameForDisplay}}"> <span uib-tooltip="{{chatLibrary.friendsDict[userId].nameForDisplay}}" tooltip-placement="bottom" tooltip-append-to-body="true" class="avatar-card-image game-player-avatar" class="chat-avatar-headshot" chat-avatar-headshot user-id="{{userId}}" layout-library="chatLibrary.layoutLibrary"> </span> <div class="avatar-status game-player-presence" ng-class="userPresenceTypes[chatLibrary.friendsDict[userId].presence.userPresenceType][\'className\']"> </div> </li> <li ng-show="playTogether.playTogetherDict[playTogether.pinGame.rootPlaceId].playerIds.length > playTogetherLayout.numberOfMembers.inPinnedGame" class="font-caption-body text-secondary game-player-plus" ng-cloak> +{{playTogether.playTogetherDict[playTogether.pinGame.rootPlaceId].playerIds.length - playTogetherLayout.numberOfMembers.inPinnedGame}} </li> </ul> <button type="button" class="{{playTogether.placeButtonLayout[playTogether.pinGame.rootPlaceId].className}} game-btn" ng-class="{\'invisible\' : !playTogether.placeButtonLayout[playTogether.pinGame.rootPlaceId]}" ng-click="joinGameFromPlayTogether(playTogether.pinGame.rootPlaceId)" ng-if="playTogether.placeButtonLayout[playTogether.pinGame.rootPlaceId].type != gameLayout.playButtonTypes.notAvailable"> {{playTogether.placeButtonLayout[playTogether.pinGame.rootPlaceId].text}} </button> <span class="xsmall text-label game-non-available" ng-if="playTogether.placeButtonLayout[playTogether.pinGame.rootPlaceId].type == gameLayout.playButtonTypes.notAvailable"> {{playTogether.placeButtonLayout[playTogether.pinGame.rootPlaceId].text}} </span> </div> </div> </div> <div class="game-list-container" ng-class="{\'has-pin-game-above\': hasPinGameAndActiveGames(),\'overflow\': (playTogetherLayout.activeGamesList.limitNumber >= playTogetherLayout.activeGamesList.maxNumberForFit)}" ng-show="hasActiveGames()"> <ul id="active-game-list" ng-class="{\'rbx-scrollbar\': playTogether.inDialog}" class="active-game-list"> <li ng-repeat="placeId in playTogether.playTogetherIds | limitTo: playTogetherLayout.activeGamesList.limitNumber" ng-if="placeId != playTogether.pinGame.rootPlaceId" repeat-done class="game-item-container active-game-container"> <a ng-href="{{chatLibrary.placesLibrary[placeId].placeUrl}}" class="text-title game-link"> <div chat-game-icon class="chat-game-icon" class-name="game-icon" layout-library="chatLibrary.layoutLibrary" ng-if="chatLibrary.placesLibrary[placeId].universeId" universe-id="{{chatLibrary.placesLibrary[placeId].universeId}}" title="{{chatLibrary.placesLibrary[placeId].placeName}}"></div> </a> <div class="border-bottom game-details active-game-details"> <div class="game-title-container"> <div class="text-overflow small text-title game-name"> <a ng-href="{{chatLibrary.placesLibrary[placeId].placeUrl}}"> {{chatLibrary.placesLibrary[placeId].placeName}} </a> </div> </div> <div class="game-info active-game-info"> <ul class="game-players"> <li ng-repeat="userId in playTogether.playTogetherDict[placeId].playerIds | limitTo: playTogetherLayout.numberOfMembers.inActiveGame" class="avatar avatar-headshot-sm card-plain game-player" title="{{chatLibrary.friendsDict[userId].nameForDisplay}}"> <div uib-tooltip="{{chatLibrary.friendsDict[userId].nameForDisplay}}" tooltip-placement="bottom" tooltip-append-to-body="true" class="chat-avatar-headshot" class-name="avatar-card-image game-player-avatar" chat-avatar-headshot user-id="{{userId}}" layout-library="chatLibrary.layoutLibrary"> </div> <div class="avatar-status game-player-presence" ng-class="userPresenceTypes[chatLibrary.friendsDict[userId].presence.userPresenceType][\'className\']"> </div> </li> <li ng-show="playTogether.playTogetherDict[placeId].playerIds.length > playTogetherLayout.numberOfMembers.inActiveGame" class="font-caption-body text-secondary game-player-plus" ng-cloak> +{{playTogether.playTogetherDict[placeId].playerIds.length - playTogetherLayout.numberOfMembers.inActiveGame}} </li> </ul> <button type="button" class="{{playTogether.placeButtonLayout[placeId].className}} game-btn" ng-class="{\'invisible\' : !playTogether.placeButtonLayout[placeId]}" ng-if="playTogether.placeButtonLayout[placeId].type != gameLayout.playButtonTypes.notAvailable" ng-click="joinGameFromPlayTogether(placeId)"> {{playTogether.placeButtonLayout[placeId].text}} </button> <span class="xsmall text-label game-non-available" ng-if="playTogether.placeButtonLayout[placeId].type == gameLayout.playButtonTypes.notAvailable"> {{playTogether.placeButtonLayout[placeId].text}} </span> </div> </div> </li> </ul> <div class="cursor-pointer border-top is-exclusive-click active-game-toggle-menu" ng-click="toggleActiveGameList()" ng-if="playTogetherLayout.numberOfActiveGames > 1" ng-class="{\'collapsed\': playTogetherLayout.activeGamesList.isCollapsed}"> <span class="xsmall text is-exclusive-click toggle-menu-text">{{playTogetherLayout.activeGamesList.toggleMenuText}}</span> </div> </div> </div> ';
      },
      5558: function (e) {
        e.exports =
          '<div id="link-card" ng-controller="linkCardMessagesController"> <div class="link-card-msg-wrap" ng-repeat="pieceOfMessage in linkCardMessages" ng-controller="linkCardController" ng-init="sendLoadLinkCardEvent(pieceOfMessage.id)"> <div class="dialog-message dialog-message-content dialog-triangle" ng-class="{\'message-is-sending\': message.sendingMessage, \'trusted-comms\': isMessageOutgoingTrustedComms(message)}" ng-hide="pieceOfMessage.isLinkCard" ng-if="!pieceOfMessage.isCard || (pieceOfMessage.isCard && chatLibrary.placesLibrary[pieceOfMessage.id].isInvalid)"> <span class="message-piece font-caption-body text-emphasis" ng-repeat="piece in pieceOfMessage.pieces" ng-bind-html="piece.content"></span> </div> <div class="cursor-pointer border dialog-triangle link-card-container" ng-if="isLinkCardAvailableAndParsedByClientSide(pieceOfMessage) && (chatLibrary.placesLibrary[pieceOfMessage.id] || !chatLibrary.placesLibrary[pieceOfMessage.id].isInvalid)"> <div ng-if="chatLibrary.placesLibrary[pieceOfMessage.id]" ng-init="observeGameImpressions(chatLibrary.placesLibrary[pieceOfMessage.id])" ng-hide="true"></div> <div class="link-card-top-container"> <div class="small font-caption-header text-title text-overflow link-card-title" title="{{chatLibrary.placesLibrary[pieceOfMessage.id].placeName}}" ng-bind="chatLibrary.placesLibrary[pieceOfMessage.id].placeName" ng-click="goToPlaceDetails(pieceOfMessage.id, chatLibrary.eventStreamParams.clickLinkCardInChat)"> </div> </div> <div class="link-card-details" ng-click="goToPlaceDetails(pieceOfMessage.id, chatLibrary.eventStreamParams.clickLinkCardInChat)"> <span chat-game-icon class="chat-game-icon link-card-thumb" layout-library="chatLibrary.layoutLibrary" universe-id="{{chatLibrary.placesLibrary[pieceOfMessage.id].universeId}}" ng-if="chatLibrary.placesLibrary[pieceOfMessage.id].universeId"></span> <p class="xsmall text-secondary link-card-description" ng-bind="chatLibrary.placesLibrary[pieceOfMessage.id].description"></p> </div> <button class="{{chatLibrary.placesLibrary[pieceOfMessage.id].buttonLayoutForLinkCard.className}} btn-full-width link-card-btn" ng-class="{\'invisible\' : !chatLibrary.placesLibrary[pieceOfMessage.id].buttonLayoutForLinkCard}" ng-click="play(pieceOfMessage.id, chatLibrary.eventStreamParams.clickPlayFromLinkCardInChat, pieceOfMessage.assetDetails)" ng-disabled="dialogLayout.playTogetherButton.isPlayButtonDisabled"> {{chatLibrary.placesLibrary[pieceOfMessage.id].buttonLayoutForLinkCard.text}} </button> </div> <div class="cursor-pointer border dialog-triangle link-card-container" ng-if="pieceOfMessage.isLinkCard && chatLibrary.universeLibrary[pieceOfMessage.universeId]"> <div ng-init="observeGameImpressions(chatLibrary.universeLibrary[pieceOfMessage.universeId])" ng-hide="true"></div> <div class="link-card-top-container"> <div class="small font-caption-header text-title text-overflow link-card-title" title="{{chatLibrary.universeLibrary[pieceOfMessage.universeId].placeName}}" ng-bind="chatLibrary.universeLibrary[pieceOfMessage.universeId].placeName" ng-click="goToPlaceDetails(chatLibrary.universeLibrary[pieceOfMessage.universeId].placeId, chatLibrary.eventStreamParams.clickLinkCardInChat)"> </div> </div> <div class="link-card-details" ng-click="goToPlaceDetails(chatLibrary.universeLibrary[pieceOfMessage.universeId].placeId, chatLibrary.eventStreamParams.clickLinkCardInChat)"> <span chat-game-icon class="chat-game-icon link-card-thumb" ng-if="pieceOfMessage.universeId" layout-library="chatLibrary.layoutLibrary" universe-id="{{pieceOfMessage.universeId}}"></span> <p class="xsmall text-secondary link-card-description" ng-bind="chatLibrary.universeLibrary[pieceOfMessage.universeId].description"></p> </div> <button class="{{chatLibrary.universeLibrary[pieceOfMessage.universeId].buttonLayoutForLinkCard.className}} btn-full-width link-card-btn" ng-class="{\'invisible\' : !chatLibrary.universeLibrary[pieceOfMessage.universeId].buttonLayoutForLinkCard}" ng-click="play(chatLibrary.universeLibrary[pieceOfMessage.universeId].placeId, chatLibrary.eventStreamParams.clickPlayFromLinkCardInChat)" ng-disabled="dialogLayout.playTogetherButton.isPlayButtonDisabled"> {{chatLibrary.universeLibrary[pieceOfMessage.universeId].buttonLayoutForLinkCard.text}} </button> </div> </div> </div>';
      },
      1186: function (e) {
        e.exports =
          '<div class="osa-context-card-container"> <div class="osa-context-card-content"> <a class="osa-context-card-avatar-container" ng-href="{{chatLibrary.friendsDict[getOneToOneFriendId()].profileUrl}}"> <div class="osa-context-card-avatar-circle avatar avatar-headshot-sm friend-avatar"> <span class="chat-avatar-headshot" class-name="avatar-card-image avatar" chat-avatar-headshot user-id="{{getOneToOneFriendId()}}" layout-library="chatLibrary.layoutLibrary"> </span> </div> <div class="osa-context-card-names"> <div class="osa-context-card-display-name"> {{chatLibrary.friendsDict[getOneToOneFriendId()].nameForDisplay}} </div> <div class="osa-context-card-username"> <span ng-if="chatLibrary.friendsDict[getOneToOneFriendId()].name"> @{{chatLibrary.friendsDict[getOneToOneFriendId()].name}} </span> </div> </div> </a> <div class="osa-context-card-text-container"> <div class="osa-context-card-text-heading"> {{\'Heading.FirstConversationWith\' | translate:{displayName:\r\n        chatLibrary.friendsDict[getOneToOneFriendId()].nameForDisplay} }} </div> <div class="osa-context-card-text-description"> {{\'Description.OSAContextCardDescription\' | translate}} </div> </div> </div> </div> ';
      },
      856: function (e) {
        e.exports =
          '<div class="pending-state"> <div class="pending-state-container details-confirmation-container"> <div class="chat-windows-header dialog-header" ng-mouseenter="updateDialogHeader(true)" ng-mouseleave="updateDialogHeader(false)" ng-class="{\'hover\': dialogLayout.hoverOnCollapsed}"> <div class="chat-header-label" ng-click="toggleDialogContainer()"> <span id="group-chat-title" class="font-caption-header text-overflow dialog-header-title max-width" title="{{dialogData.title}}">{{dialogData.title}}</span> </div> <div dialog-header></div> </div> <div class="details-negative-confirmation-body"> <span class="small text details-negative-confirmation-text" ng-bind="\'Message.IneligibleToJoinChat\'|translate"></span> <div class="details-btns-fixed select-friends-btns"> <button id="negative-action-confirm-btn" class="btn-alert-sm details-btn-save details-btn-left" ng-bind="\'Action.LeaveGroup\'|translate" ng-click="leaveGroupChat(true)"> </button> <button class="btn-control-sm details-btn-cancel details-btn-right" ng-bind="\'Action.LearnMore\'|translate" ng-click="openLearnMorePage()"> </button> </div> </div> </div> </div> ';
      },
      2755: function (e) {
        e.exports =
          '<div class="select-friends-container"> <div class="border-bottom details-header-container select-friends-header"> <div class="details-label select-friends-label"> <span class="icon-chat-group-label"></span> </div> <div class="small details-input-container select-friends-search" ng-class="{\'group-select-container\' : dialogData.selectedUserIds.length > 0}" select-friends-resize> <ul class="friends-selected-list" ng-show="dialogData.selectedUserIds.length > 0"> <li class="friends-selected-item friends-selected-placeholder invisible"> </li> <li class="avatar avatar-headshot-sm card-plain friends-selected-item" ng-repeat="userId in dialogData.selectedUserIds" ng-click="selectFriends(userId)" ng-hide="dialogData.selectedUsersDict[userId].hiddenFromSelection" title="{{dialogData.selectedUsersDict[userId].nameForDisplay}}"> <span class="chat-avatar-headshot" class-name="avatar-card-image avatar" chat-avatar-headshot user-id="{{userId}}" layout-library="chatLibrary.layoutLibrary"> </span> <div class="friends-selected-mask"> <span class="icon-chat-close-white"></span> </div> </li> </ul> <input type="text" placeholder="{{\'Label.InputPlaceHolder.SearchForFriends\'|translate}}" class="small details-input select-friends-input" ng-model="dialogData.searchTerm" ng-keydown="chatLibrary.usePaginatedFriends ? searchFriends() : null"/> <span class="xsmall text-secondary select-friends-count" ng-if="dialogData.dialogType === dialogType.GROUPCHAT"> ({{(dialogData.selectedUserIds.length)}}/{{chatLibrary.quotaOfGroupChatMembers - dialogData.userIds.length + 1}}) </span> <span class="xsmall text-secondary select-friends-count" ng-if="dialogData.dialogType === dialogType.NEWGROUPCHAT || dialogData.dialogType === dialogType.CHAT"> ({{(dialogData.selectedUserIds.length)}}/{{chatLibrary.quotaOfGroupChatMembers - dialogData.userIds.length}}) </span> </div> </div> <div> <div id="scrollbar_friend_{{dialogData.dialogType}}_{{dialogData.layoutId}}" class="rbx-scrollbar select-friends-list" friends-lazy-load> <ul class="friends-list-container"> <li ng-if="chatLibrary.usePaginatedFriends" ng-repeat="friendId in dialogData.friendIds" id="friend-{{friendId}}"> <div class="friend-container chat-friend-select"> <div class="avatar avatar-headshot-sm card-plain friend-avatar" ng-click="toggleFriendSelection(friendId)"> <span class="chat-avatar-headshot" class-name="avatar-card-image avatar" chat-avatar-headshot user-id="{{friendId}}" layout-library="chatLibrary.layoutLibrary"> </span> <div class="avatar-status avatar-status" ng-class="userPresenceTypes[chatLibrary.friendsDict[friendId].presence.userPresenceType][\'className\']"></div> </div> <div class="border-bottom friend-info-action" ng-click="toggleFriendSelection(friendId)"> <div class="text-overflow friend-info"> <div class="dynamic-overflow-container no-wrap"> <div class="small text-overflow text-sec friend-name dynamic-ellipsis-item"> {{chatLibrary.friendsDict[friendId].nameForDisplay}}</div> </div> <div class="xsmall text-overflow text-secondary friend-status"> {{userPresenceTypes[chatLibrary.friendsDict[friendId].presence.userPresenceType].title}}</div> </div> <div class="checkbox friend-action"> <input id="checkbox-select-{{dialogData.layoutId}}-{{friendId}}" type="checkbox" ng-click="toggleFriendSelection(friendId, $event)" ng-checked="dialogData.selectedUsersDict[friendId]"> <label for="checkbox-select-{{dialogData.layoutId}}-{{friendId}}"> </label> </div> </div> </div> </li> <li ng-if="!chatLibrary.usePaginatedFriends" ng-repeat="friend in chatLibrary.friendsDict | orderList: dialogData.friendIds  | filter: search" id="friend-{{friend.id}}"> <div class="friend-container chat-friend-select"> <div class="avatar avatar-headshot-sm card-plain friend-avatar" ng-click="toggleFriendSelection(friend.id)"> <span class="chat-avatar-headshot" class-name="avatar-card-image avatar" chat-avatar-headshot user-id="{{friend.id}}" layout-library="chatLibrary.layoutLibrary"> </span> <div class="avatar-status avatar-status" ng-class="userPresenceTypes[friend.presence.userPresenceType][\'className\']"></div> </div> <div class="border-bottom friend-info-action" ng-click="toggleFriendSelection(friend.id)"> <div class="text-overflow friend-info"> <div class="dynamic-overflow-container no-wrap"> <div class="small text-overflow text-sec friend-name dynamic-ellipsis-item"> {{friend.nameForDisplay}}</div> </div> <div class="xsmall text-overflow text-secondary friend-status"> {{userPresenceTypes[friend.presence.userPresenceType].title}}</div> </div> <div class="checkbox friend-action"> <input id="checkbox-select-{{dialogData.layoutId}}-{{friend.id}}" type="checkbox" ng-click="toggleFriendSelection(friend.id, $event)" ng-checked="dialogData.selectedUsersDict[friend.id]"> <label for="checkbox-select-{{dialogData.layoutId}}-{{friend.id}}"> </label> </div> </div> </div> </li> </ul> </div> <div toast toast-layout="toastLayout"></div> </div> </div> ';
      },
      2038: function (e) {
        e.exports =
          '<div> <div ng-hide="message.isSystemMessageFromApi"> <span class="font-footer text-muted indicated-message-bubble system-message-content" ng-show="message.isSystemMessage && !message.hasParams" ng-bind-html="message.content"></span> <span class="font-footer text-muted indicated-message-bubble system-message-content" ng-show="message.isSystemMessage && message.hasParams">{{chatLibrary.friendsDict[dialogData.recentUserIdFromPresence].name}}{{message.content}}{{chatLibrary.placesLibrary[dialogData.recentPlaceIdFromPresence].placeName}}</span> </div> </div>';
      },
      9392: function (e) {
        e.exports =
          '<div ng-controller="userConversationInfoController"> <div class="border-bottom chat-friend-info" ng-class="{\'has-universe\': isGameAvailableInChat()}"> <div class="chat-friend-info-top dynamic-overflow-container"> <span class="small text-title text-overflow font-caption-header chat-friend-name dynamic-ellipsis-item" ng-class="{\'unread\': shouldShowUnread(), \'read\': !shouldShowUnread()}" ng-bind="chatUser.title  || chatUser.name "></span> </div> <span class="xsmall text-info chat-brief-timestamp" ng-class="{\'font-bold secondary unread\': shouldShowUnread(), \'read\': !shouldShowUnread()}" ng-if="!isGameAvailableInChat()" ng-bind="chatUser.previewMessage.briefTimeStamp || chatUser.briefTimeStamp"></span> <span class="xsmall text-overflow text-info font-caption-body chat-friend-message" ng-class="{\'unread\': shouldShowUnread(), \'read\': !shouldShowUnread()}" ng-if="chatUser.previewMessage && !chatUser.isUserPending"> {{chatUser.previewMessage.previewContent}} </span> </div> <div class="border-bottom chat-conversation-universe" ng-if="isGameAvailableInChat()" title="{{chatLibrary.placesLibrary[chatUser.placeForShown.rootPlaceId].placeName}}" ng-class="{\'album\': hasGameAlbum()}" ng-mouseover="openGameList()" popover-trigger=" \'none\' " popover-class="game-list-per-conversation game-list-{{chatUser.id}}" popover-placement="left-bottom" popover-append-to-body="true" popover-is-open="hoverPopoverParams.isOpen" hover-popover-params="hoverPopoverParams" hover-popover uib-popover-template="\'{{gamesListTemplateUrl}}\'"> <span chat-game-icon class-name="universe-image" layout-library="chatLibrary.layoutLibrary" ng-if="chatUser.placeForShown.universeId" universe-id="{{chatUser.placeForShown.universeId}}"></span> </div> </div> ';
      },
      1260: function (e) {
        "use strict";
        e.exports = CoreUtilities;
      },
      7577: function (e) {
        "use strict";
        e.exports = Roblox;
      },
      7472: function (e) {
        "use strict";
        e.exports = RobloxUserProfiles;
      },
      127: function (e) {
        "use strict";
        e.exports = angular;
      },
    },
    i = {};
  function n(e) {
    var a = i[e];
    if (void 0 !== a) return a.exports;
    a = i[e] = { exports: {} };
    return t[e](a, a.exports, n), a.exports;
  }
  (n.n = function (e) {
    var a =
      e && e.__esModule
        ? function () {
            return e.default;
          }
        : function () {
            return e;
          };
    return n.d(a, { a: a }), a;
  }),
    (n.d = function (e, a) {
      for (var t in a)
        n.o(a, t) &&
          !n.o(e, t) &&
          Object.defineProperty(e, t, { enumerable: !0, get: a[t] });
    }),
    (n.o = function (e, a) {
      return Object.prototype.hasOwnProperty.call(e, a);
    }),
    (n.r = function (e) {
      "undefined" != typeof Symbol &&
        Symbol.toStringTag &&
        Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }),
        Object.defineProperty(e, "__esModule", { value: !0 });
    }),
    (function () {
      "use strict";
      var e = n(127),
        a = n.n(e),
        t = n(7525),
        i = n(1089);
      (0, t.importFilesUnderPath)(n(3003)),
        (0, t.importFilesUnderPath)(n(1304)),
        (0, t.importFilesUnderPath)(n(1351)),
        (0, t.importFilesUnderPath)(n(2374));
      var e = n(5251),
        r = (0, t.templateCacheGenerator)(a(), "chatAppTemplates", e);
      a().element(function () {
        a().element("#chat-container").hide(),
          a().bootstrap("#chat-container", [i.A.name, r.name]);
      });
    })();
})();
//# sourceMappingURL=https://sourcemaps.rbxcdn.com/5b20f54ff62ff834f4208ddc4ed6d81c-chat.bundle.min.js.map

/* Bundle detector */
window.Roblox &&
  window.Roblox.BundleDetector &&
  window.Roblox.BundleDetector.bundleDetected("Chat");
